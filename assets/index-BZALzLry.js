(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))a(l);new MutationObserver(l=>{for(const s of l)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function n(l){const s={};return l.integrity&&(s.integrity=l.integrity),l.referrerPolicy&&(s.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?s.credentials="include":l.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(l){if(l.ep)return;l.ep=!0;const s=n(l);fetch(l.href,s)}})();var Ae,F,un,dn,fe,Tt,fn,pn,hn,xt,pt,ht,vn,Fe={},mn=[],dr=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,je=Array.isArray;function ee(e,t){for(var n in t)e[n]=t[n];return e}function Nt(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function se(e,t,n){var a,l,s,i={};for(s in t)s=="key"?a=t[s]:s=="ref"?l=t[s]:i[s]=t[s];if(arguments.length>2&&(i.children=arguments.length>3?Ae.call(arguments,2):n),typeof e=="function"&&e.defaultProps!=null)for(s in e.defaultProps)i[s]===void 0&&(i[s]=e.defaultProps[s]);return De(e,i,a,l,null)}function De(e,t,n,a,l){var s={type:e,props:t,key:n,ref:a,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:l??++un,__i:-1,__u:0};return l==null&&F.vnode!=null&&F.vnode(s),s}function fr(){return{current:null}}function W(e){return e.children}function X(e,t){this.props=e,this.context=t}function be(e,t){if(t==null)return e.__?be(e.__,e.__i+1):null;for(var n;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null)return n.__e;return typeof e.type=="function"?be(e):null}function gn(e){var t,n;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null){e.__e=e.__c.base=n.__e;break}return gn(e)}}function vt(e){(!e.__d&&(e.__d=!0)&&fe.push(e)&&!Ke.__r++||Tt!=F.debounceRendering)&&((Tt=F.debounceRendering)||fn)(Ke)}function Ke(){for(var e,t,n,a,l,s,i,o=1;fe.length;)fe.length>o&&fe.sort(pn),e=fe.shift(),o=fe.length,e.__d&&(n=void 0,l=(a=(t=e).__v).__e,s=[],i=[],t.__P&&((n=ee({},a)).__v=a.__v+1,F.vnode&&F.vnode(n),wt(t.__P,n,a,t.__n,t.__P.namespaceURI,32&a.__u?[l]:null,s,l??be(a),!!(32&a.__u),i),n.__v=a.__v,n.__.__k[n.__i]=n,bn(s,n,i),n.__e!=l&&gn(n)));Ke.__r=0}function _n(e,t,n,a,l,s,i,o,u,c,f){var d,v,g,C,A,I,$=a&&a.__k||mn,y=t.length;for(u=pr(n,t,$,u,y),d=0;d<y;d++)(g=n.__k[d])!=null&&(v=g.__i==-1?Fe:$[g.__i]||Fe,g.__i=d,I=wt(e,g,v,l,s,i,o,u,c,f),C=g.__e,g.ref&&v.ref!=g.ref&&(v.ref&&St(v.ref,null,g),f.push(g.ref,g.__c||C,g)),A==null&&C!=null&&(A=C),4&g.__u||v.__k===g.__k?u=yn(g,u,e):typeof g.type=="function"&&I!==void 0?u=I:C&&(u=C.nextSibling),g.__u&=-7);return n.__e=A,u}function pr(e,t,n,a,l){var s,i,o,u,c,f=n.length,d=f,v=0;for(e.__k=new Array(l),s=0;s<l;s++)(i=t[s])!=null&&typeof i!="boolean"&&typeof i!="function"?(u=s+v,(i=e.__k[s]=typeof i=="string"||typeof i=="number"||typeof i=="bigint"||i.constructor==String?De(null,i,null,null,null):je(i)?De(W,{children:i},null,null,null):i.constructor==null&&i.__b>0?De(i.type,i.props,i.key,i.ref?i.ref:null,i.__v):i).__=e,i.__b=e.__b+1,o=null,(c=i.__i=hr(i,n,u,d))!=-1&&(d--,(o=n[c])&&(o.__u|=2)),o==null||o.__v==null?(c==-1&&(l>f?v--:l<f&&v++),typeof i.type!="function"&&(i.__u|=4)):c!=u&&(c==u-1?v--:c==u+1?v++:(c>u?v--:v++,i.__u|=4))):e.__k[s]=null;if(d)for(s=0;s<f;s++)(o=n[s])!=null&&!(2&o.__u)&&(o.__e==a&&(a=be(o)),Nn(o,o));return a}function yn(e,t,n){var a,l;if(typeof e.type=="function"){for(a=e.__k,l=0;a&&l<a.length;l++)a[l]&&(a[l].__=e,t=yn(a[l],t,n));return t}e.__e!=t&&(t&&e.type&&!n.contains(t)&&(t=be(e)),n.insertBefore(e.__e,t||null),t=e.__e);do t=t&&t.nextSibling;while(t!=null&&t.nodeType==8);return t}function ae(e,t){return t=t||[],e==null||typeof e=="boolean"||(je(e)?e.some(function(n){ae(n,t)}):t.push(e)),t}function hr(e,t,n,a){var l,s,i,o=e.key,u=e.type,c=t[n],f=c!=null&&(2&c.__u)==0;if(c===null&&e.key==null||f&&o==c.key&&u==c.type)return n;if(a>(f?1:0)){for(l=n-1,s=n+1;l>=0||s<t.length;)if((c=t[i=l>=0?l--:s++])!=null&&!(2&c.__u)&&o==c.key&&u==c.type)return i}return-1}function Mt(e,t,n){t[0]=="-"?e.setProperty(t,n??""):e[t]=n==null?"":typeof n!="number"||dr.test(t)?n:n+"px"}function Je(e,t,n,a,l){var s,i;e:if(t=="style")if(typeof n=="string")e.style.cssText=n;else{if(typeof a=="string"&&(e.style.cssText=a=""),a)for(t in a)n&&t in n||Mt(e.style,t,"");if(n)for(t in n)a&&n[t]==a[t]||Mt(e.style,t,n[t])}else if(t[0]=="o"&&t[1]=="n")s=t!=(t=t.replace(hn,"$1")),i=t.toLowerCase(),t=i in e||t=="onFocusOut"||t=="onFocusIn"?i.slice(2):t.slice(2),e.l||(e.l={}),e.l[t+s]=n,n?a?n.u=a.u:(n.u=xt,e.addEventListener(t,s?ht:pt,s)):e.removeEventListener(t,s?ht:pt,s);else{if(l=="http://www.w3.org/2000/svg")t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!="width"&&t!="height"&&t!="href"&&t!="list"&&t!="form"&&t!="tabIndex"&&t!="download"&&t!="rowSpan"&&t!="colSpan"&&t!="role"&&t!="popover"&&t in e)try{e[t]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&t[4]!="-"?e.removeAttribute(t):e.setAttribute(t,t=="popover"&&n==1?"":n))}}function At(e){return function(t){if(this.l){var n=this.l[t.type+e];if(t.t==null)t.t=xt++;else if(t.t<n.u)return;return n(F.event?F.event(t):t)}}}function wt(e,t,n,a,l,s,i,o,u,c){var f,d,v,g,C,A,I,$,y,D,p,N,b,S,h,_,m,x=t.type;if(t.constructor!=null)return null;128&n.__u&&(u=!!(32&n.__u),s=[o=t.__e=n.__e]),(f=F.__b)&&f(t);e:if(typeof x=="function")try{if($=t.props,y="prototype"in x&&x.prototype.render,D=(f=x.contextType)&&a[f.__c],p=f?D?D.props.value:f.__:a,n.__c?I=(d=t.__c=n.__c).__=d.__E:(y?t.__c=d=new x($,p):(t.__c=d=new X($,p),d.constructor=x,d.render=mr),D&&D.sub(d),d.props=$,d.state||(d.state={}),d.context=p,d.__n=a,v=d.__d=!0,d.__h=[],d._sb=[]),y&&d.__s==null&&(d.__s=d.state),y&&x.getDerivedStateFromProps!=null&&(d.__s==d.state&&(d.__s=ee({},d.__s)),ee(d.__s,x.getDerivedStateFromProps($,d.__s))),g=d.props,C=d.state,d.__v=t,v)y&&x.getDerivedStateFromProps==null&&d.componentWillMount!=null&&d.componentWillMount(),y&&d.componentDidMount!=null&&d.__h.push(d.componentDidMount);else{if(y&&x.getDerivedStateFromProps==null&&$!==g&&d.componentWillReceiveProps!=null&&d.componentWillReceiveProps($,p),!d.__e&&d.shouldComponentUpdate!=null&&d.shouldComponentUpdate($,d.__s,p)===!1||t.__v==n.__v){for(t.__v!=n.__v&&(d.props=$,d.state=d.__s,d.__d=!1),t.__e=n.__e,t.__k=n.__k,t.__k.some(function(w){w&&(w.__=t)}),N=0;N<d._sb.length;N++)d.__h.push(d._sb[N]);d._sb=[],d.__h.length&&i.push(d);break e}d.componentWillUpdate!=null&&d.componentWillUpdate($,d.__s,p),y&&d.componentDidUpdate!=null&&d.__h.push(function(){d.componentDidUpdate(g,C,A)})}if(d.context=p,d.props=$,d.__P=e,d.__e=!1,b=F.__r,S=0,y){for(d.state=d.__s,d.__d=!1,b&&b(t),f=d.render(d.props,d.state,d.context),h=0;h<d._sb.length;h++)d.__h.push(d._sb[h]);d._sb=[]}else do d.__d=!1,b&&b(t),f=d.render(d.props,d.state,d.context),d.state=d.__s;while(d.__d&&++S<25);d.state=d.__s,d.getChildContext!=null&&(a=ee(ee({},a),d.getChildContext())),y&&!v&&d.getSnapshotBeforeUpdate!=null&&(A=d.getSnapshotBeforeUpdate(g,C)),_=f,f!=null&&f.type===W&&f.key==null&&(_=xn(f.props.children)),o=_n(e,je(_)?_:[_],t,n,a,l,s,i,o,u,c),d.base=t.__e,t.__u&=-161,d.__h.length&&i.push(d),I&&(d.__E=d.__=null)}catch(w){if(t.__v=null,u||s!=null)if(w.then){for(t.__u|=u?160:128;o&&o.nodeType==8&&o.nextSibling;)o=o.nextSibling;s[s.indexOf(o)]=null,t.__e=o}else{for(m=s.length;m--;)Nt(s[m]);mt(t)}else t.__e=n.__e,t.__k=n.__k,w.then||mt(t);F.__e(w,t,n)}else s==null&&t.__v==n.__v?(t.__k=n.__k,t.__e=n.__e):o=t.__e=vr(n.__e,t,n,a,l,s,i,u,c);return(f=F.diffed)&&f(t),128&t.__u?void 0:o}function mt(e){e&&e.__c&&(e.__c.__e=!0),e&&e.__k&&e.__k.forEach(mt)}function bn(e,t,n){for(var a=0;a<n.length;a++)St(n[a],n[++a],n[++a]);F.__c&&F.__c(t,e),e.some(function(l){try{e=l.__h,l.__h=[],e.some(function(s){s.call(l)})}catch(s){F.__e(s,l.__v)}})}function xn(e){return typeof e!="object"||e==null||e.__b&&e.__b>0?e:je(e)?e.map(xn):ee({},e)}function vr(e,t,n,a,l,s,i,o,u){var c,f,d,v,g,C,A,I=n.props,$=t.props,y=t.type;if(y=="svg"?l="http://www.w3.org/2000/svg":y=="math"?l="http://www.w3.org/1998/Math/MathML":l||(l="http://www.w3.org/1999/xhtml"),s!=null){for(c=0;c<s.length;c++)if((g=s[c])&&"setAttribute"in g==!!y&&(y?g.localName==y:g.nodeType==3)){e=g,s[c]=null;break}}if(e==null){if(y==null)return document.createTextNode($);e=document.createElementNS(l,y,$.is&&$),o&&(F.__m&&F.__m(t,s),o=!1),s=null}if(y==null)I===$||o&&e.data==$||(e.data=$);else{if(s=s&&Ae.call(e.childNodes),I=n.props||Fe,!o&&s!=null)for(I={},c=0;c<e.attributes.length;c++)I[(g=e.attributes[c]).name]=g.value;for(c in I)if(g=I[c],c!="children"){if(c=="dangerouslySetInnerHTML")d=g;else if(!(c in $)){if(c=="value"&&"defaultValue"in $||c=="checked"&&"defaultChecked"in $)continue;Je(e,c,null,g,l)}}for(c in $)g=$[c],c=="children"?v=g:c=="dangerouslySetInnerHTML"?f=g:c=="value"?C=g:c=="checked"?A=g:o&&typeof g!="function"||I[c]===g||Je(e,c,g,I[c],l);if(f)o||d&&(f.__html==d.__html||f.__html==e.innerHTML)||(e.innerHTML=f.__html),t.__k=[];else if(d&&(e.innerHTML=""),_n(t.type=="template"?e.content:e,je(v)?v:[v],t,n,a,y=="foreignObject"?"http://www.w3.org/1999/xhtml":l,s,i,s?s[0]:n.__k&&be(n,0),o,u),s!=null)for(c=s.length;c--;)Nt(s[c]);o||(c="value",y=="progress"&&C==null?e.removeAttribute("value"):C!=null&&(C!==e[c]||y=="progress"&&!C||y=="option"&&C!=I[c])&&Je(e,c,C,I[c],l),c="checked",A!=null&&A!=e[c]&&Je(e,c,A,I[c],l))}return e}function St(e,t,n){try{if(typeof e=="function"){var a=typeof e.__u=="function";a&&e.__u(),a&&t==null||(e.__u=e(t))}else e.current=t}catch(l){F.__e(l,n)}}function Nn(e,t,n){var a,l;if(F.unmount&&F.unmount(e),(a=e.ref)&&(a.current&&a.current!=e.__e||St(a,null,t)),(a=e.__c)!=null){if(a.componentWillUnmount)try{a.componentWillUnmount()}catch(s){F.__e(s,t)}a.base=a.__P=null}if(a=e.__k)for(l=0;l<a.length;l++)a[l]&&Nn(a[l],t,n||typeof e.type!="function");n||Nt(e.__e),e.__c=e.__=e.__e=void 0}function mr(e,t,n){return this.constructor(e,n)}function xe(e,t,n){var a,l,s,i;t==document&&(t=document.documentElement),F.__&&F.__(e,t),l=(a=typeof n=="function")?null:n&&n.__k||t.__k,s=[],i=[],wt(t,e=(!a&&n||t).__k=se(W,null,[e]),l||Fe,Fe,t.namespaceURI,!a&&n?[n]:l?null:t.firstChild?Ae.call(t.childNodes):null,s,!a&&n?n:l?l.__e:t.firstChild,a,i),bn(s,e,i)}function wn(e,t){xe(e,t,wn)}function gr(e,t,n){var a,l,s,i,o=ee({},e.props);for(s in e.type&&e.type.defaultProps&&(i=e.type.defaultProps),t)s=="key"?a=t[s]:s=="ref"?l=t[s]:o[s]=t[s]===void 0&&i!=null?i[s]:t[s];return arguments.length>2&&(o.children=arguments.length>3?Ae.call(arguments,2):n),De(e.type,o,a||e.key,l||e.ref,null)}function _r(e){function t(n){var a,l;return this.getChildContext||(a=new Set,(l={})[t.__c]=this,this.getChildContext=function(){return l},this.componentWillUnmount=function(){a=null},this.shouldComponentUpdate=function(s){this.props.value!=s.value&&a.forEach(function(i){i.__e=!0,vt(i)})},this.sub=function(s){a.add(s);var i=s.componentWillUnmount;s.componentWillUnmount=function(){a&&a.delete(s),i&&i.call(s)}}),n.children}return t.__c="__cC"+vn++,t.__=e,t.Provider=t.__l=(t.Consumer=function(n,a){return n.children(a)}).contextType=t,t}Ae=mn.slice,F={__e:function(e,t,n,a){for(var l,s,i;t=t.__;)if((l=t.__c)&&!l.__)try{if((s=l.constructor)&&s.getDerivedStateFromError!=null&&(l.setState(s.getDerivedStateFromError(e)),i=l.__d),l.componentDidCatch!=null&&(l.componentDidCatch(e,a||{}),i=l.__d),i)return l.__E=l}catch(o){e=o}throw e}},un=0,dn=function(e){return e!=null&&e.constructor==null},X.prototype.setState=function(e,t){var n;n=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=ee({},this.state),typeof e=="function"&&(e=e(ee({},n),this.props)),e&&ee(n,e),e!=null&&this.__v&&(t&&this._sb.push(t),vt(this))},X.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),vt(this))},X.prototype.render=W,fe=[],fn=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,pn=function(e,t){return e.__v.__b-t.__v.__b},Ke.__r=0,hn=/(PointerCapture)$|Capture$/i,xt=0,pt=At(!1),ht=At(!0),vn=0;var yr=0;function r(e,t,n,a,l,s){t||(t={});var i,o,u=t;if("ref"in u)for(o in u={},t)o=="ref"?i=t[o]:u[o]=t[o];var c={type:e,props:u,key:n,ref:i,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--yr,__i:-1,__u:0,__source:l,__self:s};if(typeof e=="function"&&(i=e.defaultProps))for(o in i)u[o]===void 0&&(u[o]=i[o]);return F.vnode&&F.vnode(c),c}var ce,U,st,jt,Ne=0,Sn=[],J=F,Pt=J.__b,Ut=J.__r,Jt=J.diffed,Rt=J.__c,Vt=J.unmount,Wt=J.__;function Se(e,t){J.__h&&J.__h(U,e,Ne||t),Ne=0;var n=U.__H||(U.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({}),n.__[e]}function he(e){return Ne=1,Ct(In,e)}function Ct(e,t,n){var a=Se(ce++,2);if(a.t=e,!a.__c&&(a.__=[n?n(t):In(void 0,t),function(o){var u=a.__N?a.__N[0]:a.__[0],c=a.t(u,o);u!==c&&(a.__N=[c,a.__[1]],a.__c.setState({}))}],a.__c=U,!U.__f)){var l=function(o,u,c){if(!a.__c.__H)return!0;var f=a.__c.__H.__.filter(function(v){return!!v.__c});if(f.every(function(v){return!v.__N}))return!s||s.call(this,o,u,c);var d=a.__c.props!==o;return f.forEach(function(v){if(v.__N){var g=v.__[0];v.__=v.__N,v.__N=void 0,g!==v.__[0]&&(d=!0)}}),s&&s.call(this,o,u,c)||d};U.__f=!0;var s=U.shouldComponentUpdate,i=U.componentWillUpdate;U.componentWillUpdate=function(o,u,c){if(this.__e){var f=s;s=void 0,l(o,u,c),s=f}i&&i.call(this,o,u,c)},U.shouldComponentUpdate=l}return a.__N||a.__}function Y(e,t){var n=Se(ce++,3);!J.__s&&$t(n.__H,t)&&(n.__=e,n.u=t,U.__H.__h.push(n))}function Pe(e,t){var n=Se(ce++,4);!J.__s&&$t(n.__H,t)&&(n.__=e,n.u=t,U.__h.push(n))}function R(e){return Ne=5,B(function(){return{current:e}},[])}function Cn(e,t,n){Ne=6,Pe(function(){if(typeof e=="function"){var a=e(t());return function(){e(null),a&&typeof a=="function"&&a()}}if(e)return e.current=t(),function(){return e.current=null}},n==null?n:n.concat(e))}function B(e,t){var n=Se(ce++,7);return $t(n.__H,t)&&(n.__=e(),n.__H=t,n.__h=e),n.__}function Te(e,t){return Ne=8,B(function(){return e},t)}function $n(e){var t=U.context[e.__c],n=Se(ce++,9);return n.c=e,t?(n.__==null&&(n.__=!0,t.sub(U)),t.props.value):e.__}function Ln(e,t){J.useDebugValue&&J.useDebugValue(t?t(e):e)}function On(){var e=Se(ce++,11);if(!e.__){for(var t=U.__v;t!==null&&!t.__m&&t.__!==null;)t=t.__;var n=t.__m||(t.__m=[0,0]);e.__="P"+n[0]+"-"+n[1]++}return e.__}function br(){for(var e;e=Sn.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(ze),e.__H.__h.forEach(gt),e.__H.__h=[]}catch(t){e.__H.__h=[],J.__e(t,e.__v)}}J.__b=function(e){U=null,Pt&&Pt(e)},J.__=function(e,t){e&&t.__k&&t.__k.__m&&(e.__m=t.__k.__m),Wt&&Wt(e,t)},J.__r=function(e){Ut&&Ut(e),ce=0;var t=(U=e.__c).__H;t&&(st===U?(t.__h=[],U.__h=[],t.__.forEach(function(n){n.__N&&(n.__=n.__N),n.u=n.__N=void 0})):(t.__h.forEach(ze),t.__h.forEach(gt),t.__h=[],ce=0)),st=U},J.diffed=function(e){Jt&&Jt(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(Sn.push(t)!==1&&jt===J.requestAnimationFrame||((jt=J.requestAnimationFrame)||xr)(br)),t.__H.__.forEach(function(n){n.u&&(n.__H=n.u),n.u=void 0})),st=U=null},J.__c=function(e,t){t.some(function(n){try{n.__h.forEach(ze),n.__h=n.__h.filter(function(a){return!a.__||gt(a)})}catch(a){t.some(function(l){l.__h&&(l.__h=[])}),t=[],J.__e(a,n.__v)}}),Rt&&Rt(e,t)},J.unmount=function(e){Vt&&Vt(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach(function(a){try{ze(a)}catch(l){t=l}}),n.__H=void 0,t&&J.__e(t,n.__v))};var zt=typeof requestAnimationFrame=="function";function xr(e){var t,n=function(){clearTimeout(a),zt&&cancelAnimationFrame(t),setTimeout(e)},a=setTimeout(n,35);zt&&(t=requestAnimationFrame(n))}function ze(e){var t=U,n=e.__c;typeof n=="function"&&(e.__c=void 0,n()),U=t}function gt(e){var t=U;e.__c=e.__(),U=t}function $t(e,t){return!e||e.length!==t.length||t.some(function(n,a){return n!==e[a]})}function In(e,t){return typeof t=="function"?t(e):t}var Nr=Symbol.for("preact-signals");function Lt(){if(_e>1)_e--;else{for(var e,t=!1;Ee!==void 0;){var n=Ee;for(Ee=void 0,_t++;n!==void 0;){var a=n.o;if(n.o=void 0,n.f&=-3,!(8&n.f)&&kn(n))try{n.c()}catch(l){t||(e=l,t=!0)}n=a}}if(_t=0,_e--,t)throw e}}var j=void 0;function Dn(e){var t=j;j=void 0;try{return e()}finally{j=t}}var Ee=void 0,_e=0,_t=0,Ge=0;function En(e){if(j!==void 0){var t=e.n;if(t===void 0||t.t!==j)return t={i:0,S:e,p:j.s,n:void 0,t:j,e:void 0,x:void 0,r:t},j.s!==void 0&&(j.s.n=t),j.s=t,e.n=t,32&j.f&&e.S(t),t;if(t.i===-1)return t.i=0,t.n!==void 0&&(t.n.p=t.p,t.p!==void 0&&(t.p.n=t.n),t.p=j.s,t.n=void 0,j.s.n=t,j.s=t),t}}function q(e,t){this.v=e,this.i=0,this.n=void 0,this.t=void 0,this.W=t?.watched,this.Z=t?.unwatched}q.prototype.brand=Nr;q.prototype.h=function(){return!0};q.prototype.S=function(e){var t=this,n=this.t;n!==e&&e.e===void 0&&(e.x=n,this.t=e,n!==void 0?n.e=e:Dn(function(){var a;(a=t.W)==null||a.call(t)}))};q.prototype.U=function(e){var t=this;if(this.t!==void 0){var n=e.e,a=e.x;n!==void 0&&(n.x=a,e.e=void 0),a!==void 0&&(a.e=n,e.x=void 0),e===this.t&&(this.t=a,a===void 0&&Dn(function(){var l;(l=t.Z)==null||l.call(t)}))}};q.prototype.subscribe=function(e){var t=this;return It(function(){var n=t.value,a=j;j=void 0;try{e(n)}finally{j=a}})};q.prototype.valueOf=function(){return this.value};q.prototype.toString=function(){return this.value+""};q.prototype.toJSON=function(){return this.value};q.prototype.peek=function(){var e=j;j=void 0;try{return this.value}finally{j=e}};Object.defineProperty(q.prototype,"value",{get:function(){var e=En(this);return e!==void 0&&(e.i=this.i),this.v},set:function(e){if(e!==this.v){if(_t>100)throw new Error("Cycle detected");this.v=e,this.i++,Ge++,_e++;try{for(var t=this.t;t!==void 0;t=t.x)t.t.N()}finally{Lt()}}}});function Q(e,t){return new q(e,t)}function kn(e){for(var t=e.s;t!==void 0;t=t.n)if(t.S.i!==t.i||!t.S.h()||t.S.i!==t.i)return!0;return!1}function Fn(e){for(var t=e.s;t!==void 0;t=t.n){var n=t.S.n;if(n!==void 0&&(t.r=n),t.S.n=t,t.i=-1,t.n===void 0){e.s=t;break}}}function Tn(e){for(var t=e.s,n=void 0;t!==void 0;){var a=t.p;t.i===-1?(t.S.U(t),a!==void 0&&(a.n=t.n),t.n!==void 0&&(t.n.p=a)):n=t,t.S.n=t.r,t.r!==void 0&&(t.r=void 0),t=a}e.s=n}function ve(e,t){q.call(this,void 0),this.x=e,this.s=void 0,this.g=Ge-1,this.f=4,this.W=t?.watched,this.Z=t?.unwatched}ve.prototype=new q;ve.prototype.h=function(){if(this.f&=-3,1&this.f)return!1;if((36&this.f)==32||(this.f&=-5,this.g===Ge))return!0;if(this.g=Ge,this.f|=1,this.i>0&&!kn(this))return this.f&=-2,!0;var e=j;try{Fn(this),j=this;var t=this.x();(16&this.f||this.v!==t||this.i===0)&&(this.v=t,this.f&=-17,this.i++)}catch(n){this.v=n,this.f|=16,this.i++}return j=e,Tn(this),this.f&=-2,!0};ve.prototype.S=function(e){if(this.t===void 0){this.f|=36;for(var t=this.s;t!==void 0;t=t.n)t.S.S(t)}q.prototype.S.call(this,e)};ve.prototype.U=function(e){if(this.t!==void 0&&(q.prototype.U.call(this,e),this.t===void 0)){this.f&=-33;for(var t=this.s;t!==void 0;t=t.n)t.S.U(t)}};ve.prototype.N=function(){if(!(2&this.f)){this.f|=6;for(var e=this.t;e!==void 0;e=e.x)e.t.N()}};Object.defineProperty(ve.prototype,"value",{get:function(){if(1&this.f)throw new Error("Cycle detected");var e=En(this);if(this.h(),e!==void 0&&(e.i=this.i),16&this.f)throw this.v;return this.v}});function ue(e,t){return new ve(e,t)}function Mn(e){var t=e.u;if(e.u=void 0,typeof t=="function"){_e++;var n=j;j=void 0;try{t()}catch(a){throw e.f&=-2,e.f|=8,Ot(e),a}finally{j=n,Lt()}}}function Ot(e){for(var t=e.s;t!==void 0;t=t.n)t.S.U(t);e.x=void 0,e.s=void 0,Mn(e)}function wr(e){if(j!==this)throw new Error("Out-of-order effect");Tn(this),j=e,this.f&=-2,8&this.f&&Ot(this),Lt()}function Ce(e){this.x=e,this.u=void 0,this.s=void 0,this.o=void 0,this.f=32}Ce.prototype.c=function(){var e=this.S();try{if(8&this.f||this.x===void 0)return;var t=this.x();typeof t=="function"&&(this.u=t)}finally{e()}};Ce.prototype.S=function(){if(1&this.f)throw new Error("Cycle detected");this.f|=1,this.f&=-9,Mn(this),Fn(this),_e++;var e=j;return j=this,wr.bind(this,e)};Ce.prototype.N=function(){2&this.f||(this.f|=2,this.o=Ee,Ee=this)};Ce.prototype.d=function(){this.f|=8,1&this.f||Ot(this)};Ce.prototype.dispose=function(){this.d()};function It(e){var t=new Ce(e);try{t.c()}catch(a){throw t.d(),a}var n=t.d.bind(t);return n[Symbol.dispose]=n,n}var Qe,it;function $e(e,t){F[e]=t.bind(null,F[e]||function(){})}function Ye(e){it&&it(),it=e&&e.S()}function An(e){var t=this,n=e.data,a=V(n);a.value=n;var l=B(function(){for(var s=t.__v;s=s.__;)if(s.__c){s.__c.__$f|=4;break}return t.__$u.c=function(){var i,o=t.__$u.S(),u=l.value;o(),dn(u)||((i=t.base)==null?void 0:i.nodeType)!==3?(t.__$f|=1,t.setState({})):t.base.data=u},ue(function(){var i=a.value.value;return i===0?0:i===!0?"":i||""})},[]);return l.value}An.displayName="_st";Object.defineProperties(q.prototype,{constructor:{configurable:!0,value:void 0},type:{configurable:!0,value:An},props:{configurable:!0,get:function(){return{data:this}}},__b:{configurable:!0,value:1}});$e("__b",function(e,t){if(typeof t.type=="string"){var n,a=t.props;for(var l in a)if(l!=="children"){var s=a[l];s instanceof q&&(n||(t.__np=n={}),n[l]=s,a[l]=s.peek())}}e(t)});$e("__r",function(e,t){Ye();var n,a=t.__c;a&&(a.__$f&=-2,(n=a.__$u)===void 0&&(a.__$u=n=function(l){var s;return It(function(){s=this}),s.c=function(){a.__$f|=1,a.setState({})},s}())),Qe=a,Ye(n),e(t)});$e("__e",function(e,t,n,a){Ye(),Qe=void 0,e(t,n,a)});$e("diffed",function(e,t){Ye(),Qe=void 0;var n;if(typeof t.type=="string"&&(n=t.__e)){var a=t.__np,l=t.props;if(a){var s=n.U;if(s)for(var i in s){var o=s[i];o!==void 0&&!(i in a)&&(o.d(),s[i]=void 0)}else n.U=s={};for(var u in a){var c=s[u],f=a[u];c===void 0?(c=Sr(n,u,f,l),s[u]=c):c.o(f,l)}}}e(t)});function Sr(e,t,n,a){var l=t in e&&e.ownerSVGElement===void 0,s=Q(n);return{o:function(i,o){s.value=i,a=o},d:It(function(){var i=s.value.value;a[t]!==i&&(a[t]=i,l?e[t]=i:i?e.setAttribute(t,i):e.removeAttribute(t))})}}$e("unmount",function(e,t){if(typeof t.type=="string"){var n=t.__e;if(n){var a=n.U;if(a){n.U=void 0;for(var l in a){var s=a[l];s&&s.d()}}}}else{var i=t.__c;if(i){var o=i.__$u;o&&(i.__$u=void 0,o.d())}}e(t)});$e("__h",function(e,t,n,a){(a<3||a===9)&&(t.__$f|=2),e(t,n,a)});X.prototype.shouldComponentUpdate=function(e,t){var n=this.__$u,a=n&&n.s!==void 0;for(var l in t)return!0;if(this.__f||typeof this.u=="boolean"&&this.u===!0){if(!(a||2&this.__$f||4&this.__$f)||1&this.__$f)return!0}else if(!(a||4&this.__$f)||3&this.__$f)return!0;for(var s in e)if(s!=="__source"&&e[s]!==this.props[s])return!0;for(var i in this.props)if(!(i in e))return!0;return!1};function V(e){return B(function(){return Q(e)},[])}function E(e){var t=R(e);return t.current=e,Qe.__$f|=4,B(function(){return ue(function(){return t.current()})},[])}const Cr=e=>{try{return[JSON.parse(e),null]}catch(t){return[null,t instanceof Error?t.message:"Parse error"]}},Xe=e=>{const t=new Set,n=l=>{l&&typeof l=="string"&&t.add(l)},a=l=>{for(const s of l||[]){s.id&&n(s.id);for(const i of s.items||[])i.id&&n(i.id),i.legendDescription&&n(i.legendDescription)}};return a(e.weatherFeatures),a(e.features),t},Dt=e=>{const t=new Set,n=a=>{for(const l of a||[])for(const s of l.items||[])for(const i of s.layersIds||[])t.add(i)};return n(e.weatherFeatures),n(e.features),t},$r=(e,t)=>{const n=[],a=(l,s)=>{l.forEach((i,o)=>{(i.items||[]).forEach((u,c)=>{(u.layersIds||[]).includes(t)&&n.push({featureType:s,featureIndex:o,featureName:i.name||i.id||`${s} ${o+1}`,itemIndex:c,itemName:u.name||u.id||`Item ${c+1}`})})})};return a(e.weatherFeatures,"weatherFeatures"),a(e.features,"features"),n},Lr=(e,t,n="application/json")=>{const a=new Blob([t],{type:n}),l=URL.createObjectURL(a),s=document.createElement("a");s.href=l,s.download=e,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(l)},jn=()=>({weatherFeatures:[],features:[],layers:[],intl:{en:{},da:{},nb:{},sv:{}}}),Pn="hemswx-map-editor-settings",Or={customLogicLayers:new Set(["aviation_obstacle"])},Ir=()=>{try{const e=localStorage.getItem(Pn);if(e){const t=JSON.parse(e);return{customLogicLayers:new Set(t.customLogicLayers||["aviation_obstacle"])}}}catch(e){console.warn("Failed to load settings:",e)}return{...Or,customLogicLayers:new Set(["aviation_obstacle"])}},Un=e=>{try{const t={customLogicLayers:Array.from(e.customLogicLayers)};localStorage.setItem(Pn,JSON.stringify(t))}catch(t){console.warn("Failed to save settings:",t)}},ne=Q(Ir());ue(()=>ne.value.customLogicLayers);const Dr=e=>{const t=new Set(ne.value.customLogicLayers);t.add(e);const n={...ne.value,customLogicLayers:t};ne.value=n,Un(n)},Er=e=>{const t=new Set(ne.value.customLogicLayers);t.delete(e);const n={...ne.value,customLogicLayers:t};ne.value=n,Un(n)},we=e=>ne.value.customLogicLayers.has(e),kr=e=>{we(e)?Er(e):Dr(e)},Fr=e=>{const[t,n]=Cr(e);if(n)return{valid:!1,errors:[`JSON Parse Error: ${n}`],warnings:[]};const a=[],l=[];if(!t||typeof t!="object")return a.push("Root must be an object"),{valid:!1,errors:a,warnings:l};const s=["weatherFeatures","features","layers"];for(const o of s)Array.isArray(t[o])||a.push(`Missing or invalid '${o}' array`);if(!t.intl||typeof t.intl!="object")a.push("Missing or invalid 'intl' object");else{const o=["en","da","nb","sv"];for(const u of o)(!t.intl[u]||typeof t.intl[u]!="object")&&l.push(`Missing or invalid '${u}' translations`)}[...t.weatherFeatures||[],...t.features||[]].forEach((o,u)=>{const c=u<(t.weatherFeatures?.length||0)?"weatherFeature":"feature",f=u<(t.weatherFeatures?.length||0)?u:u-(t.weatherFeatures?.length||0);(!o.presentation||!["single","multiple"].includes(o.presentation))&&a.push(`${c} ${f+1}: presentation field is required and must be "single" or "multiple"`),!o.items||!Array.isArray(o.items)?a.push(`${c} ${f+1}: items field is required and must be an array`):o.items.forEach((d,v)=>{(!d.id||typeof d.id!="string"||d.id.trim()==="")&&a.push(`${c} ${f+1}, item ${v+1}: id is required and cannot be empty`),(!d.name||typeof d.name!="string"||d.name.trim()==="")&&a.push(`${c} ${f+1}, item ${v+1}: name is required and cannot be empty`),(!d.layersIds||!Array.isArray(d.layersIds)||d.layersIds.length===0)&&a.push(`${c} ${f+1}, item ${v+1}: layersIds is required and must be a non-empty array`)})}),t.layers&&Array.isArray(t.layers)&&t.layers.forEach((o,u)=>{(!o.id||typeof o.id!="string"||o.id.trim()==="")&&a.push(`layer ${u+1}: id is required and cannot be empty`),!o.layers||!Array.isArray(o.layers)||o.layers.length===0?a.push(`layer ${u+1}: layers field is required and must be a non-empty array`):o.layers.forEach((c,f)=>{(!c.type||typeof c.type!="string")&&a.push(`layer ${u+1}, sublayer ${f+1}: type is required`),(!c.source||typeof c.source!="string"||c.source.trim()==="")&&a.push(`layer ${u+1}, sublayer ${f+1}: source is required and cannot be empty`)})});try{const o=Dt(t),u=new Set((t.layers||[]).map(f=>f.id).filter(Boolean)),c=[...o].filter(f=>!u.has(f));c.length>0&&l.push(`Missing layer definitions: ${c.join(", ")}`)}catch{l.push("Could not validate layer references")}return{valid:a.length===0,errors:a,warnings:l}},Jn=e=>{try{const t=Dt(e),n=new Set((e.layers||[]).map(f=>f.id)),a=ne.value.customLogicLayers,l=new Set([...t,...a]),s=[...t].filter(f=>!n.has(f)),i=[...n].filter(f=>!l.has(f)),o=Xe(e),u=Object.keys(e.intl||{}),c={};for(const f of u){const d=e.intl[f]||{};c[f]=[...o].filter(v=>!(v in d))}return{missingLayers:s,unusedLayers:i,missingIntl:c,weatherFeatureCount:e.weatherFeatures?.length||0,featureCount:e.features?.length||0,layerCount:e.layers?.length||0,languageCount:u.length}}catch(t){return console.warn("Error computing stats:",t),{missingLayers:[],unusedLayers:[],missingIntl:{},weatherFeatureCount:0,featureCount:0,layerCount:0,languageCount:0}}},Tr=e=>{const t=Jn(e);return`WF: ${t.weatherFeatureCount} • F: ${t.featureCount} • Layers: ${t.layerCount} • Langs: ${t.languageCount}`},M=["en","da","nb","sv"],Mr=(e,t)=>{const n={...e};n.intl||(n.intl={en:{},da:{},nb:{},sv:{}});const a=[];return t.id?.trim()&&a.push({key:t.id,defaultValue:t.name?.trim()||t.id}),(t.items||[]).forEach(l=>{l.id?.trim()&&a.push({key:l.id,defaultValue:l.name?.trim()||l.id}),l.legendDescription?.trim()&&a.push({key:l.legendDescription,defaultValue:l.legendDescription})}),M.forEach(l=>{n.intl[l]||(n.intl[l]={}),a.forEach(({key:s,defaultValue:i})=>{n.intl[l][s]||(l==="en"?n.intl[l][s]=i:n.intl[l][s]=n.intl.en[s]||i)})}),n},Ar=e=>{const t={...e},n=t.intl?.en||{},a={},l=(o,u)=>{!a[o]&&u&&(a[o]=u)},s=o=>{for(const u of o||[]){u.id&&u.name&&l(u.id,u.name);for(const c of u.items||[])c.id&&c.name&&l(c.id,c.name),c.legendDescription&&l(c.legendDescription,n[c.legendDescription]||c.legendDescription)}};s(t.weatherFeatures),s(t.features);const i=new Set([...Xe(t)]);return t.intl||(t.intl={en:{},da:{},nb:{},sv:{}}),M.forEach(o=>{const u=t.intl[o]||{},c={};i.forEach(f=>{u[f]?c[f]=u[f]:o==="en"&&a[f]?c[f]=a[f]:n[f]?c[f]=n[f]:c[f]=f}),t.intl[o]=c}),t},jr=["wms","tiled","mapImage","portalItem","vectorTiled","feature"],Pr=e=>{const t={type:e,source:"",zIndex:0,options:{opacity:1}};switch(e){case"wms":return{...t,source:"https://example.com/wms",options:{layerNames:["layer1"],opacity:1}};case"tiled":return{...t,source:"https://example.com/tiles/{z}/{y}/{x}.png"};case"vectorTiled":return{...t,source:"https://example.com/vectortiles/{z}/{y}/{x}.pbf"};case"mapImage":return{...t,source:"https://example.com/arcgis/rest/services/MapServer"};case"feature":return{...t,source:"https://example.com/arcgis/rest/services/FeatureServer/0"};case"portalItem":return{...t,source:"portal-item-id",options:{layerId:0,opacity:1}};default:return t}},Ur=(e,t)=>{const n={...e},a=n.layers.findIndex(l=>l.id===t.id);return a>=0?(n.layers=[...n.layers],n.layers[a]=t):n.layers=[...n.layers,t],n},k=Q(jn()),Le=Q(!1),Z=Q({type:null,index:-1}),le=Q({index:-1}),H=Q({}),pe=Q({weatherFeatures:{},features:{}}),de=Q("features"),Rn=Q("json");Q("en");ue(()=>JSON.stringify(k.value,null,2));const Jr=ue(()=>Jn(k.value)),Rr=ue(()=>Tr(k.value)),Vr=ue(()=>{const e=Z.value;return e.type===null||e.index<0?null:k.value[e.type][e.index]||null}),Wr=ue(()=>{const e=le.value;return e.index<0?null:k.value.layers[e.index]||null}),z=e=>{k.value=e,Le.value=!0;try{localStorage.setItem("hemswx-last-json-data",JSON.stringify(e))}catch(a){console.warn("Failed to save JSON data to localStorage:",a)}const t=Z.value;if(t.type&&t.index>=0){const a=e[t.type];t.index>=a.length&&(Z.value={type:null,index:-1})}const n=le.value;n.index>=0&&n.index>=e.layers.length&&(le.value={index:-1})},zr=()=>{try{const e=localStorage.getItem("hemswx-last-json-data");if(e){const t=JSON.parse(e);return z(t),te("✅ Last session data loaded"),!0}}catch(e){console.warn("Failed to load JSON data from localStorage:",e)}return!1},te=e=>{},Vn=(e,t)=>{Z.value={type:e,index:t},Rn.value="feature"},He=e=>{le.value={index:e},Rn.value="layer"},Hr=e=>H.value[e],re=(e,t)=>{H.value={...H.value,[e]:t}},Re=e=>{const t={...H.value};delete t[e],H.value=t},qr=(e,t)=>pe.value[e][t],ot=(e,t,n)=>{pe.value={...pe.value,[e]:{...pe.value[e],[t]:n}}},Ht=(e,t)=>{const n={...pe.value[e]};delete n[t],pe.value={...pe.value,[e]:n}},Wn=()=>{const e=Ar(k.value);z(e)},Br=(e,t)=>{const n={...k.value};n[e]=n[e].filter((l,s)=>s!==t),z(n);const a=Z.value;a.type===e&&a.index===t?Z.value={type:null,index:-1}:a.type===e&&a.index>t&&(Z.value={...a,index:a.index-1})},Kr=(e,t,n)=>{if(e===n)return;const a=JSON.parse(JSON.stringify(k.value)),[l]=a[e].splice(t,1);a[n].push(l),z(a);const s=a[n].length-1;Z.value={type:n,index:s}},qe=(e,t,n,a)=>{const l=[...k.value[e]],s=e===n?l:[...k.value[n]];if(t<0||t>=l.length||a<0||a>s.length)return;const[i]=l.splice(t,1),o=e===n&&t<a?a-1:a;s.splice(o,0,i);const u={...k.value,[e]:e===n?s:l,[n]:s};z(u),Z.value={type:n,index:o}},zn=e=>{const t={...k.value};t.layers=t.layers.filter((a,l)=>l!==e),z(t);const n=le.value;n.index===e?le.value={index:-1}:n.index>e&&(le.value={index:n.index-1})};function Gr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function Bt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?qt(Object(n),!0).forEach(function(a){Gr(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qt(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function Yr(e,t){if(e==null)return{};var n={},a=Object.keys(e),l,s;for(s=0;s<a.length;s++)l=a[s],!(t.indexOf(l)>=0)&&(n[l]=e[l]);return n}function Zr(e,t){if(e==null)return{};var n=Yr(e,t),a,l;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(l=0;l<s.length;l++)a=s[l],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function Qr(e,t){return Xr(e)||ea(e,t)||ta(e,t)||na()}function Xr(e){if(Array.isArray(e))return e}function ea(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var n=[],a=!0,l=!1,s=void 0;try{for(var i=e[Symbol.iterator](),o;!(a=(o=i.next()).done)&&(n.push(o.value),!(t&&n.length===t));a=!0);}catch(u){l=!0,s=u}finally{try{!a&&i.return!=null&&i.return()}finally{if(l)throw s}}return n}}function ta(e,t){if(e){if(typeof e=="string")return Kt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Kt(e,t)}}function Kt(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function na(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ra(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Gt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function Yt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Gt(Object(n),!0).forEach(function(a){ra(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Gt(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function aa(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(a){return t.reduceRight(function(l,s){return s(l)},a)}}function Oe(e){return function t(){for(var n=this,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return l.length>=e.length?e.apply(this,l):function(){for(var i=arguments.length,o=new Array(i),u=0;u<i;u++)o[u]=arguments[u];return t.apply(n,[].concat(l,o))}}}function Ze(e){return{}.toString.call(e).includes("Object")}function la(e){return!Object.keys(e).length}function Me(e){return typeof e=="function"}function sa(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function ia(e,t){return Ze(t)||oe("changeType"),Object.keys(t).some(function(n){return!sa(e,n)})&&oe("changeField"),t}function oa(e){Me(e)||oe("selectorType")}function ca(e){Me(e)||Ze(e)||oe("handlerType"),Ze(e)&&Object.values(e).some(function(t){return!Me(t)})&&oe("handlersType")}function ua(e){e||oe("initialIsRequired"),Ze(e)||oe("initialType"),la(e)&&oe("initialContent")}function da(e,t){throw new Error(e[t]||e.default)}var fa={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},oe=Oe(da)(fa),Ve={changes:ia,selector:oa,handler:ca,initial:ua};function pa(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Ve.initial(e),Ve.handler(t);var n={current:e},a=Oe(ma)(n,t),l=Oe(va)(n),s=Oe(Ve.changes)(e),i=Oe(ha)(n);function o(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(f){return f};return Ve.selector(c),c(n.current)}function u(c){aa(a,l,s,i)(c)}return[o,u]}function ha(e,t){return Me(t)?t(e.current):t}function va(e,t){return e.current=Yt(Yt({},e.current),t),t}function ma(e,t,n){return Me(t)?t(e.current):Object.keys(n).forEach(function(a){var l;return(l=t[a])===null||l===void 0?void 0:l.call(t,e.current[a])}),n}var ga={create:pa},_a={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.52.2/min/vs"}};function ya(e){return function t(){for(var n=this,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return l.length>=e.length?e.apply(this,l):function(){for(var i=arguments.length,o=new Array(i),u=0;u<i;u++)o[u]=arguments[u];return t.apply(n,[].concat(l,o))}}}function ba(e){return{}.toString.call(e).includes("Object")}function xa(e){return e||Zt("configIsRequired"),ba(e)||Zt("configType"),e.urls?(Na(),{paths:{vs:e.urls.monacoBase}}):e}function Na(){console.warn(Hn.deprecation)}function wa(e,t){throw new Error(e[t]||e.default)}var Hn={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},Zt=ya(wa)(Hn),Sa={config:xa},Ca=function(){for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return function(l){return n.reduceRight(function(s,i){return i(s)},l)}};function qn(e,t){return Object.keys(t).forEach(function(n){t[n]instanceof Object&&e[n]&&Object.assign(t[n],qn(e[n],t[n]))}),Bt(Bt({},e),t)}var $a={type:"cancelation",msg:"operation is manually canceled"};function ct(e){var t=!1,n=new Promise(function(a,l){e.then(function(s){return t?l($a):a(s)}),e.catch(l)});return n.cancel=function(){return t=!0},n}var La=ga.create({config:_a,isInitialized:!1,resolve:null,reject:null,monaco:null}),Bn=Qr(La,2),Ue=Bn[0],et=Bn[1];function Oa(e){var t=Sa.config(e),n=t.monaco,a=Zr(t,["monaco"]);et(function(l){return{config:qn(l.config,a),monaco:n}})}function Ia(){var e=Ue(function(t){var n=t.monaco,a=t.isInitialized,l=t.resolve;return{monaco:n,isInitialized:a,resolve:l}});if(!e.isInitialized){if(et({isInitialized:!0}),e.monaco)return e.resolve(e.monaco),ct(ut);if(window.monaco&&window.monaco.editor)return Kn(window.monaco),e.resolve(window.monaco),ct(ut);Ca(Da,ka)(Fa)}return ct(ut)}function Da(e){return document.body.appendChild(e)}function Ea(e){var t=document.createElement("script");return e&&(t.src=e),t}function ka(e){var t=Ue(function(a){var l=a.config,s=a.reject;return{config:l,reject:s}}),n=Ea("".concat(t.config.paths.vs,"/loader.js"));return n.onload=function(){return e()},n.onerror=t.reject,n}function Fa(){var e=Ue(function(n){var a=n.config,l=n.resolve,s=n.reject;return{config:a,resolve:l,reject:s}}),t=window.require;t.config(e.config),t(["vs/editor/editor.main"],function(n){Kn(n),e.resolve(n)},function(n){e.reject(n)})}function Kn(e){Ue().monaco||et({monaco:e})}function Ta(){return Ue(function(e){var t=e.monaco;return t})}var ut=new Promise(function(e,t){return et({resolve:e,reject:t})}),Gn={config:Oa,init:Ia,__getMonacoInstance:Ta};function Yn(e,t){for(var n in t)e[n]=t[n];return e}function yt(e,t){for(var n in e)if(n!=="__source"&&!(n in t))return!0;for(var a in t)if(a!=="__source"&&e[a]!==t[a])return!0;return!1}function Zn(e,t){var n=t(),a=he({t:{__:n,u:t}}),l=a[0].t,s=a[1];return Pe(function(){l.__=n,l.u=t,dt(l)&&s({t:l})},[e,n,t]),Y(function(){return dt(l)&&s({t:l}),e(function(){dt(l)&&s({t:l})})},[e]),n}function dt(e){var t,n,a=e.u,l=e.__;try{var s=a();return!((t=l)===(n=s)&&(t!==0||1/t==1/n)||t!=t&&n!=n)}catch{return!0}}function Qn(e){e()}function Xn(e){return e}function er(){return[!1,Qn]}var tr=Pe;function bt(e,t){this.props=e,this.context=t}function tt(e,t){function n(l){var s=this.props.ref,i=s==l.ref;return!i&&s&&(s.call?s(null):s.current=null),t?!t(this.props,l)||!i:yt(this.props,l)}function a(l){return this.shouldComponentUpdate=n,se(e,l)}return a.displayName="Memo("+(e.displayName||e.name)+")",a.prototype.isReactComponent=!0,a.__f=!0,a}(bt.prototype=new X).isPureReactComponent=!0,bt.prototype.shouldComponentUpdate=function(e,t){return yt(this.props,e)||yt(this.state,t)};var Qt=F.__b;F.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),Qt&&Qt(e)};var Ma=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function Aa(e){function t(n){var a=Yn({},n);return delete a.ref,e(a,n.ref||null)}return t.$$typeof=Ma,t.render=t,t.prototype.isReactComponent=t.__f=!0,t.displayName="ForwardRef("+(e.displayName||e.name)+")",t}var Xt=function(e,t){return e==null?null:ae(ae(e).map(t))},ja={map:Xt,forEach:Xt,count:function(e){return e?ae(e).length:0},only:function(e){var t=ae(e);if(t.length!==1)throw"Children.only";return t[0]},toArray:ae},Pa=F.__e;F.__e=function(e,t,n,a){if(e.then){for(var l,s=t;s=s.__;)if((l=s.__c)&&l.__c)return t.__e==null&&(t.__e=n.__e,t.__k=n.__k),l.__c(e,t)}Pa(e,t,n,a)};var en=F.unmount;function nr(e,t,n){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach(function(a){typeof a.__c=="function"&&a.__c()}),e.__c.__H=null),(e=Yn({},e)).__c!=null&&(e.__c.__P===n&&(e.__c.__P=t),e.__c.__e=!0,e.__c=null),e.__k=e.__k&&e.__k.map(function(a){return nr(a,t,n)})),e}function rr(e,t,n){return e&&n&&(e.__v=null,e.__k=e.__k&&e.__k.map(function(a){return rr(a,t,n)}),e.__c&&e.__c.__P===t&&(e.__e&&n.appendChild(e.__e),e.__c.__e=!0,e.__c.__P=n)),e}function Be(){this.__u=0,this.o=null,this.__b=null}function ar(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function Ua(e){var t,n,a;function l(s){if(t||(t=e()).then(function(i){n=i.default||i},function(i){a=i}),a)throw a;if(!n)throw t;return se(n,s)}return l.displayName="Lazy",l.__f=!0,l}function Ie(){this.i=null,this.l=null}F.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&32&e.__u&&(e.type=null),en&&en(e)},(Be.prototype=new X).__c=function(e,t){var n=t.__c,a=this;a.o==null&&(a.o=[]),a.o.push(n);var l=ar(a.__v),s=!1,i=function(){s||(s=!0,n.__R=null,l?l(o):o())};n.__R=i;var o=function(){if(!--a.__u){if(a.state.__a){var u=a.state.__a;a.__v.__k[0]=rr(u,u.__c.__P,u.__c.__O)}var c;for(a.setState({__a:a.__b=null});c=a.o.pop();)c.forceUpdate()}};a.__u++||32&t.__u||a.setState({__a:a.__b=a.__v.__k[0]}),e.then(i,i)},Be.prototype.componentWillUnmount=function(){this.o=[]},Be.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),a=this.__v.__k[0].__c;this.__v.__k[0]=nr(this.__b,n,a.__O=a.__P)}this.__b=null}var l=t.__a&&se(W,null,e.fallback);return l&&(l.__u&=-33),[se(W,null,t.__a?null:e.children),l]};var tn=function(e,t,n){if(++n[1]===n[0]&&e.l.delete(t),e.props.revealOrder&&(e.props.revealOrder[0]!=="t"||!e.l.size))for(n=e.i;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.i=n=n[2]}};function Ja(e){return this.getChildContext=function(){return e.context},e.children}function Ra(e){var t=this,n=e.h;if(t.componentWillUnmount=function(){xe(null,t.v),t.v=null,t.h=null},t.h&&t.h!==n&&t.componentWillUnmount(),!t.v){for(var a=t.__v;a!==null&&!a.__m&&a.__!==null;)a=a.__;t.h=n,t.v={nodeType:1,parentNode:n,childNodes:[],__k:{__m:a.__m},contains:function(){return!0},insertBefore:function(l,s){this.childNodes.push(l),t.h.insertBefore(l,s)},removeChild:function(l){this.childNodes.splice(this.childNodes.indexOf(l)>>>1,1),t.h.removeChild(l)}}}xe(se(Ja,{context:t.context},e.__v),t.v)}function Va(e,t){var n=se(Ra,{__v:e,h:t});return n.containerInfo=t,n}(Ie.prototype=new X).__a=function(e){var t=this,n=ar(t.__v),a=t.l.get(e);return a[0]++,function(l){var s=function(){t.props.revealOrder?(a.push(l),tn(t,e,a)):l()};n?n(s):s()}},Ie.prototype.render=function(e){this.i=null,this.l=new Map;var t=ae(e.children);e.revealOrder&&e.revealOrder[0]==="b"&&t.reverse();for(var n=t.length;n--;)this.l.set(t[n],this.i=[1,0,this.i]);return e.children},Ie.prototype.componentDidUpdate=Ie.prototype.componentDidMount=function(){var e=this;this.l.forEach(function(t,n){tn(e,n,t)})};var lr=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,Wa=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,za=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,Ha=/[A-Z0-9]/g,qa=typeof document<"u",Ba=function(e){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/:/fil|che|ra/).test(e)};function Ka(e,t,n){return t.__k==null&&(t.textContent=""),xe(e,t),typeof n=="function"&&n(),e?e.__c:null}function Ga(e,t,n){return wn(e,t),typeof n=="function"&&n(),e?e.__c:null}X.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(e){Object.defineProperty(X.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})});var nn=F.event;function Ya(){}function Za(){return this.cancelBubble}function Qa(){return this.defaultPrevented}F.event=function(e){return nn&&(e=nn(e)),e.persist=Ya,e.isPropagationStopped=Za,e.isDefaultPrevented=Qa,e.nativeEvent=e};var Et,Xa={enumerable:!1,configurable:!0,get:function(){return this.class}},rn=F.vnode;F.vnode=function(e){typeof e.type=="string"&&function(t){var n=t.props,a=t.type,l={},s=a.indexOf("-")===-1;for(var i in n){var o=n[i];if(!(i==="value"&&"defaultValue"in n&&o==null||qa&&i==="children"&&a==="noscript"||i==="class"||i==="className")){var u=i.toLowerCase();i==="defaultValue"&&"value"in n&&n.value==null?i="value":i==="download"&&o===!0?o="":u==="translate"&&o==="no"?o=!1:u[0]==="o"&&u[1]==="n"?u==="ondoubleclick"?i="ondblclick":u!=="onchange"||a!=="input"&&a!=="textarea"||Ba(n.type)?u==="onfocus"?i="onfocusin":u==="onblur"?i="onfocusout":za.test(i)&&(i=u):u=i="oninput":s&&Wa.test(i)?i=i.replace(Ha,"-$&").toLowerCase():o===null&&(o=void 0),u==="oninput"&&l[i=u]&&(i="oninputCapture"),l[i]=o}}a=="select"&&l.multiple&&Array.isArray(l.value)&&(l.value=ae(n.children).forEach(function(c){c.props.selected=l.value.indexOf(c.props.value)!=-1})),a=="select"&&l.defaultValue!=null&&(l.value=ae(n.children).forEach(function(c){c.props.selected=l.multiple?l.defaultValue.indexOf(c.props.value)!=-1:l.defaultValue==c.props.value})),n.class&&!n.className?(l.class=n.class,Object.defineProperty(l,"className",Xa)):(n.className&&!n.class||n.class&&n.className)&&(l.class=l.className=n.className),t.props=l}(e),e.$$typeof=lr,rn&&rn(e)};var an=F.__r;F.__r=function(e){an&&an(e),Et=e.__c};var ln=F.diffed;F.diffed=function(e){ln&&ln(e);var t=e.props,n=e.__e;n!=null&&e.type==="textarea"&&"value"in t&&t.value!==n.value&&(n.value=t.value==null?"":t.value),Et=null};var el={ReactCurrentDispatcher:{current:{readContext:function(e){return Et.__n[e.__c].props.value},useCallback:Te,useContext:$n,useDebugValue:Ln,useDeferredValue:Xn,useEffect:Y,useId:On,useImperativeHandle:Cn,useInsertionEffect:tr,useLayoutEffect:Pe,useMemo:B,useReducer:Ct,useRef:R,useState:he,useSyncExternalStore:Zn,useTransition:er}}};function tl(e){return se.bind(null,e)}function nt(e){return!!e&&e.$$typeof===lr}function nl(e){return nt(e)&&e.type===W}function rl(e){return!!e&&!!e.displayName&&(typeof e.displayName=="string"||e.displayName instanceof String)&&e.displayName.startsWith("Memo(")}function al(e){return nt(e)?gr.apply(null,arguments):e}function ll(e){return!!e.__k&&(xe(null,e),!0)}function sl(e){return e&&(e.base||e.nodeType===1&&e)||null}var il=function(e,t){return e(t)},ol=function(e,t){return e(t)},cl=W,ul=nt,ye={useState:he,useId:On,useReducer:Ct,useEffect:Y,useLayoutEffect:Pe,useInsertionEffect:tr,useTransition:er,useDeferredValue:Xn,useSyncExternalStore:Zn,startTransition:Qn,useRef:R,useImperativeHandle:Cn,useMemo:B,useCallback:Te,useContext:$n,useDebugValue:Ln,version:"18.3.1",Children:ja,render:Ka,hydrate:Ga,unmountComponentAtNode:ll,createPortal:Va,createElement:se,createContext:_r,createFactory:tl,cloneElement:al,createRef:fr,Fragment:W,isValidElement:nt,isElement:ul,isFragment:nl,isMemo:rl,findDOMNode:sl,Component:X,PureComponent:bt,memo:tt,forwardRef:Aa,flushSync:ol,unstable_batchedUpdates:il,StrictMode:cl,Suspense:Be,SuspenseList:Ie,lazy:Ua,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:el},dl={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},ft=dl,fl={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},pl=fl;function hl({children:e}){return ye.createElement("div",{style:pl.container},e)}var vl=hl,ml=vl;function gl({width:e,height:t,isEditorReady:n,loading:a,_ref:l,className:s,wrapperProps:i}){return ye.createElement("section",{style:{...ft.wrapper,width:e,height:t},...i},!n&&ye.createElement(ml,null,a),ye.createElement("div",{ref:l,style:{...ft.fullWidth,...!n&&ft.hide},className:s}))}var _l=gl,sr=tt(_l);function yl(e){Y(e,[])}var ir=yl;function bl(e,t,n=!0){let a=R(!0);Y(a.current||!n?()=>{a.current=!1}:e,t)}var G=bl;function ke(){}function ge(e,t,n,a){return xl(e,a)||Nl(e,t,n,a)}function xl(e,t){return e.editor.getModel(or(e,t))}function Nl(e,t,n,a){return e.editor.createModel(t,n,a?or(e,a):void 0)}function or(e,t){return e.Uri.parse(t)}function wl({original:e,modified:t,language:n,originalLanguage:a,modifiedLanguage:l,originalModelPath:s,modifiedModelPath:i,keepCurrentOriginalModel:o=!1,keepCurrentModifiedModel:u=!1,theme:c="light",loading:f="Loading...",options:d={},height:v="100%",width:g="100%",className:C,wrapperProps:A={},beforeMount:I=ke,onMount:$=ke}){let[y,D]=he(!1),[p,N]=he(!0),b=R(null),S=R(null),h=R(null),_=R($),m=R(I),x=R(!1);ir(()=>{let O=Gn.init();return O.then(P=>(S.current=P)&&N(!1)).catch(P=>P?.type!=="cancelation"&&console.error("Monaco initialization: error:",P)),()=>b.current?T():O.cancel()}),G(()=>{if(b.current&&S.current){let O=b.current.getOriginalEditor(),P=ge(S.current,e||"",a||n||"text",s||"");P!==O.getModel()&&O.setModel(P)}},[s],y),G(()=>{if(b.current&&S.current){let O=b.current.getModifiedEditor(),P=ge(S.current,t||"",l||n||"text",i||"");P!==O.getModel()&&O.setModel(P)}},[i],y),G(()=>{let O=b.current.getModifiedEditor();O.getOption(S.current.editor.EditorOption.readOnly)?O.setValue(t||""):t!==O.getValue()&&(O.executeEdits("",[{range:O.getModel().getFullModelRange(),text:t||"",forceMoveMarkers:!0}]),O.pushUndoStop())},[t],y),G(()=>{b.current?.getModel()?.original.setValue(e||"")},[e],y),G(()=>{let{original:O,modified:P}=b.current.getModel();S.current.editor.setModelLanguage(O,a||n||"text"),S.current.editor.setModelLanguage(P,l||n||"text")},[n,a,l],y),G(()=>{S.current?.editor.setTheme(c)},[c],y),G(()=>{b.current?.updateOptions(d)},[d],y);let w=Te(()=>{if(!S.current)return;m.current(S.current);let O=ge(S.current,e||"",a||n||"text",s||""),P=ge(S.current,t||"",l||n||"text",i||"");b.current?.setModel({original:O,modified:P})},[n,t,l,e,a,s,i]),L=Te(()=>{!x.current&&h.current&&(b.current=S.current.editor.createDiffEditor(h.current,{automaticLayout:!0,...d}),w(),S.current?.editor.setTheme(c),D(!0),x.current=!0)},[d,c,w]);Y(()=>{y&&_.current(b.current,S.current)},[y]),Y(()=>{!p&&!y&&L()},[p,y,L]);function T(){let O=b.current?.getModel();o||O?.original?.dispose(),u||O?.modified?.dispose(),b.current?.dispose()}return ye.createElement(sr,{width:g,height:v,isEditorReady:y,loading:f,_ref:h,className:C,wrapperProps:A})}var Sl=wl;tt(Sl);function Cl(e){let t=R();return Y(()=>{t.current=e},[e]),t.current}var $l=Cl,We=new Map;function Ll({defaultValue:e,defaultLanguage:t,defaultPath:n,value:a,language:l,path:s,theme:i="light",line:o,loading:u="Loading...",options:c={},overrideServices:f={},saveViewState:d=!0,keepCurrentModel:v=!1,width:g="100%",height:C="100%",className:A,wrapperProps:I={},beforeMount:$=ke,onMount:y=ke,onChange:D,onValidate:p=ke}){let[N,b]=he(!1),[S,h]=he(!0),_=R(null),m=R(null),x=R(null),w=R(y),L=R($),T=R(),O=R(a),P=$l(s),me=R(!1),rt=R(!1);ir(()=>{let K=Gn.init();return K.then(ie=>(_.current=ie)&&h(!1)).catch(ie=>ie?.type!=="cancelation"&&console.error("Monaco initialization: error:",ie)),()=>m.current?ur():K.cancel()}),G(()=>{let K=ge(_.current,e||a||"",t||l||"",s||n||"");K!==m.current?.getModel()&&(d&&We.set(P,m.current?.saveViewState()),m.current?.setModel(K),d&&m.current?.restoreViewState(We.get(s)))},[s],N),G(()=>{m.current?.updateOptions(c)},[c],N),G(()=>{!m.current||a===void 0||(m.current.getOption(_.current.editor.EditorOption.readOnly)?m.current.setValue(a):a!==m.current.getValue()&&(rt.current=!0,m.current.executeEdits("",[{range:m.current.getModel().getFullModelRange(),text:a,forceMoveMarkers:!0}]),m.current.pushUndoStop(),rt.current=!1))},[a],N),G(()=>{let K=m.current?.getModel();K&&l&&_.current?.editor.setModelLanguage(K,l)},[l],N),G(()=>{o!==void 0&&m.current?.revealLine(o)},[o],N),G(()=>{_.current?.editor.setTheme(i)},[i],N);let Ft=Te(()=>{if(!(!x.current||!_.current)&&!me.current){L.current(_.current);let K=s||n,ie=ge(_.current,a||e||"",t||l||"",K||"");m.current=_.current?.editor.create(x.current,{model:ie,automaticLayout:!0,...c},f),d&&m.current.restoreViewState(We.get(K)),_.current.editor.setTheme(i),o!==void 0&&m.current.revealLine(o),b(!0),me.current=!0}},[e,t,n,a,l,s,c,f,d,i,o]);Y(()=>{N&&w.current(m.current,_.current)},[N]),Y(()=>{!S&&!N&&Ft()},[S,N,Ft]),O.current=a,Y(()=>{N&&D&&(T.current?.dispose(),T.current=m.current?.onDidChangeModelContent(K=>{rt.current||D(m.current.getValue(),K)}))},[N,D]),Y(()=>{if(N){let K=_.current.editor.onDidChangeMarkers(ie=>{let at=m.current.getModel()?.uri;if(at&&ie.find(lt=>lt.path===at.path)){let lt=_.current.editor.getModelMarkers({resource:at});p?.(lt)}});return()=>{K?.dispose()}}return()=>{}},[N,p]);function ur(){T.current?.dispose(),v?d&&We.set(s,m.current.saveViewState()):m.current.getModel()?.dispose(),m.current.dispose()}return ye.createElement(sr,{width:g,height:C,isEditorReady:N,loading:u,_ref:x,className:A,wrapperProps:I})}var Ol=Ll,Il=tt(Ol),Dl=Il;function kt({title:e="JSON Editor",value:t,onChange:n,placeholder:a="{}",readOnly:l=!1,height:s="400px"}){const i=R(null),o=R(null),u=V(!0),c=V(""),f=V(!1),d=E(()=>typeof navigator<"u"&&navigator.platform.toUpperCase().indexOf("MAC")>=0),v=E(()=>d.value?"Cmd":"Ctrl"),g=E(()=>{try{return t==null?"":JSON.stringify(t,null,2)}catch{return""}}),C=(D,p)=>{i.current=D,o.current=p,p.languages.json.jsonDefaults.setDiagnosticsOptions({validate:!0,allowComments:!1,schemas:[],enableSchemaRequest:!1}),D.updateOptions({minimap:{enabled:!1},fontSize:12,tabSize:2,insertSpaces:!0,wordWrap:"on",lineNumbers:"on",folding:!0,bracketPairColorization:{enabled:!0},autoIndent:"full",formatOnPaste:!0,formatOnType:!0}),D.addCommand(p.KeyMod.CtrlCmd|p.KeyCode.KeyS,()=>{I()}),D.addCommand(p.KeyMod.CtrlCmd|p.KeyMod.Shift|p.KeyCode.KeyF,()=>{$()})},A=D=>{if(!(l||!D))try{const p=JSON.parse(D);u.value=!0,c.value="",n(p)}catch(p){u.value=!1,c.value=p instanceof Error?p.message:"Invalid JSON"}},I=()=>{if(!i.current||l)return;const D=i.current.getValue();A(D)},$=async()=>{if(!(!i.current||!o.current||l)){f.value=!0;try{const D=i.current.getValue(),p=JSON.parse(D),N=JSON.stringify(p,null,2);i.current.setValue(N),n(p),u.value=!0,c.value=""}catch{await i.current.getAction("editor.action.formatDocument")?.run()}finally{f.value=!1}}};return r("div",{className:"flex flex-col h-full min-h-0",children:[r("div",{className:"flex flex-wrap gap-2 mb-3 items-center flex-shrink-0",children:[r("span",{className:"text-slate-500",children:e}),r("div",{className:"ml-auto flex gap-2",children:!l&&r(W,{children:[r("button",{className:"btn small",onClick:()=>{if(!i.current)return;const D=i.current.getValue();try{return JSON.parse(D),u.value=!0,c.value="",!0}catch(p){return u.value=!1,c.value=p instanceof Error?p.message:"Invalid JSON",!1}},title:"Validate JSON",children:"Validate"}),r("button",{className:"btn small",onClick:$,disabled:f.value,title:`Format JSON (${v.value}+Shift+F)`,children:f.value?"Formatting...":"Format"})]})})]}),!u.value&&c.value&&r("div",{className:"bg-red-900/30 border border-red-500/50 rounded p-2 mb-2 flex-shrink-0",children:r("div",{className:"text-red-300 text-xs",children:[r("span",{className:"font-medium",children:"JSON Error:"})," ",c.value]})}),u.value&&!l&&r("div",{className:"bg-green-900/30 border border-green-500/50 rounded p-2 mb-2 flex-shrink-0",children:r("div",{className:"text-green-300 text-xs",children:["✓ Valid JSON - Press ",v.value,"+S to save changes"]})}),r("div",{className:"flex-1 min-h-0 border border-slate-600 rounded overflow-hidden",children:r(Dl,{height:s,language:"json",theme:"vs-dark",value:g.value||a,onChange:A,onMount:C,options:{readOnly:l,contextmenu:!0,automaticLayout:!0},loading:r("div",{className:"flex items-center justify-center h-full text-slate-400",children:"Loading JSON Editor..."})})}),r("div",{className:"text-xs text-slate-500 mt-2 flex-shrink-0",children:l?"Read-only JSON view":r(W,{children:[r("span",{className:"font-medium",children:"Shortcuts:"})," ",v.value,"+S to save • ",v.value,"+Shift+F to format • Auto-validation enabled"]})})]})}function El({feature:e,type:t,index:n,rearrange:a}){const l=E(()=>Z.value.type===t&&Z.value.index===n),s=E(()=>t==="weatherFeatures"?(k.value.weatherFeatures||[]).length:(k.value.features||[]).length),i=V(!1),o=V(null),u=E(()=>{const y=[];e.id?.trim()&&y.push(e.id),(e.items||[]).forEach(h=>{h.id?.trim()&&y.push(h.id),h.legendDescription?.trim()&&y.push(h.legendDescription)});const D=[...new Set(y)];if(D.length===0)return{percentage:100,missingCount:0,totalKeys:0};let p=0,N=0;D.forEach(h=>{M.forEach(_=>{p++;const m=k.value.intl?.[_]?.[h];m&&m.trim()&&N++})});const b=p>0?Math.round(N/p*100):100,S=p-N;return{percentage:b,missingCount:S,totalKeys:D.length}}),c=()=>{Vn(t,n)},f=y=>{y.stopPropagation(),confirm("Are you sure you want to delete this feature?")&&Br(t,n)},d=y=>{y.stopPropagation(),!(n<=0)&&qe(t,n,t,n-1)},v=y=>{y.stopPropagation();const D=(t==="weatherFeatures"?k.value.weatherFeatures:k.value.features).length;n>=D-1||qe(t,n,t,n+1)},g=y=>{y.stopPropagation(),Kr(t,n,t==="weatherFeatures"?"features":"weatherFeatures")},C=(e.items||[]).length,A=e.presentation||"single",I=e.name||A==="single"&&e.items?.[0]?.name||e.id||"Unnamed Feature",$=e.mutuallyExclusive?" • Exclusive":"";return r("div",{className:`feature-list-item relative ${l.value?"selected":""} ${i.value?"ring-1 ring-blue-500":""}`,onClick:c,draggable:a,onDragStart:y=>{if(!a)return;const D=JSON.stringify({kind:"feature",type:t,index:n});y.dataTransfer.setData("application/x-feature",D),y.dataTransfer.setData("text/plain",D),y.dataTransfer.effectAllowed="move"},onDragOver:y=>{if(!a||!Array.from(y.dataTransfer?.types||[]).includes("application/x-feature"))return;y.preventDefault(),y.dataTransfer.dropEffect="move",i.value=!0;const p=y.currentTarget.getBoundingClientRect(),N=y.clientY<p.top+p.height/2;o.value=N?"before":"after"},onDragLeave:()=>{i.value=!1,o.value=null},onDrop:y=>{if(!a)return;y.preventDefault(),i.value=!1;const D=o.value;o.value=null;const p=y.dataTransfer.getData("application/x-feature")||y.dataTransfer.getData("text/plain");if(p)try{const N=JSON.parse(p);if(N.kind!=="feature")return;const b=D==="after"?n+1:n;qe(N.type,N.index,t,b)}catch{}},children:[i.value&&o.value==="before"&&r("div",{className:"absolute -top-[1px] left-0 right-0 h-0.5 bg-blue-500 rounded-full"}),r("div",{className:"feature-info",children:[r("div",{className:"feature-name",children:I}),r("div",{className:"feature-details",children:[C," item(s) • ",A,$]}),u.value.totalKeys>0&&r("div",{className:"flex items-center gap-1 mt-1",children:[r("span",{className:"text-xs text-slate-400",children:"i18n:"}),r("span",{className:`text-xs px-1.5 py-0.5 rounded-full ${u.value.percentage===100?"bg-green-600 text-white":u.value.percentage>50?"bg-yellow-600 text-white":"bg-red-600 text-white"}`,children:[u.value.percentage,"%"]}),u.value.missingCount>0&&r("span",{className:"text-xs text-orange-400",children:["(",u.value.missingCount," missing)"]})]})]}),r("div",{className:"feature-actions flex gap-1",children:[a&&r(W,{children:[r("button",{className:"btn small",onClick:d,disabled:n===0,title:"Move up",children:"↑"}),r("button",{className:"btn small",onClick:v,disabled:n>=s.value-1,title:"Move down",children:"↓"}),r("button",{className:"btn ghost small",onClick:g,title:t==="weatherFeatures"?"Move to General":"Move to Weather",children:t==="weatherFeatures"?"To General":"To Weather"})]}),r("button",{className:"btn danger small",onClick:f,children:"Delete"})]}),i.value&&o.value==="after"&&r("div",{className:"absolute -bottom-[1px] left-0 right-0 h-0.5 bg-blue-500 rounded-full"})]})}function sn({title:e,type:t,features:n,rearrange:a}){const l=V(!1);return r("details",{open:!0,className:`feature-category ${l.value?"ring-1 ring-blue-700 rounded":""}`,onDragOver:s=>{!a||!Array.from(s.dataTransfer?.types||[]).includes("application/x-feature")||(s.preventDefault(),l.value=!0)},onDragLeave:()=>{l.value=!1},onDrop:s=>{if(!a)return;s.preventDefault(),l.value=!1;const i=s.dataTransfer.getData("application/x-feature")||s.dataTransfer.getData("text/plain");if(i)try{const o=JSON.parse(i);if(o.kind!=="feature")return;const u=(t==="weatherFeatures"?k.value.weatherFeatures:k.value.features).length;qe(o.type,o.index,t,u)}catch{}},children:[r("summary",{className:"feature-category-header",children:e}),r("div",{className:"feature-category-content",children:n.length===0?r("div",{className:"p-3 text-slate-500 text-center",children:["No ",e.toLowerCase()," found"]}):n.map((s,i)=>r(El,{feature:s,type:t,index:i,rearrange:a},i))})]})}function kl(){const e=E(()=>k.value.weatherFeatures||[]),t=E(()=>k.value.features||[]),n=V(!1);return r("div",{className:"flex flex-col h-full",children:[r("div",{className:"flex items-center justify-between mb-2",children:[r("div",{className:"text-sm text-slate-400",children:"Features"}),r("button",{className:`btn tiny ${n.value?"success":"ghost"}`,onClick:()=>n.value=!n.value,title:"Toggle rearrange mode",children:n.value?"Done":"Rearrange"})]}),r("div",{className:"feature-browser flex-1 overflow-auto",children:[r(sn,{title:"Weather Features",type:"weatherFeatures",features:e.value,rearrange:n.value}),r(sn,{title:"General Features",type:"features",features:t.value,rearrange:n.value})]})]})}function Fl({layer:e,index:t,isUsed:n}){const a=E(()=>le.value.index===t),l=we(e.id),s=()=>{He(t)},i=o=>{o.stopPropagation(),confirm(`Are you sure you want to delete layer "${e.id}"?`)&&zn(t)};return r("div",{className:`feature-list-item ${a.value?"selected":""}`,onClick:s,children:[r("div",{className:"feature-info",children:[r("div",{className:"feature-name",children:e.id||"(no id)"}),r("div",{className:"feature-details",children:[r("span",{className:`pill ${n?"ok":"warn"}`,children:n?"used":"unused"}),l&&r("span",{className:"ml-2 text-xs bg-blue-600 text-white px-1.5 py-0.5 rounded",children:"referenced"}),r("span",{className:"ml-2 text-xs",children:[e.layers?.length||0," sublayer",(e.layers?.length||0)===1?"":"s"]})]})]}),r("div",{className:"feature-actions",children:r("button",{className:"btn danger small",onClick:i,children:"Delete"})})]})}function Tl(){const e=E(()=>k.value.layers||[]),t=E(()=>Dt(k.value));return r("div",{className:"flex flex-col h-full",children:r("div",{className:"feature-browser flex-1 overflow-auto",children:r("div",{className:"feature-category",children:[r("div",{className:"feature-category-header",children:"Layers"}),r("div",{className:"feature-category-content",children:e.value.length===0?r("div",{className:"p-3 text-slate-500 text-center",children:"No layers found"}):e.value.map((n,a)=>r(Fl,{layer:n,index:a,isUsed:t.value.has(n.id)},n.id||a))})]})})})}const Ml=e=>{const t=[],n=[];return e.presentation?["single","multiple"].includes(e.presentation)||t.push('presentation must be "single" or "multiple"'):t.push("presentation field is required"),e.items?Array.isArray(e.items)?e.items.length===0?n.push("items array is empty - feature will not be functional"):e.items.forEach((a,l)=>{const s=Al(a);t.push(...s.errors.map(i=>`Item ${l+1}: ${i}`)),n.push(...s.warnings.map(i=>`Item ${l+1}: ${i}`))}):t.push("items must be an array"):t.push("items field is required"),{valid:t.length===0,errors:t,warnings:n}},Al=e=>{const t=[],n=[];return e.id?typeof e.id!="string"?t.push("id must be a string"):e.id.trim()===""&&t.push("id cannot be empty or whitespace only"):t.push("id is required"),e.name?typeof e.name!="string"?t.push("name must be a string"):e.name.trim()===""&&t.push("name cannot be empty or whitespace only"):t.push("name is required"),e.layersIds?Array.isArray(e.layersIds)?e.layersIds.length===0?t.push("layersIds must contain at least one layer ID"):e.layersIds.forEach((a,l)=>{(!a||typeof a!="string"||a.trim()==="")&&t.push(`layersIds[${l}] must be a non-empty string`)}):t.push("layersIds must be an array"):t.push("layersIds is required"),e.showLegend!==void 0&&typeof e.showLegend!="boolean"&&t.push("showLegend must be a boolean"),e.legendUrl!==void 0&&(typeof e.legendUrl!="string"?t.push("legendUrl must be a string"):e.legendUrl.trim()===""&&n.push("legendUrl is empty - consider removing it")),e.legendDescription!==void 0&&(typeof e.legendDescription!="string"?t.push("legendDescription must be a string"):e.legendDescription.trim()===""&&n.push("legendDescription is empty - consider removing it")),{valid:t.length===0,errors:t,warnings:n}},jl=e=>{const t=[],n=[];return e.type?["wms","tiled","mapImage","portalItem","vectorTiled","feature"].includes(e.type)||t.push("type must be one of: wms, tiled, mapImage, portalItem, vectorTiled, feature"):t.push("type is required"),e.source?typeof e.source!="string"?t.push("source must be a string"):e.source.trim()===""&&t.push("source cannot be empty"):t.push("source is required"),e.zIndex!==void 0&&(typeof e.zIndex!="number"?t.push("zIndex must be a number"):Number.isInteger(e.zIndex)||t.push("zIndex must be an integer")),e.refreshInterval!==void 0&&(typeof e.refreshInterval!="number"?t.push("refreshInterval must be a number"):e.refreshInterval<0?t.push("refreshInterval must be non-negative"):Number.isInteger(e.refreshInterval)||t.push("refreshInterval must be an integer (milliseconds)")),e.options?.opacity!==void 0&&(typeof e.options.opacity!="number"?t.push("opacity (in options) must be a number"):(e.options.opacity<0||e.options.opacity>1)&&t.push("opacity must be between 0.0 and 1.0")),{valid:t.length===0,errors:t,warnings:n}},on=e=>{const t=[],n=[];return e.id?typeof e.id!="string"?t.push("id must be a string"):e.id.trim()===""&&t.push("id cannot be empty"):t.push("id is required"),e.layers?Array.isArray(e.layers)?e.layers.length===0?t.push("layers array cannot be empty"):e.layers.forEach((a,l)=>{const s=jl(a);t.push(...s.errors.map(i=>`Layer ${l+1}: ${i}`)),n.push(...s.warnings.map(i=>`Layer ${l+1}: ${i}`))}):t.push("layers must be an array"):t.push("layers field is required"),{valid:t.length===0,errors:t,warnings:n}};function cr({validation:e,className:t=""}){return!e||e.errors.length===0&&e.warnings.length===0?null:r("div",{className:`space-y-2 ${t}`,children:[e.errors.length>0&&r("div",{className:"bg-red-900/20 border border-red-700/30 rounded p-2",children:[r("div",{className:"flex items-center gap-2 text-red-400 text-sm font-medium mb-1",children:[r("span",{children:"❌"}),r("span",{children:["Errors (",e.errors.length,")"]})]}),r("div",{className:"space-y-1",children:e.errors.map((n,a)=>r("div",{className:"text-red-300 text-xs",children:["• ",n]},a))})]}),e.warnings.length>0&&r("div",{className:"bg-yellow-900/20 border border-yellow-700/30 rounded p-2",children:[r("div",{className:"flex items-center gap-2 text-yellow-400 text-sm font-medium mb-1",children:[r("span",{children:"⚠️"}),r("span",{children:["Warnings (",e.warnings.length,")"]})]}),r("div",{className:"space-y-1",children:e.warnings.map((n,a)=>r("div",{className:"text-yellow-300 text-xs",children:["• ",n]},a))})]})]})}const Pl=[{id:"details",label:"Details"},{id:"json",label:"JSON"}];function Ul(){const e=E(()=>le.value.index),t=Wr,n=V("details"),a=V([]),l=E(()=>e.value>=0?e.value:null),s=E(()=>l.value===null?null:Hr(l.value)||null),i=E(()=>!!H.value.new),o=E(()=>i.value||s.value!=null),u=E(()=>{const h=H.value.new;return h||(s.value?s.value:t.value||null)}),c=E(()=>{const h=u.value;return h?on(h):null}),f=()=>{re("new",{id:"",layers:[]}),He(-1)},d=()=>{e.value<0||!t.value||re(e.value,{...t.value})},v=()=>{const h=i.value,_=h?"new":l.value,m=h?H.value.new:H.value[_];if(!m)return;const x=on(m);if(!x.valid){a.value=x.errors,te(`❌ Layer validation failed: ${x.errors[0]}`);return}const w=Ur(k.value,m);z(w);const L=w.layers.findIndex(T=>T.id===m.id);L>=0&&He(L),Re("new"),!h&&typeof _=="number"&&Re(_)},g=()=>{Re("new"),typeof l.value=="number"&&Re(l.value)},C=()=>{if(e.value<0||!t.value)return;const h=t.value.id||`Layer ${e.value+1}`;confirm(`Are you sure you want to delete layer "${h}"? This action cannot be undone.`)&&zn(e.value)},A=()=>{if(e.value<0||!t.value)return;const h=t.value,_={id:`${h.id}_copy`,layers:JSON.parse(JSON.stringify(h.layers||[]))};re("new",_),He(-1)},I=h=>{const _=i.value||l.value===null,m=_?"new":l.value,w={..._?H.value.new:H.value[m],...h};re(m,w)},$=(h,_)=>{const m=i.value||l.value===null,x=m?"new":l.value,w=m?H.value.new:H.value[x],L=[...w.layers||[]];L[h]={...L[h],..._},re(x,{...w,layers:L})},y=h=>{const _=i.value||l.value===null,m=_?"new":l.value,x=_?H.value.new:H.value[m],w=[...x.layers||[]];w.splice(h,1),re(m,{...x,layers:w})},D=(h="wms")=>{const _=i.value||l.value===null,m=_?"new":l.value,x=_?H.value.new:H.value[m],w={type:h,source:"",zIndex:0,options:{opacity:1}},L=[...x.layers||[],w];re(m,{...x,layers:L})},p=h=>{t.value&&l.value===e.value&&!s.value&&!i.value&&re(e.value,{...t.value});const m=i.value||l.value===null?"new":l.value;re(m,h)},N=E(()=>e.value>=0&&!!t.value),b=E(()=>t.value?.id?$r(k.value,t.value.id):[]),S=E(()=>t.value?.id?we(t.value.id):!1);return r("div",{className:"flex flex-col h-full",children:[r("div",{className:"flex flex-wrap gap-2 mb-3 items-center flex-shrink-0",children:[r("div",{children:[r("span",{className:"text-slate-500",children:o.value?e.value>=0?"Edit Layer":"New Layer":"Layer Details"}),u.value&&r("div",{className:"text-xs text-slate-400 mt-0.5",children:[u.value.id,S.value&&!o.value&&r("span",{className:"ml-2 text-xs bg-blue-600 text-white px-2 py-0.5 rounded",children:"Referenced"})]})]}),r("div",{className:"ml-auto flex gap-2",children:[!o.value&&N.value&&r(W,{children:[r("button",{className:"btn small",onClick:d,children:"Edit"}),r("button",{className:"btn ghost small",onClick:A,children:"Duplicate"}),r("button",{className:"btn danger small",onClick:C,children:"Delete"})]}),r("button",{className:"btn primary small",onClick:f,children:"New Layer"}),o.value&&r(W,{children:[r("button",{className:"btn success small",onClick:v,children:"Save"}),r("button",{className:"btn ghost small",onClick:g,children:"Cancel"})]})]})]}),u.value?r(W,{children:[r("div",{className:"flex gap-1 mb-3 border-b border-slate-700 pb-2 flex-shrink-0",children:Pl.map(h=>r("button",{className:`px-3 py-1.5 rounded-t-md text-xs transition-all duration-150 ${n.value===h.id?"bg-blue-500 text-white":"bg-slate-950 text-slate-500 border border-slate-700 hover:border-slate-600 hover:text-slate-200"}`,onClick:()=>n.value=h.id,children:h.label},h.id))}),r("div",{className:"flex-1 overflow-hidden",children:[n.value==="details"&&r("div",{className:"h-full overflow-auto",children:[r(cr,{validation:c.value,className:"mb-4"}),r("div",{className:"layer-section",children:r("div",{className:"form-group",children:[r("label",{className:"form-label",children:"Layer ID"}),r("input",{type:"text",className:"form-input",value:u.value.id,onChange:h=>I({id:h.target.value}),onBlur:h=>{const _=h.target.value.trim();if(!_)return;const m=k.value.layers||[];if(m.some((w,L)=>w.id===_&&L!==e.value)){let w=1,L=`${_}_${w}`;for(;m.some(T=>T.id===L);)w++,L=`${_}_${w}`;I({id:L}),h.target.value=L}},placeholder:"unique_layer_id",disabled:!o.value})]})}),r("div",{className:"layer-section",children:[r("div",{className:"flex items-center justify-between mb-2",children:[r("label",{className:"form-label",children:"Sublayers"}),o.value&&r("button",{className:"btn small",onClick:()=>D("wms"),children:"+ Add Sublayer"})]}),u.value.layers.length===0&&r("div",{className:"text-slate-500 text-sm",children:"No sublayers. Add one to get started."}),r("div",{className:"space-y-2",children:u.value.layers.map((h,_)=>r("div",{className:"border border-slate-600 rounded p-3 bg-slate-900",draggable:o.value&&u.value.layers.length>1,onDragStart:m=>{o.value&&(m.dataTransfer.setData("text/plain",_.toString()),m.dataTransfer.effectAllowed="move")},onDragOver:m=>{o.value&&(m.preventDefault(),m.dataTransfer.dropEffect="move")},onDrop:m=>{if(!o.value)return;m.preventDefault();const x=parseInt(m.dataTransfer.getData("text/plain"));if(x!==_){const L=[...u.value.layers||[]],T=L[x];L.splice(x,1),L.splice(_,0,T),I({layers:L})}},style:{cursor:o.value&&u.value.layers.length>1?"grab":"default"},children:[r("div",{className:"mb-2",children:[r("div",{className:"flex items-center gap-2 mb-1",children:[o.value&&u.value.layers.length>1&&r("div",{className:"cursor-move text-slate-400 hover:text-slate-300 px-1 select-none",title:"Drag to reorder",children:"⋮⋮"}),r("span",{className:"text-xs text-slate-400 font-mono",children:["#",_+1]}),r("div",{className:"flex-1 text-sm font-medium",children:h.type.toUpperCase()}),o.value&&r("button",{className:"btn tiny danger",onClick:()=>y(_),children:"×"})]}),r("div",{className:"text-xs text-slate-400 break-all pl-6",children:h.source||"No source"}),!o.value&&r("div",{className:"text-xs text-slate-500 pl-6 mt-1 space-y-0.5",children:[h.options?.opacity!==void 0&&h.options.opacity!==1&&r("div",{children:["Opacity: ",h.options.opacity]}),h.zIndex!==void 0&&h.zIndex!==0&&r("div",{children:["Z-Index: ",h.zIndex]}),h.refreshInterval&&r("div",{children:["Refresh: ",h.refreshInterval,"ms (",(h.refreshInterval/1e3).toFixed(1),"s)"]})]})]}),o.value&&r("div",{className:"space-y-2 text-xs",children:[r("div",{className:"grid grid-cols-2 gap-2",children:[r("div",{children:[r("label",{className:"block text-slate-400 mb-1",children:"Type"}),r("select",{className:"w-full px-2 py-1 text-xs bg-slate-800 border border-slate-600 rounded",value:h.type,onChange:m=>{const x=m.target.value,w=Pr(x),L=h.options||{},T={};L.opacity!==void 0&&(T.opacity=L.opacity),x==="wms"&&w.options?.layerNames?T.layerNames=w.options.layerNames:x==="portalItem"&&w.options?.layerId!==void 0&&(T.layerId=w.options.layerId),Object.entries(L).forEach(([O,P])=>{O!=="layerNames"&&O!=="layerId"&&O!=="opacity"&&(T[O]=P)}),$(_,{type:x,source:h.source,options:T})},children:jr.map(m=>r("option",{value:m,children:m.toUpperCase()},m))})]}),r("div",{children:[r("label",{className:"block text-slate-400 mb-1",children:"Opacity"}),r("input",{type:"text",className:"w-full px-2 py-1 text-xs bg-slate-800 border border-slate-600 rounded",placeholder:"0.0 - 1.0",defaultValue:h.options?.opacity??1,onBlur:m=>{const x=m.target.value.replace(",",".");let w=parseFloat(x);(isNaN(w)||x.trim()==="")&&(w=1),w<0&&(w=0),w>1&&(w=1),$(_,{options:{...h.options,opacity:w}}),m.target.value=w.toString()}})]})]}),r("div",{className:"grid grid-cols-2 gap-2",children:[r("div",{children:[r("label",{className:"block text-slate-400 mb-1",children:"Z-Index"}),r("input",{type:"number",className:"w-full px-2 py-1 text-xs bg-slate-800 border border-slate-600 rounded",value:h.zIndex??0,onChange:m=>$(_,{zIndex:parseInt(m.target.value)})})]}),r("div",{children:[r("label",{className:"block text-slate-400 mb-1",children:"Refresh Interval (ms)"}),r("input",{type:"number",className:"w-full px-2 py-1 text-xs bg-slate-800 border border-slate-600 rounded",value:h.refreshInterval||"",onChange:m=>{const x=m.target.value;$(_,{refreshInterval:x?parseInt(x):void 0})},placeholder:"60000",min:"0",step:"1000"})]})]}),r("div",{children:[r("label",{className:"block text-slate-400 mb-1",children:"Source URL/ID"}),r("input",{type:"text",className:"w-full px-2 py-1 text-xs bg-slate-800 border border-slate-600 rounded",value:h.source||"",onChange:m=>$(_,{source:m.target.value}),placeholder:h.type==="portalItem"?"e.g. abc123def456":h.type==="wms"?"https://example.com/wms":h.type==="tiled"?"https://example.com/tiles/{z}/{y}/{x}.png":h.type==="vectorTiled"?"https://example.com/vectortiles/{z}/{y}/{x}.pbf":h.type==="feature"?"https://example.com/arcgis/rest/services/FeatureServer/0":"https://example.com/arcgis/rest/services/MapServer"}),r("div",{className:"text-[10px] text-slate-500 mt-1",children:[h.type==="portalItem"&&"ArcGIS Online portal item ID",h.type==="wms"&&"WMS service endpoint URL",h.type==="tiled"&&"Tile template URL with {z}/{y}/{x}",h.type==="vectorTiled"&&"Vector tile template URL with {z}/{y}/{x}",h.type==="mapImage"&&"ArcGIS REST MapServer endpoint",h.type==="feature"&&"ArcGIS REST FeatureServer endpoint"]})]}),h.type==="portalItem"&&r("div",{children:[r("label",{className:"block text-slate-400 mb-1",children:"Portal Layer ID"}),r("input",{type:"number",className:"w-full px-2 py-1 text-xs bg-slate-800 border border-slate-600 rounded",value:h.options?.layerId||0,onChange:m=>$(_,{options:{...h.options||{},layerId:parseInt(m.target.value)||0}}),placeholder:"0"})]}),h.type==="wms"&&r("div",{children:[r("label",{className:"block text-slate-400 mb-1",children:["WMS Layer Names ",r("span",{className:"text-red-400",children:"*required"})]}),r("div",{className:"space-y-2",children:[(h.options?.layerNames||[]).length===0&&r("div",{className:"text-xs text-red-400 mb-2",children:"⚠️ WMS layers require at least one layer name"}),(h.options?.layerNames||["layer1"]).map((m,x)=>r("div",{className:"flex gap-2",children:[r("input",{type:"text",className:"w-full px-2 py-1 text-xs bg-slate-800 border border-slate-600 rounded",value:m,onChange:w=>{const L=[...h.options?.layerNames||[]];L[x]=w.target.value,$(_,{options:{...h.options||{},layerNames:L}})},onBlur:w=>{if(!w.target.value.trim()){const T=[...h.options?.layerNames||[]];T.length>1?(T.splice(x,1),$(_,{options:{...h.options||{},layerNames:T}})):(w.target.value=`layer${x+1}`,T[x]=`layer${x+1}`,$(_,{options:{...h.options||{},layerNames:T}}))}},placeholder:`layer${x+1}`}),(h.options?.layerNames||[]).length>1&&r("button",{type:"button",className:"btn tiny danger",onClick:()=>{const w=[...h.options?.layerNames||[]];w.splice(x,1),$(_,{options:{...h.options||{},layerNames:w}})},children:"×"})]},x)),r("button",{type:"button",className:"btn tiny",onClick:()=>{const m=[...h.options?.layerNames||[],""];$(_,{options:{...h.options||{},layerNames:m}})},children:"+ Add Layer Name"})]})]}),r("div",{children:[r("label",{className:"block text-slate-400 mb-1",children:"Custom Options"}),r("div",{className:"space-y-2",children:[Object.entries(h.options||{}).map(([m,x])=>m==="layerNames"||m==="layerId"||m==="opacity"?null:r("div",{className:"flex gap-2 items-center",children:[r("input",{type:"text",className:"w-1/3 px-2 py-1 text-xs bg-slate-800 border border-slate-600 rounded",value:m,onChange:w=>{const L=w.target.value,T={...h.options||{}};L!==m&&(delete T[m],L.trim()&&(T[L]=x),$(_,{options:T}))},placeholder:"key"}),r("span",{className:"text-slate-500",children:":"}),r("input",{type:"text",className:"flex-1 px-2 py-1 text-xs bg-slate-800 border border-slate-600 rounded",value:typeof x=="string"?x:JSON.stringify(x),onChange:w=>{let L=w.target.value;L==="true"?L=!0:L==="false"?L=!1:!isNaN(Number(L))&&L.trim()!==""&&(L=Number(L));const T={...h.options||{}};T[m]=L,$(_,{options:T})},placeholder:"value"}),r("button",{type:"button",className:"btn tiny danger",onClick:()=>{const w={...h.options||{}};delete w[m],$(_,{options:w})},title:"Remove option",children:"×"})]},m)),r("button",{type:"button",className:"btn tiny",onClick:()=>{const m={...h.options||{}};m.newOption="",$(_,{options:m})},children:"+ Add Custom Option"})]}),r("div",{className:"text-[10px] text-slate-500 mt-1",children:"Add custom properties. Values are auto-parsed (numbers, booleans, or strings)."})]})]})]},_))}),!o.value&&b.value.length>0&&r("div",{className:"form-group mt-3",children:[r("label",{className:"form-label",children:"Layer Usage"}),r("div",{className:"bg-slate-700 rounded p-3 text-sm",children:[r("div",{className:"text-slate-300 mb-2",children:["This layer is referenced by ",b.value.length," item(s):"]}),r("div",{className:"space-y-1 max-h-32 overflow-y-auto",children:b.value.map((h,_)=>r("div",{className:"text-slate-400 text-xs flex items-center gap-2",children:[r("span",{className:"bg-slate-600 px-2 py-0.5 rounded text-xs",children:h.featureType==="weatherFeatures"?"Weather":"Feature"}),r("span",{children:h.featureName}),r("span",{className:"text-slate-500",children:"→"}),r("span",{children:h.itemName})]},_))})]})]}),!o.value&&b.value.length===0&&t.value&&r("div",{className:"form-group mt-3",children:[r("label",{className:"form-label",children:"Layer Usage"}),r("div",{className:"bg-slate-700 rounded p-3 text-sm text-slate-400",children:["This layer is not currently referenced by any features or items.",r("br",{}),r("span",{className:"text-xs text-slate-500",children:"Consider deleting if no longer needed."})]})]})]})]}),n.value==="json"&&r("div",{className:"h-full min-h-0",children:r(kt,{title:"Selected Layer JSON",value:u.value,onChange:p,readOnly:!o.value,height:"100%"},`${l.value??"new"}:${o.value?"edit":"view"}`)})]})]}):r("div",{className:"text-center p-5 text-slate-500 flex-1 flex items-center justify-center",children:r("div",{children:[r("p",{children:"Select a layer to view/edit or create a new one"}),r("button",{className:"btn primary",onClick:f,children:"New Layer"})]})})]})}function Jl({feature:e,isEditing:t}){const n=E(()=>k.value),a=E(()=>{const f=[];return e.id?.trim()&&f.push(e.id),(e.items||[]).forEach(d=>{d.id?.trim()&&f.push(d.id),d.legendDescription?.trim()&&f.push(d.legendDescription)}),[...new Set(f)]}),l=E(()=>a.value.map(f=>{const d={};let v=0;return M.forEach(g=>{const C=n.value.intl?.[g]?.[f]||"";d[g]=C,C.trim()||v++}),{key:f,translations:d,missingCount:v,isComplete:v===0,completionPercentage:Math.round((M.length-v)/M.length*100)}})),s=E(()=>{if(l.value.length===0)return 100;const f=l.value.length*M.length,d=l.value.reduce((v,g)=>v+(M.length-g.missingCount),0);return Math.round(d/f*100)}),i=(f,d,v)=>{const g={...n.value,intl:{...n.value.intl}};g.intl[d]||(g.intl[d]={}),g.intl[d]={...g.intl[d],[f]:v},z(g)},o=f=>{const d=l.value.find(C=>C.key===f);if(!d)return;const v=d.translations.en;if(!v.trim())return;const g={...n.value,intl:{...n.value.intl}};M.forEach(C=>{C!=="en"&&!d.translations[C].trim()&&(g.intl[C]||(g.intl[C]={}),g.intl[C][f]=v)}),z(g)},u=f=>{if(!confirm(`Clear all translations for "${f}"?`))return;const d={...n.value,intl:{...n.value.intl}};M.forEach(v=>{d.intl[v]&&d.intl[v][f]&&delete d.intl[v][f]}),z(d)},c=f=>{if(f===e.id)return"Feature ID";const d=(e.items||[]).find(v=>v.id===f||v.legendDescription===f);if(d){if(d.id===f)return`Item ID (${d.name||"Unnamed"})`;if(d.legendDescription===f)return`Legend Description (${d.name||d.id||"Unnamed"})`}return"Unknown"};return a.value.length===0?r("div",{className:"h-full flex items-center justify-center",children:r("div",{className:"text-center text-slate-500",children:[r("div",{className:"text-4xl mb-3",children:"🌐"}),r("div",{className:"text-sm font-medium mb-1",children:"No Translation Keys"}),r("div",{className:"text-xs",children:"Add feature and item IDs to enable translations"})]})}):r("div",{className:"h-full flex flex-col",children:[r("div",{className:"mb-4 pb-3 border-b border-slate-700",children:[r("div",{className:"flex items-center justify-between mb-2",children:[r("h3",{className:"text-lg font-medium text-slate-200",children:"Translations"}),r("div",{className:"flex items-center gap-2",children:[r("span",{className:"text-xs text-slate-400",children:[a.value.length," key",a.value.length!==1?"s":""]}),r("div",{className:`pill ${s.value===100?"ok":s.value>50?"warn":"error"}`,children:[s.value,"% complete"]})]})]}),r("div",{className:"text-xs text-slate-500",children:"Manage translations for all feature and item IDs. Missing translations will fall back to English or the ID itself."})]}),r("div",{className:"flex-1 overflow-y-auto space-y-4",children:l.value.map(f=>r("div",{className:"border border-slate-600 rounded-lg p-4 bg-slate-900/50",children:[r("div",{className:"flex items-start justify-between mb-3",children:[r("div",{className:"flex-1 min-w-0",children:[r("div",{className:"flex items-center gap-2 mb-1",children:[r("code",{className:"text-sm text-slate-300 font-mono",children:f.key}),r("span",{className:"text-xs text-slate-500",children:["(",c(f.key),")"]})]}),r("div",{className:"flex items-center gap-2",children:[r("div",{className:`pill tiny ${f.isComplete?"ok":f.completionPercentage>50?"warn":"error"}`,children:[f.completionPercentage,"%"]}),f.missingCount>0&&r("span",{className:"text-xs text-orange-400",children:[f.missingCount," missing"]})]})]}),r("div",{className:"flex gap-1",children:[f.missingCount>0&&f.translations.en.trim()&&r("button",{className:"btn tiny",onClick:()=>o(f.key),disabled:!t,title:"Fill missing translations with English text",children:"Fill EN"}),r("button",{className:"btn danger tiny",onClick:()=>u(f.key),disabled:!t,title:"Clear all translations for this key",children:"Clear"})]})]}),r("div",{className:"grid gap-3",children:M.map(d=>r("div",{className:"grid grid-cols-4 gap-2 items-start",children:[r("div",{className:"flex items-center gap-2",children:[r("span",{className:"font-mono text-xs bg-slate-700 px-2 py-1 rounded text-center min-w-[2.5rem]",children:d.toUpperCase()}),d==="en"&&r("span",{className:"text-slate-500 text-xs",children:"Default"}),!f.translations[d].trim()&&r("span",{className:"text-orange-400 text-xs",children:"•"})]}),r("div",{className:"col-span-3",children:r("textarea",{className:"form-textarea text-xs",rows:2,value:f.translations[d],onInput:v=>i(f.key,d,v.target.value),placeholder:d==="en"?`Enter ${d.toUpperCase()} text`:`Translate to ${d.toUpperCase()}`,disabled:!t})})]},d))})]},f.key))}),r("div",{className:"mt-4 pt-3 border-t border-slate-700",children:r("div",{className:"text-xs text-slate-500",children:[r("div",{className:"mb-1",children:[r("strong",{children:"Translation Coverage:"})," ",M.length*a.value.length-l.value.reduce((f,d)=>f+d.missingCount,0),"/",M.length*a.value.length," entries complete"]}),!t&&r("div",{className:"text-slate-400",children:r("em",{children:"Enable editing mode to modify translations"})})]})})]})}function Rl({isOpen:e,selectedLayerIds:t,onClose:n,onSave:a}){const l=V(t),s=V([]);JSON.stringify(s.value)!==JSON.stringify(t)&&(l.value=[...t],s.value=[...t]);const i=E(()=>k.value.layers||[]),o=E(()=>{const v=new Set;return[...k.value.weatherFeatures||[],...k.value.features||[]].forEach(g=>{(g.items||[]).forEach(C=>{(C.layersIds||[]).forEach(A=>{t.includes(A)||v.add(A)})})}),v}),u=E(()=>i.value.map(g=>({id:g.id,title:g.id||"Unnamed Layer",isAssigned:o.value.has(g.id)})).sort((g,C)=>g.isAssigned!==C.isAssigned?g.isAssigned?1:-1:g.title.localeCompare(C.title))),c=v=>{const g=l.value||[];l.value=g.includes(v)?g.filter(C=>C!==v):[...g,v]},f=()=>{a(l.value),n()},d=()=>{l.value=t,n()};return e?r("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:d,children:r("div",{className:"bg-slate-800 border border-slate-600 rounded-lg w-96 max-h-[80vh] flex flex-col",onClick:v=>v.stopPropagation(),children:[r("div",{className:"p-4 border-b border-slate-700",children:[r("h3",{className:"text-lg font-medium text-white",children:"Select Layers"}),r("p",{className:"text-sm text-slate-400 mt-1",children:["Choose one or more layers for this item (",l.value.length," selected)"]})]}),r("div",{className:"flex-1 overflow-y-auto p-2 max-h-96",children:u.value.length===0?r("div",{className:"p-4 text-center text-slate-500",children:"No layers available"}):r("div",{className:"space-y-1",children:u.value.map(v=>{const g=l.value.includes(v.id);return r("label",{className:"flex items-center gap-3 p-2 hover:bg-slate-700 rounded cursor-pointer",children:[r("input",{type:"checkbox",className:"form-checkbox",checked:g,onChange:()=>c(v.id)}),r("div",{className:"flex-1",children:[r("div",{className:`text-sm ${v.isAssigned?"text-slate-200":"text-green-300 font-medium"} flex items-center gap-2`,children:[v.title,we(v.id)&&r("span",{className:"text-xs bg-blue-600 text-white px-1.5 py-0.5 rounded",children:"referenced"})]}),r("div",{className:"text-xs text-slate-500",children:["ID: ",v.id,!v.isAssigned&&r("span",{className:"ml-2 text-green-400",children:"• Available"}),v.isAssigned&&r("span",{className:"ml-2 text-orange-400",children:"• In use"})]})]})]},v.id)})})}),r("div",{className:"p-4 border-t border-slate-700 flex gap-2 justify-end",children:[r("button",{className:"btn ghost small",onClick:d,children:"Cancel"}),r("button",{className:"btn success small",onClick:f,children:["Save Selection (",l.value.length,")"]})]})]})}):null}function Vl({selectedLayerIds:e,onChange:t}){const n=V(!1),a=e.length,l=k.value.layers||[],s=e.map(o=>l.find(c=>c.id===o)?.id||o).slice(0,2),i=a===0?"No layers selected":a<=2?s.join(", "):`${s.join(", ")} +${a-2} more`;return r(W,{children:[r("button",{type:"button",className:"w-full px-2 py-1 text-xs bg-slate-800 border border-slate-600 rounded text-left hover:border-slate-500 focus:border-blue-500 transition-colors",onClick:()=>n.value=!0,children:r("div",{className:"flex items-center justify-between",children:[r("span",{className:a>0?"text-slate-200":"text-slate-500",children:i}),r("span",{className:"text-slate-400 text-xs",children:[a>0&&r("span",{className:"bg-blue-600 text-white px-1.5 py-0.5 rounded-full mr-1",children:a}),"Click to select..."]})]})}),r(Rl,{isOpen:n.value,selectedLayerIds:e,onClose:()=>n.value=!1,onSave:t})]})}const Wl=[{id:"details",label:"Details"},{id:"intl",label:"i18n"},{id:"json",label:"JSON"}],zl=e=>{if(!e)return"";const t=e.id||e.name;return t&&t.length>0?t:(e.items||[])[0]?.id||""},Hl=e=>{if(!e)return"";const t=e.name;if(t?.trim())return t;if(e.presentation==="single"){const n=(e.items||[])[0];if(n?.name?.trim())return n.name}return e.id||""},cn=()=>({presentation:"single",items:[{id:"",name:"",showLegend:!1,layersIds:[]}]});function ql(){const e=Z,t=Vr,n=V("details"),a=V({active:!1,featureType:"weatherFeatures",draft:null}),l=E(()=>a.value.active?a.value.draft:!e.value.type||e.value.index<0?null:qr(e.value.type,e.value.index)||null),s=E(()=>l.value!=null||a.value.active),i=E(()=>l.value?l.value:a.value.active?a.value.draft:t.value||null),o=E(()=>Hl(i.value)||"Unnamed Feature"),u=E(()=>zl(i.value)||"No ID"),c=E(()=>{const p=i.value;return p?Ml(p):null}),f=E(()=>i.value?.presentation==="single"&&(i.value.items||[]).length===1),d=E(()=>{const p=i.value;if(!p||p.presentation!=="single")return!1;const N=p.items||[];if(N.length!==1)return!1;const b=N[0],S=p.id?.trim(),h=p.name?.trim(),_=b?.id?.trim(),m=b?.name?.trim();return!S&&_||!h&&m}),v=E(()=>{if(!i.value)return{percentage:100,missingCount:0,totalKeys:0};const p=i.value,N=[];p.id?.trim()&&N.push(p.id),(p.items||[]).forEach(x=>{x.id?.trim()&&N.push(x.id),x.legendDescription?.trim()&&N.push(x.legendDescription)});const b=[...new Set(N)];if(b.length===0)return{percentage:100,missingCount:0,totalKeys:0};let S=0,h=0;b.forEach(x=>{M.forEach(w=>{S++;const L=k.value.intl?.[w]?.[x];L&&L.trim()&&h++})});const _=S>0?Math.round(h/S*100):100,m=S-h;return{percentage:_,missingCount:m,totalKeys:b.length}}),g=()=>{!e.value.type||e.value.index<0||!t.value||ot(e.value.type,e.value.index,{...t.value})},C=()=>{if(a.value.active)a.value={active:!1,featureType:"weatherFeatures",draft:null};else{if(!e.value.type||e.value.index<0)return;Ht(e.value.type,e.value.index)}},A=()=>{const p=l.value;if(!p)return;const N=a.value.active;if(!N&&(!e.value.type||e.value.index<0)||!p.presentation||!Array.isArray(p.items)||p.items.length===0)return;const b=p.presentation==="single"&&p.items.length===1;if(p.name!==void 0&&p.name!==null&&!p.name.trim()&&!b||p.id!==void 0&&p.id!==null&&!p.id.trim()&&!b||p.items.filter(O=>!O.id?.trim()||!O.name?.trim()).length>0)return;const h=p.items.map(O=>O.id.trim()),_=h.filter((O,P)=>h.indexOf(O)!==P);if(_.length>0){te(`❌ Duplicate item IDs found: ${[...new Set(_)].join(", ")}`);return}if(p.presentation==="multiple"){const O=p.items.filter(me=>!me.name?.trim()),P=p.name?.trim();if(O.length>0&&!P)return}if(p.items.filter(O=>!O.layersIds||O.layersIds.length===0).length>0)return;const x=new Set((k.value.layers||[]).map(O=>O.id)),w=new Set;if(p.items.forEach(O=>{(O.layersIds||[]).forEach(P=>{x.has(P)||w.add(P)})}),w.size>0){te(`❌ Invalid layer IDs: ${Array.from(w).join(", ")}`);return}const L=Mr(k.value,p),T=JSON.parse(JSON.stringify(L));if(N){const O=a.value.featureType==="weatherFeatures"?T.weatherFeatures:T.features;O.push(JSON.parse(JSON.stringify(p)));const P=a.value.featureType,me=O.length-1;a.value={active:!1,featureType:"weatherFeatures",draft:null},setTimeout(()=>{Vn(P,me)},0)}else e.value.type&&(T[e.value.type][e.value.index]=JSON.parse(JSON.stringify(p)),Ht(e.value.type,e.value.index));z(T)},I=p=>{if(a.value.active){const N=a.value.draft||cn();a.value={...a.value,draft:{...N,...p}}}else{if(!e.value.type||e.value.index<0)return;const N=l.value||t.value;ot(e.value.type,e.value.index,{...N,...p})}},$=p=>{if(a.value.active)a.value={...a.value,draft:p};else{if(!e.value.type||e.value.index<0)return;ot(e.value.type,e.value.index,p)}},y=()=>{const p=e.value.type==="features"?"features":"weatherFeatures";a.value={active:!0,featureType:p,draft:cn()}},D=()=>{if(!e.value.type||e.value.index<0||!i.value)return;const p=i.value,N=e.value.type,b={...p,id:p.id?`${p.id}_copy`:"",name:p.name?`${p.name} (Copy)`:"",items:(p.items||[]).map(S=>({...S,id:S.id?`${S.id}_copy`:"",name:S.name?`${S.name} (Copy)`:"",layersIds:[...S.layersIds||[]]}))};a.value={active:!0,featureType:N,draft:b}};return r("div",{className:"flex flex-col h-full",children:[r("div",{className:"flex flex-wrap gap-2 mb-3 items-center flex-shrink-0",children:[r("div",{children:[r("span",{className:"text-slate-500",children:a.value.active?"Create New Feature":s.value?"Edit Feature":"Feature Details"}),i.value&&r("div",{className:"text-xs text-slate-400 mt-0.5",children:a.value.active?`New ${a.value.featureType==="weatherFeatures"?"Weather":"General"} Feature`:`${o.value} ${u.value!==o.value&&`(${u.value})`}`}),a.value.active&&r("div",{className:"flex items-center gap-2 mt-2",children:[r("label",{className:"text-xs text-slate-400",children:"Category"}),r("select",{className:"form-select text-xs py-1 px-2",value:a.value.featureType,onChange:p=>{const N=p.target.value;a.value={...a.value,featureType:N}},children:[r("option",{value:"weatherFeatures",children:"Weather"}),r("option",{value:"features",children:"General"})]})]})]}),r("div",{className:"ml-auto flex gap-2",children:[!s.value&&e.value.type&&e.value.index>=0&&r(W,{children:[r("button",{className:"btn small",onClick:y,children:"New Feature"}),r("button",{className:"btn small",onClick:D,children:"Clone Feature"}),r("button",{className:"btn small",onClick:g,children:"Edit"})]}),!s.value&&(!e.value.type||e.value.index<0)&&r("button",{className:"btn small",onClick:y,children:"New Feature"}),s.value&&r(W,{children:[r("button",{className:"btn success small",onClick:A,children:a.value.active?"Create Feature":"Save"}),r("button",{className:"btn ghost small",onClick:C,children:"Cancel"})]})]})]}),i.value?r(W,{children:[r("div",{className:"flex gap-1 mb-3 border-b border-slate-700 pb-2 flex-shrink-0",children:Wl.map(p=>r("button",{className:`px-3 py-1.5 rounded-t-md text-xs transition-all duration-150 flex items-center gap-2 ${n.value===p.id?"bg-blue-500 text-white":"bg-slate-950 text-slate-500 border border-slate-700 hover:border-slate-600 hover:text-slate-200"}`,onClick:()=>n.value=p.id,children:[r("span",{children:p.label}),p.id==="intl"&&v.value.totalKeys>0&&r("span",{className:`text-xs px-1.5 py-0.5 rounded-full ${v.value.percentage===100?"bg-green-600 text-white":v.value.percentage>50?"bg-yellow-600 text-white":"bg-red-600 text-white"}`,children:[v.value.percentage,"%"]})]},p.id))}),r("div",{className:"flex-1 overflow-hidden",children:[n.value==="details"&&r("div",{className:"h-full overflow-auto",children:[r(cr,{validation:c.value,className:"mb-4"}),d.value&&s.value&&r("div",{className:"bg-blue-900/30 border border-blue-500/50 rounded p-3 mb-4",children:r("div",{className:"flex items-start gap-2",children:[r("div",{className:"text-blue-400 text-sm",children:"💡"}),r("div",{className:"flex-1",children:[r("div",{className:"text-blue-300 text-sm font-medium mb-1",children:"Single Item Feature Detected"}),r("div",{className:"text-blue-200 text-xs mb-2",children:"For single-item features, you can leave Feature ID and Name empty to inherit from the item."}),r("button",{className:"btn tiny",onClick:()=>{I({id:"",name:""})},children:"Clear Feature Fields"})]})]})}),r("div",{className:"layer-section",children:[r("div",{className:"form-group",children:[r("label",{className:"form-label",children:"Feature ID"}),r("input",{type:"text",className:"form-input",value:i.value.id||"",onChange:p=>I({id:p.target.value}),placeholder:i.value.presentation==="single"?"Leave empty to use first item ID":"e.g. icing_index, radar, wind_60min",disabled:!s.value}),r("div",{className:"text-xs text-slate-500 mt-1",children:i.value.presentation==="single"?"Optional - will inherit from first item if empty":"Optional unique identifier for this feature group"})]}),r("div",{className:"form-group",children:[r("label",{className:"form-label",children:"Feature Name"}),r("input",{type:"text",className:"form-input",value:i.value.name||"",onChange:p=>I({name:p.target.value}),placeholder:i.value.presentation==="single"?"Leave empty to use first item name":"e.g. Weather Layers, Navigation Features",disabled:!s.value}),r("div",{className:"text-xs text-slate-500 mt-1",children:i.value.presentation==="single"?"Optional - will inherit from first item if empty":"Optional display name for this feature group"})]}),r("div",{className:"form-group",children:[r("label",{className:"form-label",children:"Presentation"}),r("select",{className:"form-select",value:i.value.presentation,onChange:p=>I({presentation:p.target.value}),disabled:!s.value,children:[r("option",{value:"single",children:"Single"}),r("option",{value:"multiple",children:"Multiple"})]}),r("div",{className:"text-xs text-slate-500 mt-1",children:i.value.presentation==="single"?r(W,{children:[r("span",{className:"font-medium text-blue-300",children:"Single:"})," Only one item can be selected.",f.value&&r("span",{className:"text-blue-300",children:" Feature can inherit from item."})]}):r(W,{children:[r("span",{className:"font-medium text-green-300",children:"Multiple:"})," Multiple items can be selected. Feature should have its own name."]})})]}),i.value.presentation==="multiple"&&r("div",{className:"form-group",children:[r("label",{className:"form-label",children:"Mutually Exclusive"}),r("div",{children:[r("input",{type:"checkbox",className:"form-checkbox",checked:!!i.value.mutuallyExclusive,onChange:p=>I({mutuallyExclusive:p.target.checked}),disabled:!s.value}),r("span",{className:"text-slate-200 text-sm",children:"Only one item selectable at a time"})]}),r("div",{className:"text-xs text-slate-500 mt-1",children:"When enabled, selecting one item automatically deselects others"})]}),r("div",{className:"form-group",children:[r("label",{className:"form-label",children:["Items",(i.value.items||[]).length===0&&r("span",{className:"text-orange-400 text-xs ml-1",children:"(at least one required)"})]}),(i.value.items||[]).length===0?r("div",{className:"text-center p-4 border border-dashed border-slate-600 rounded bg-slate-900",children:[r("div",{className:"text-slate-400 text-sm mb-2",children:"No items defined"}),s.value&&r("button",{className:"btn small primary",onClick:()=>{I({items:[{id:"",name:"",showLegend:!1,layersIds:[]}]})},children:"Add First Item"})]}):r("div",{className:"space-y-2",children:[i.value&&(i.value.items||[]).map((p,N)=>r("div",{className:"border border-slate-600 rounded p-3 bg-slate-900",draggable:!!(s.value&&i.value&&(i.value.items||[]).length>1),onDragStart:b=>{!s.value||!b.dataTransfer||(b.dataTransfer.setData("text/plain",N.toString()),b.dataTransfer.effectAllowed="move")},onDragOver:b=>{!s.value||!b.dataTransfer||(b.preventDefault(),b.dataTransfer.dropEffect="move")},onDrop:b=>{if(!s.value||!b.dataTransfer||!i.value)return;b.preventDefault();const S=parseInt(b.dataTransfer.getData("text/plain"));if(S!==N){const h=[...i.value.items||[]],_=h[S];h.splice(S,1),h.splice(N,0,_),I({items:h})}},style:{opacity:(s.value&&i.value&&(i.value.items||[]).length>1,"1"),cursor:s.value&&i.value&&(i.value.items||[]).length>1?"grab":"default"},children:[r("div",{className:"flex items-center gap-2 mb-2",children:[s.value&&i.value&&(i.value.items||[]).length>1&&r("div",{className:"cursor-move text-slate-400 hover:text-slate-300 px-1 select-none",title:"Drag to reorder items",onMouseDown:b=>b.stopPropagation(),children:"⋮⋮"}),r("span",{className:"text-xs text-slate-400 font-mono",children:["#",N+1]}),r("div",{className:"flex-1",children:[r("div",{className:"text-sm font-medium",children:p.name||p.id||`Item ${N+1}`}),r("div",{className:"text-xs text-slate-500",children:["ID: ",p.id||"(empty)"," • Layers: ",(p.layersIds||[]).length," • Legend: ",p.showLegend?"Yes":"No"]})]}),s.value&&i.value&&r("button",{className:"btn tiny danger",onClick:()=>{if(!i.value)return;const b=[...i.value.items||[]];b.splice(N,1),I({items:b})},children:"×"})]}),s.value&&r("div",{className:"space-y-2 text-xs",children:[r("div",{className:"grid grid-cols-2 gap-2",children:[r("div",{children:[r("label",{className:"block text-slate-400 mb-1",children:"Item ID"}),r("input",{type:"text",className:"w-full px-2 py-1 text-xs bg-slate-800 border border-slate-600 rounded",value:p.id||"",onChange:b=>{if(!i.value)return;const S=[...i.value.items||[]];S[N]={...p,id:b.target.value},I({items:S})},placeholder:"e.g. icing_index"})]}),r("div",{children:[r("label",{className:"block text-slate-400 mb-1",children:"Item Name"}),r("input",{type:"text",className:"w-full px-2 py-1 text-xs bg-slate-800 border border-slate-600 rounded",value:p.name||"",onChange:b=>{if(!i.value)return;const S=[...i.value.items||[]];S[N]={...p,name:b.target.value},I({items:S})},placeholder:"e.g. Icing Index (60 min)"})]})]}),r("div",{children:[r("label",{className:"block text-slate-400 mb-1",children:"Layer IDs"}),r(Vl,{selectedLayerIds:p.layersIds||[],onChange:b=>{if(!i.value)return;const S=[...i.value.items||[]];S[N]={...p,layersIds:b},I({items:S})}})]}),r("div",{className:"flex items-center gap-2",children:[r("input",{type:"checkbox",className:"form-checkbox",checked:p.showLegend||!1,onChange:b=>{if(!i.value)return;const S=[...i.value.items||[]];S[N]={...p,showLegend:b.target.checked},I({items:S})}}),r("span",{className:"text-slate-400",children:"Show Legend"})]}),p.showLegend&&r("div",{className:"grid grid-cols-2 gap-2 mt-2",children:[r("div",{className:"col-span-2",children:[r("label",{className:"block text-slate-400 mb-1",children:"Legend URL (optional)"}),r("input",{type:"text",className:"w-full px-2 py-1 text-xs bg-slate-800 border border-slate-600 rounded",value:p.legendUrl||"",onChange:b=>{if(!i.value)return;const S=[...i.value.items||[]];S[N]={...p,legendUrl:b.target.value},I({items:S})},placeholder:"https://example.com/legend.png"})]}),r("div",{className:"col-span-2",children:[r("label",{className:"block text-slate-400 mb-1",children:"Legend Description Key (optional)"}),r("input",{type:"text",className:"w-full px-2 py-1 text-xs bg-slate-800 border border-slate-600 rounded",value:p.legendDescription||"",onChange:b=>{if(!i.value)return;const S=[...i.value.items||[]];S[N]={...p,legendDescription:b.target.value},I({items:S})},placeholder:"translation.key.for.legend_description"}),r("div",{className:"text-xs text-slate-500 mt-1",children:"Appears in i18n panel as a translatable key"})]})]})]})]},N)),i.value&&i.value.presentation!=="single"&&r("button",{className:"btn small w-full",onClick:()=>{if(s.value||g(),!i.value)return;const p={id:"",name:"",showLegend:!1,layersIds:[]};I({items:[...i.value.items||[],p]})},children:"+ Add Another Item"})]})]})]})]}),n.value==="intl"&&i.value&&r("div",{className:"h-full",children:r(Jl,{feature:i.value,isEditing:s.value},`${e.value.type??"none"}:${e.value.index}:${s.value?"edit":"view"}`)}),n.value==="json"&&r("div",{className:"h-full min-h-0",children:r(kt,{title:"Selected Feature JSON",value:i.value,onChange:$,readOnly:!s.value,height:"100%"},`${e.value.type??"none"}:${e.value.index}:${s.value?"edit":"view"}`)})]})]}):r("div",{className:"text-center p-5 text-slate-500 flex-1 flex items-center justify-center",children:a.value.active?"Creating new feature...":"Select a feature on the left to view/edit"})]})}function Bl(){const e=E(()=>Jr.value),t=e.value.missingLayers.length,n=e.value.unusedLayers.length,a=Object.entries(e.value.missingIntl).map(([l,s])=>({lang:l,count:s.length})).filter(l=>l.count>0);return!t&&!n&&a.length===0?null:r("div",{className:"fixed bottom-0 left-0 right-0 bg-slate-800 border-t border-slate-700 p-2 px-3 text-xs flex gap-3 items-center z-10",children:[t>0&&r("span",{className:`pill ${t>0?"bad":"ok"}`,children:["Missing layers: ",t]}),n>0&&r("span",{className:`pill ${n>0?"warn":"ok"}`,children:["Unused layers: ",n]}),a.map(({lang:l,count:s})=>r("span",{className:`pill ${s>0?"warn":"ok"}`,children:[l," missing: ",s]},l)),e.value.missingLayers.length>0&&r("div",{className:"text-slate-500 text-[10px]",children:["Missing: ",e.value.missingLayers.join(", ")]}),e.value.unusedLayers.length>0&&r("div",{className:"text-slate-500 text-[10px]",children:["Unused: ",e.value.unusedLayers.join(", ")]})]})}function Kl(){const e=E(()=>k.value),t=V(""),n=V(!1),a=V("any"),l=B(()=>{try{return[...Xe(e.value)].sort()}catch{return[]}},[e.value]),s=B(()=>{const o=t.value.toLowerCase().trim(),u=a.value,c=(f,d)=>{const v=e.value.intl?.[d]?.[f];return v===void 0||v===""};return l.filter(f=>{if(o){const d=f.toLowerCase().includes(o),v=M.some(g=>(e.value.intl?.[g]?.[f]||"").toLowerCase().includes(o));if(!d&&!v)return!1}if(n.value){if(u==="any"){if(!M.some(d=>c(f,d)))return!1}else if(!c(f,u))return!1}return!0})},[l,t.value,n.value,a.value,e.value]),i=(o,u,c)=>{const f={...e.value,intl:{...e.value.intl}};f.intl[u]={...f.intl[u]||{},[o]:c},z(f)};return l.length===0?r("div",{className:"p-4 text-center text-slate-500",children:"No translation keys found"}):r("div",{children:[r("div",{className:"flex gap-2 items-center mb-3",children:[r("button",{className:"btn small",onClick:Wn,children:"Fill missing from EN"}),r("input",{type:"text",className:"form-input",placeholder:"Search keys or translations…",value:t.value,onInput:o=>t.value=o.target.value}),r("label",{className:"flex items-center gap-2 text-xs text-slate-400",children:[r("input",{type:"checkbox",checked:n.value,onChange:o=>n.value=o.target.checked}),"Show missing only"]}),r("select",{className:"form-select text-xs",value:a.value,onChange:o=>a.value=o.target.value,children:[r("option",{value:"any",children:"Any language"}),M.map(o=>r("option",{value:o,children:o.toUpperCase()},o))]})]}),r("div",{className:"overflow-auto",children:r("table",{className:"w-full text-sm border-collapse",children:[r("thead",{children:r("tr",{children:[r("th",{className:"text-left p-2 border-b border-slate-700 sticky top-0 bg-slate-800",children:"Key"}),M.map(o=>r("th",{className:"text-left p-2 border-b border-slate-700 sticky top-0 bg-slate-800",children:o.toUpperCase()},o))]})}),r("tbody",{children:s.map(o=>r("tr",{className:"align-top",children:[r("td",{className:"p-2 border-b border-slate-800 text-slate-300 whitespace-nowrap",children:o}),M.map(u=>r("td",{className:"p-2 border-b border-slate-800 min-w-[220px]",children:r("input",{type:"text",className:"form-input w-full",value:e.value.intl?.[u]?.[o]??"",onInput:c=>i(o,u,c.target.value),placeholder:`[${u}] ${o}`})},u))]},o))})]})})]})}function Gl({translationKey:e,isSelected:t,onSelect:n}){const a=E(()=>k.value),l=B(()=>M.reduce((i,o)=>{const u=a.value.intl?.[o]?.[e];return i+(u===void 0||u===""?1:0)},0),[e,a.value]),s=B(()=>M.some(i=>{const o=a.value.intl?.[i]?.[e];return o!==void 0&&o!==""}),[e,a.value]);return r("div",{className:`feature-list-item ${t?"selected":""}`,onClick:n,children:[r("div",{className:"feature-info",children:[r("div",{className:"feature-name",children:e}),r("div",{className:"feature-details",children:[M.length-l,"/",M.length," languages",l>0&&` • ${l} missing`,!s&&" • No translations"]})]}),r("div",{className:"feature-actions",children:[l>0&&r("span",{className:"pill warn",children:["Missing ",l]}),!s&&r("span",{className:"pill bad",children:"Empty"}),l===0&&s&&r("span",{className:"pill ok",children:"Complete"})]})]})}function Yl({title:e,keys:t,selectedKey:n,onSelectKey:a}){return r("details",{open:!0,className:"feature-category",children:[r("summary",{className:"feature-category-header",children:e}),r("div",{className:"feature-category-content",children:t.length===0?r("div",{className:"p-3 text-slate-500 text-center",children:["No ",e.toLowerCase()," found"]}):t.map(l=>r(Gl,{translationKey:l,isSelected:n===l,onSelect:()=>a(l)},l))})]})}function Zl({selectedKey:e,onSelectKey:t}){const n=E(()=>k.value),a=V(""),l=V(!1),s=V("any"),i=B(()=>{try{return[...Xe(n.value)].sort()}catch{return[]}},[n.value]),o=B(()=>{const c=a.value.toLowerCase().trim(),f=s.value,d=(v,g)=>{const C=n.value.intl?.[g]?.[v];return C===void 0||C===""};return i.filter(v=>{if(c){const g=v.toLowerCase().includes(c),C=M.some(A=>(n.value.intl?.[A]?.[v]||"").toLowerCase().includes(c));if(!g&&!C)return!1}if(l.value){if(f==="any"){if(!M.some(g=>d(v,g)))return!1}else if(!d(v,f))return!1}return!0})},[i,a.value,l.value,s.value,n.value]),u=B(()=>{const c={"Weather Features":[],"General Features":[],Layers:[],Other:[]};return o.forEach(f=>{f.includes("weather")||f.includes("radar")||f.includes("wind")||f.includes("cloud")?c["Weather Features"].push(f):f.includes("layer")||f.includes("overlay")?c.Layers.push(f):f.includes("feature")||f.includes("item")?c["General Features"].push(f):c.Other.push(f)}),c},[o]);return i.length===0?r("div",{children:[r("div",{className:"mb-3",children:r("button",{className:"btn primary",disabled:!0,children:"No Translation Keys Found"})}),r("div",{className:"p-4 text-center text-slate-500",children:"Load a JSON file with translation keys to get started"})]}):r("div",{children:[r("div",{className:"mb-3",children:r("button",{className:"btn primary",onClick:Wn,children:"🌐 Fill Missing from EN"})}),r("div",{className:"flex flex-col gap-2 items-stretch mb-3",children:[r("input",{type:"text",className:"form-input",placeholder:"Search keys or translations…",value:a.value,onInput:c=>a.value=c.target.value}),r("div",{className:"flex gap-2 items-center",children:[r("label",{className:"flex items-center gap-2 text-xs text-slate-400",children:[r("input",{type:"checkbox",checked:l.value,onChange:c=>l.value=c.target.checked}),"Show missing only"]}),r("select",{className:"form-select text-xs flex-1",value:s.value,onChange:c=>s.value=c.target.value,children:[r("option",{value:"any",children:"Any language"}),M.map(c=>r("option",{value:c,children:c.toUpperCase()},c))]})]})]}),r("div",{className:"feature-browser",children:Object.entries(u).map(([c,f])=>f.length>0&&r(Yl,{title:c,keys:f,selectedKey:e,onSelectKey:t},c))})]})}function Ql({selectedKey:e}){const t=E(()=>k.value),n=B(()=>{if(!e)return null;const o={};return M.forEach(u=>{o[u]=t.value.intl?.[u]?.[e]??""}),o},[e,t.value]),a=B(()=>n?M.filter(o=>n[o]===void 0||n[o]===""):[],[n]),l=(o,u)=>{if(!e)return;const c={...t.value,intl:{...t.value.intl}};c.intl[o]={...c.intl[o]||{},[e]:u},z(c)},s=()=>{if(!e||!n)return;const o=n.en;if(!o)return;const u={...t.value,intl:{...t.value.intl}};a.forEach(c=>{u.intl[c]||(u.intl[c]={}),u.intl[c][e]=o}),z(u)},i=()=>{if(!e||!confirm("Are you sure you want to clear all translations for this key?"))return;const o={...t.value,intl:{...t.value.intl}};M.forEach(u=>{o.intl[u]&&o.intl[u][e]&&delete o.intl[u][e]}),z(o)};return e?n?r("div",{className:"h-full flex flex-col",children:[r("div",{className:"mb-4",children:[r("h3",{className:"text-lg font-medium text-slate-200 mb-1",children:"Translation Editor"}),r("div",{className:"flex items-center gap-2",children:[r("code",{className:"inline text-slate-400",children:e}),a.length>0&&r("span",{className:"pill warn",children:[a.length," missing"]}),a.length===0&&r("span",{className:"pill ok",children:"Complete"})]})]}),r("div",{className:"flex gap-2 mb-4",children:[a.length>0&&n.en&&r("button",{className:"btn small",onClick:s,children:"Fill missing from EN"}),r("button",{className:"btn danger small",onClick:i,children:"Clear all"})]}),r("div",{className:"flex-1 overflow-y-auto",children:r("div",{className:"space-y-4",children:M.map(o=>r("div",{className:"form-group",children:[r("label",{className:"form-label flex items-center gap-2",children:[r("span",{className:"font-mono text-xs bg-slate-700 px-2 py-1 rounded",children:o.toUpperCase()}),o==="en"&&r("span",{className:"text-slate-500 text-xs",children:"(Default)"}),a.includes(o)&&r("span",{className:"text-yellow-500 text-xs",children:"• Missing"})]}),r("textarea",{className:"form-textarea",rows:3,value:n[o],onInput:u=>l(o,u.target.value),placeholder:`Enter ${o.toUpperCase()} translation for "${e}"`}),o==="en"&&n[o]&&r("div",{className:"form-help",children:"This will be used as fallback for missing translations"})]},o))})}),r("div",{className:"mt-4 pt-4 border-t border-slate-700",children:r("div",{className:"text-xs text-slate-500",children:[r("div",{className:"mb-1",children:[r("strong",{children:"Translation Status:"})," ",M.length-a.length,"/",M.length," languages"]}),a.length>0&&r("div",{children:[r("strong",{children:"Missing:"})," ",a.map(o=>o.toUpperCase()).join(", ")]})]})})]}):r("div",{className:"h-full flex items-center justify-center",children:r("div",{className:"text-center text-slate-500",children:[r("div",{className:"text-6xl mb-4",children:"⚠️"}),r("div",{className:"text-lg font-medium mb-2",children:"Error Loading Translations"}),r("div",{className:"text-sm",children:"Unable to load translation data for this key"})]})}):r("div",{className:"h-full flex flex-col",children:[r("div",{className:"mb-4",children:[r("h3",{className:"text-lg font-medium text-slate-200 mb-2",children:"Translation Editor"}),r("p",{className:"text-slate-500 text-sm",children:"Select a translation key from the left panel to edit its translations."})]}),r("div",{className:"flex-1 flex items-center justify-center",children:r("div",{className:"text-center text-slate-500",children:[r("div",{className:"text-6xl mb-4",children:"🌐"}),r("div",{className:"text-lg font-medium mb-2",children:"No Key Selected"}),r("div",{className:"text-sm",children:"Choose a translation key to start editing"})]})})]})}function Xl(){const e=E(()=>k.value.layers?.map(n=>n.id).filter(Boolean)||[]),t=E(()=>ne.value.customLogicLayers);return r("div",{className:"max-h-[calc(100vh-180px)] overflow-auto",children:[r("div",{className:"mb-4",children:[r("h3",{className:"text-lg font-semibold mb-2",children:"Application Settings"}),r("p",{className:"text-sm text-slate-400 mb-4",children:"Configure layers with custom logic that are referenced in your application code."})]}),r("div",{className:"space-y-4",children:[r("div",{children:[r("h4",{className:"font-medium mb-3",children:"Referenced Layers"}),r("p",{className:"text-sm text-slate-400 mb-3",children:'Layers marked as "referenced" are used in your application code (Dart) and should be handled differently during validation.'}),r("div",{className:"space-y-3",children:[r("div",{className:"p-3 bg-slate-700 rounded",children:[r("div",{className:"text-sm font-medium mb-2",children:"Current Referenced Layers:"}),t.value.size===0?r("div",{className:"text-slate-400 text-sm italic",children:"None"}):r("div",{className:"font-mono text-sm text-blue-300",children:Array.from(t.value).join(", ")})]}),r("div",{className:"p-3 bg-slate-700 rounded",children:[r("div",{className:"text-sm font-medium mb-2",children:"Available Layers:"}),e.value.length===0?r("div",{className:"text-slate-400 text-sm",children:"No layers found. Add some layers first."}):r("div",{className:"flex flex-wrap gap-2",children:e.value.map(n=>r("button",{onClick:()=>kr(n),className:`px-2 py-1 rounded text-xs font-mono transition-colors ${we(n)?"bg-blue-600 text-white hover:bg-blue-700":"bg-slate-600 text-slate-300 hover:bg-slate-500"}`,children:[we(n)?"✓ ":"+ ",n]},n))})]})]})]}),r("div",{className:"mt-6 p-3 bg-slate-700 rounded text-sm",children:[r("h5",{className:"font-medium mb-2",children:'What does "Referenced" mean?'}),r("ul",{className:"text-slate-400 space-y-1 text-xs",children:[r("li",{children:"• Layer is referenced/used in your Dart application code"}),r("li",{children:"• Layer should be handled differently during validation"}),r("li",{children:"• Layer appears with visual indicators throughout the UI"}),r("li",{children:"• Settings are saved locally in your browser"})]})]}),t.value.size>0&&r("div",{className:"mt-4 p-3 bg-blue-900/20 border border-blue-700 rounded text-sm",children:[r("h5",{className:"font-medium mb-2 text-blue-300",children:["Referenced Layers (",t.value.size,")"]}),r("div",{className:"flex flex-wrap gap-1",children:Array.from(t.value).map(n=>r("span",{className:"font-mono text-xs bg-blue-600 text-white px-2 py-1 rounded",children:n},n))})]})]})]})}function es({onOpenClick:e}){return r("div",{className:"flex items-center justify-center min-h-[60vh]",onPaste:s=>{const i=s.clipboardData?.getData("text");if(i)try{const o=JSON.parse(i);z(o),te("✅ JSON pasted from clipboard")}catch{}},children:r("div",{className:"w-full max-w-2xl text-center p-8 border border-dashed border-slate-600 rounded-xl bg-slate-900/40",onDrop:s=>{s.preventDefault();const o=Array.from(s.dataTransfer?.files||[]).find(u=>u.type==="application/json"||u.name.endsWith(".json"));if(o){const u=new FileReader;u.onload=c=>{const f=c.target?.result;if(f)try{const d=JSON.parse(f);z(d),te("✅ JSON file loaded successfully")}catch{}},u.readAsText(o)}},onDragOver:s=>{s.preventDefault()},children:[r("h2",{className:"text-lg mb-2 text-slate-100",children:"Get Started"}),r("p",{className:"mb-4 text-slate-400",children:"Choose an option to begin"}),r("div",{className:"flex flex-col gap-2 items-center",children:[r("button",{className:"btn primary",onClick:()=>{z(jn())},children:"Start with Empty Structure"}),r("button",{className:"btn",onClick:e,children:"Open Existing JSON…"})]}),r("div",{className:"mt-4 text-xs text-slate-500",children:"Tip: You can also drop JSON files here or paste JSON"})]})})}const ts=[{id:"features",label:"Features"},{id:"layers",label:"Layers"},{id:"internationalization",label:"i18n"},{id:"json",label:"JSON"},{id:"settings",label:"Settings"}];function ns(){const e=R(null),t=V(null),n=V("split");Y(()=>{Le.value||zr()},[]);const a=()=>{e.current?.click()};return r("div",{className:"app",children:[r("input",{ref:e,type:"file",accept:"application/json,.json",style:{display:"none"},onChange:l=>{const s=l.target.files?.[0];if(s){const i=new FileReader;i.onload=o=>{const u=o.target?.result;if(u)try{const c=JSON.parse(u);z(c),te("✅ JSON file loaded successfully")}catch(c){te(`❌ Invalid JSON: ${c instanceof Error?c.message:"Parse error"}`)}},i.readAsText(s)}}}),Le.value&&r("header",{className:"flex gap-3 items-center p-3 border-b border-slate-700 sticky top-0 z-[5]",style:{background:"rgba(15, 17, 21, 0.9)",backdropFilter:"saturate(1.2) blur(6px)"},children:[r("h1",{className:"text-base m-0 mr-2 opacity-95",children:"Map Layers JSON Editor"}),r("button",{className:"btn",onClick:a,children:"Open JSON…"}),r("div",{className:"ml-auto",children:Le.value&&r("span",{className:"text-slate-500",children:Rr.value})})]}),Le.value?r("div",{className:"p-3 min-h-[calc(100vh-80px)]",children:[r("div",{className:"flex gap-1 mb-3 border-b border-slate-700 pb-2",children:ts.map(l=>r("button",{className:`px-4 py-2 rounded-t-md text-xs transition-all duration-150 text-decoration-none ${de.value===l.id?"bg-blue-500 text-white border-blue-500":"bg-slate-950 text-slate-500 border border-slate-700 hover:border-slate-600 hover:text-slate-200"}`,onClick:()=>de.value=l.id,children:l.label},l.id))}),de.value==="features"&&r("div",{className:"flex gap-3 h-[calc(100vh-200px)] overflow-hidden",children:[r("div",{className:"flex-1 min-w-0 bg-slate-800 border border-slate-700 rounded-xl p-3 flex flex-col",children:r(kl,{})}),r("div",{className:"flex-1 min-w-0 bg-slate-800 border border-slate-700 rounded-xl p-3 flex flex-col",children:r(ql,{})})]}),de.value==="layers"&&r("div",{className:"flex gap-3 h-[calc(100vh-200px)] overflow-hidden",children:[r("div",{className:"flex-1 min-w-0 bg-slate-800 border border-slate-700 rounded-xl p-3 flex flex-col",children:r(Tl,{})}),r("div",{className:"flex-1 min-w-0 bg-slate-800 border border-slate-700 rounded-xl p-3 flex flex-col",children:r(Ul,{})})]}),de.value==="internationalization"&&r("div",{children:[r("div",{className:"flex gap-1 mb-3 border-b border-slate-700 pb-2",children:[r("button",{className:`px-3 py-1.5 rounded text-xs transition-all duration-150 ${n.value==="split"?"bg-blue-500 text-white":"bg-slate-800 text-slate-500 border border-slate-700 hover:border-slate-600 hover:text-slate-200"}`,onClick:()=>n.value="split",children:"Split View"}),r("button",{className:`px-3 py-1.5 rounded text-xs transition-all duration-150 ${n.value==="table"?"bg-blue-500 text-white":"bg-slate-800 text-slate-500 border border-slate-700 hover:border-slate-600 hover:text-slate-200"}`,onClick:()=>n.value="table",children:"Table View"})]}),n.value==="split"&&r("div",{className:"flex gap-3 h-[calc(100vh-200px)] overflow-hidden",children:[r("div",{className:"flex-1 min-w-0 bg-slate-800 border border-slate-700 rounded-xl p-3 flex flex-col",children:r("div",{className:"flex-1 min-h-0 overflow-auto",children:r(Zl,{selectedKey:t.value,onSelectKey:l=>t.value=l})})}),r("div",{className:"flex-1 min-w-0 bg-slate-800 border border-slate-700 rounded-xl p-3 flex flex-col",children:r(Ql,{selectedKey:t.value})})]}),n.value==="table"&&r("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-3 flex flex-col h-[calc(100vh-200px)]",children:r("div",{className:"flex-1 min-h-0",children:r(Kl,{})})})]}),de.value==="json"&&r("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-3 flex flex-col h-[calc(100vh-180px)]",children:[r("div",{className:"flex-1 min-h-0",children:r(kt,{title:"Complete JSON Configuration",value:k.value,onChange:l=>{z(l)},height:"100%"})}),r("div",{className:"flex gap-2 mt-3 pt-3 border-t border-slate-700 flex-shrink-0",children:[r("button",{className:"btn small",onClick:()=>{const l=Fr(JSON.stringify(k.value));l.valid||te(`❌ Validation failed: ${l.errors.length} error(s), ${l.warnings.length} warning(s)`)},children:"Validate Structure"}),r("button",{className:"btn success small",onClick:()=>{try{const l=JSON.stringify(k.value,null,2),s=new Date().toISOString().slice(0,19).replace(/[:.]/g,"-");Lr(`map-layers-${s}.json`,l),te("✅ JSON file downloaded")}catch{}},children:"Download JSON"})]})]}),de.value==="settings"&&r("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-3",children:r(Xl,{})})]}):r("div",{className:"p-6",children:r(es,{onOpenClick:a})}),r(Bl,{})]})}xe(r(ns,{}),document.getElementById("app"));
