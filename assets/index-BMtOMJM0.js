(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))r(l);new MutationObserver(l=>{for(const s of l)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(l){const s={};return l.integrity&&(s.integrity=l.integrity),l.referrerPolicy&&(s.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?s.credentials="include":l.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(l){if(l.ep)return;l.ep=!0;const s=n(l);fetch(l.href,s)}})();var Me,$,dn,fn,fe,jt,vn,hn,mn,Nt,vt,ht,pn,Ie={},_n=[],ur=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,je=Array.isArray;function te(e,t){for(var n in t)e[n]=t[n];return e}function wt(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function se(e,t,n){var r,l,s,i={};for(s in t)s=="key"?r=t[s]:s=="ref"?l=t[s]:i[s]=t[s];if(arguments.length>2&&(i.children=arguments.length>3?Me.call(arguments,2):n),typeof e=="function"&&e.defaultProps!=null)for(s in e.defaultProps)i[s]===void 0&&(i[s]=e.defaultProps[s]);return ke(e,i,r,l,null)}function ke(e,t,n,r,l){var s={type:e,props:t,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:l??++dn,__i:-1,__u:0};return l==null&&$.vnode!=null&&$.vnode(s),s}function dr(){return{current:null}}function V(e){return e.children}function ee(e,t){this.props=e,this.context=t}function ye(e,t){if(t==null)return e.__?ye(e.__,e.__i+1):null;for(var n;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null)return n.__e;return typeof e.type=="function"?ye(e):null}function gn(e){var t,n;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null){e.__e=e.__c.base=n.__e;break}return gn(e)}}function mt(e){(!e.__d&&(e.__d=!0)&&fe.push(e)&&!Be.__r++||jt!=$.debounceRendering)&&((jt=$.debounceRendering)||vn)(Be)}function Be(){for(var e,t,n,r,l,s,i,o=1;fe.length;)fe.length>o&&fe.sort(hn),e=fe.shift(),o=fe.length,e.__d&&(n=void 0,l=(r=(t=e).__v).__e,s=[],i=[],t.__P&&((n=te({},r)).__v=r.__v+1,$.vnode&&$.vnode(n),St(t.__P,n,r,t.__n,t.__P.namespaceURI,32&r.__u?[l]:null,s,l??ye(r),!!(32&r.__u),i),n.__v=r.__v,n.__.__k[n.__i]=n,xn(s,n,i),n.__e!=l&&gn(n)));Be.__r=0}function yn(e,t,n,r,l,s,i,o,d,c,f){var u,m,p,S,C,I,D=r&&r.__k||_n,b=t.length;for(d=fr(n,t,D,d,b),u=0;u<b;u++)(p=n.__k[u])!=null&&(m=p.__i==-1?Ie:D[p.__i]||Ie,p.__i=u,I=St(e,p,m,l,s,i,o,d,c,f),S=p.__e,p.ref&&m.ref!=p.ref&&(m.ref&&Ct(m.ref,null,p),f.push(p.ref,p.__c||S,p)),C==null&&S!=null&&(C=S),4&p.__u||m.__k===p.__k?d=bn(p,d,e):typeof p.type=="function"&&I!==void 0?d=I:S&&(d=S.nextSibling),p.__u&=-7);return n.__e=C,d}function fr(e,t,n,r,l){var s,i,o,d,c,f=n.length,u=f,m=0;for(e.__k=new Array(l),s=0;s<l;s++)(i=t[s])!=null&&typeof i!="boolean"&&typeof i!="function"?(d=s+m,(i=e.__k[s]=typeof i=="string"||typeof i=="number"||typeof i=="bigint"||i.constructor==String?ke(null,i,null,null,null):je(i)?ke(V,{children:i},null,null,null):i.constructor==null&&i.__b>0?ke(i.type,i.props,i.key,i.ref?i.ref:null,i.__v):i).__=e,i.__b=e.__b+1,o=null,(c=i.__i=vr(i,n,d,u))!=-1&&(u--,(o=n[c])&&(o.__u|=2)),o==null||o.__v==null?(c==-1&&(l>f?m--:l<f&&m++),typeof i.type!="function"&&(i.__u|=4)):c!=d&&(c==d-1?m--:c==d+1?m++:(c>d?m--:m++,i.__u|=4))):e.__k[s]=null;if(u)for(s=0;s<f;s++)(o=n[s])!=null&&!(2&o.__u)&&(o.__e==r&&(r=ye(o)),wn(o,o));return r}function bn(e,t,n){var r,l;if(typeof e.type=="function"){for(r=e.__k,l=0;r&&l<r.length;l++)r[l]&&(r[l].__=e,t=bn(r[l],t,n));return t}e.__e!=t&&(t&&e.type&&!n.contains(t)&&(t=ye(e)),n.insertBefore(e.__e,t||null),t=e.__e);do t=t&&t.nextSibling;while(t!=null&&t.nodeType==8);return t}function ae(e,t){return t=t||[],e==null||typeof e=="boolean"||(je(e)?e.some(function(n){ae(n,t)}):t.push(e)),t}function vr(e,t,n,r){var l,s,i,o=e.key,d=e.type,c=t[n],f=c!=null&&(2&c.__u)==0;if(c===null&&e.key==null||f&&o==c.key&&d==c.type)return n;if(r>(f?1:0)){for(l=n-1,s=n+1;l>=0||s<t.length;)if((c=t[i=l>=0?l--:s++])!=null&&!(2&c.__u)&&o==c.key&&d==c.type)return i}return-1}function Pt(e,t,n){t[0]=="-"?e.setProperty(t,n??""):e[t]=n==null?"":typeof n!="number"||ur.test(t)?n:n+"px"}function Ue(e,t,n,r,l){var s,i;e:if(t=="style")if(typeof n=="string")e.style.cssText=n;else{if(typeof r=="string"&&(e.style.cssText=r=""),r)for(t in r)n&&t in n||Pt(e.style,t,"");if(n)for(t in n)r&&n[t]==r[t]||Pt(e.style,t,n[t])}else if(t[0]=="o"&&t[1]=="n")s=t!=(t=t.replace(mn,"$1")),i=t.toLowerCase(),t=i in e||t=="onFocusOut"||t=="onFocusIn"?i.slice(2):t.slice(2),e.l||(e.l={}),e.l[t+s]=n,n?r?n.u=r.u:(n.u=Nt,e.addEventListener(t,s?ht:vt,s)):e.removeEventListener(t,s?ht:vt,s);else{if(l=="http://www.w3.org/2000/svg")t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!="width"&&t!="height"&&t!="href"&&t!="list"&&t!="form"&&t!="tabIndex"&&t!="download"&&t!="rowSpan"&&t!="colSpan"&&t!="role"&&t!="popover"&&t in e)try{e[t]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&t[4]!="-"?e.removeAttribute(t):e.setAttribute(t,t=="popover"&&n==1?"":n))}}function At(e){return function(t){if(this.l){var n=this.l[t.type+e];if(t.t==null)t.t=Nt++;else if(t.t<n.u)return;return n($.event?$.event(t):t)}}}function St(e,t,n,r,l,s,i,o,d,c){var f,u,m,p,S,C,I,D,b,v,_,y,N,h,w,g,x,k=t.type;if(t.constructor!=null)return null;128&n.__u&&(d=!!(32&n.__u),s=[o=t.__e=n.__e]),(f=$.__b)&&f(t);e:if(typeof k=="function")try{if(D=t.props,b="prototype"in k&&k.prototype.render,v=(f=k.contextType)&&r[f.__c],_=f?v?v.props.value:f.__:r,n.__c?I=(u=t.__c=n.__c).__=u.__E:(b?t.__c=u=new k(D,_):(t.__c=u=new ee(D,_),u.constructor=k,u.render=mr),v&&v.sub(u),u.props=D,u.state||(u.state={}),u.context=_,u.__n=r,m=u.__d=!0,u.__h=[],u._sb=[]),b&&u.__s==null&&(u.__s=u.state),b&&k.getDerivedStateFromProps!=null&&(u.__s==u.state&&(u.__s=te({},u.__s)),te(u.__s,k.getDerivedStateFromProps(D,u.__s))),p=u.props,S=u.state,u.__v=t,m)b&&k.getDerivedStateFromProps==null&&u.componentWillMount!=null&&u.componentWillMount(),b&&u.componentDidMount!=null&&u.__h.push(u.componentDidMount);else{if(b&&k.getDerivedStateFromProps==null&&D!==p&&u.componentWillReceiveProps!=null&&u.componentWillReceiveProps(D,_),!u.__e&&u.shouldComponentUpdate!=null&&u.shouldComponentUpdate(D,u.__s,_)===!1||t.__v==n.__v){for(t.__v!=n.__v&&(u.props=D,u.state=u.__s,u.__d=!1),t.__e=n.__e,t.__k=n.__k,t.__k.some(function(E){E&&(E.__=t)}),y=0;y<u._sb.length;y++)u.__h.push(u._sb[y]);u._sb=[],u.__h.length&&i.push(u);break e}u.componentWillUpdate!=null&&u.componentWillUpdate(D,u.__s,_),b&&u.componentDidUpdate!=null&&u.__h.push(function(){u.componentDidUpdate(p,S,C)})}if(u.context=_,u.props=D,u.__P=e,u.__e=!1,N=$.__r,h=0,b){for(u.state=u.__s,u.__d=!1,N&&N(t),f=u.render(u.props,u.state,u.context),w=0;w<u._sb.length;w++)u.__h.push(u._sb[w]);u._sb=[]}else do u.__d=!1,N&&N(t),f=u.render(u.props,u.state,u.context),u.state=u.__s;while(u.__d&&++h<25);u.state=u.__s,u.getChildContext!=null&&(r=te(te({},r),u.getChildContext())),b&&!m&&u.getSnapshotBeforeUpdate!=null&&(C=u.getSnapshotBeforeUpdate(p,S)),g=f,f!=null&&f.type===V&&f.key==null&&(g=Nn(f.props.children)),o=yn(e,je(g)?g:[g],t,n,r,l,s,i,o,d,c),u.base=t.__e,t.__u&=-161,u.__h.length&&i.push(u),I&&(u.__E=u.__=null)}catch(E){if(t.__v=null,d||s!=null)if(E.then){for(t.__u|=d?160:128;o&&o.nodeType==8&&o.nextSibling;)o=o.nextSibling;s[s.indexOf(o)]=null,t.__e=o}else{for(x=s.length;x--;)wt(s[x]);pt(t)}else t.__e=n.__e,t.__k=n.__k,E.then||pt(t);$.__e(E,t,n)}else s==null&&t.__v==n.__v?(t.__k=n.__k,t.__e=n.__e):o=t.__e=hr(n.__e,t,n,r,l,s,i,d,c);return(f=$.diffed)&&f(t),128&t.__u?void 0:o}function pt(e){e&&e.__c&&(e.__c.__e=!0),e&&e.__k&&e.__k.forEach(pt)}function xn(e,t,n){for(var r=0;r<n.length;r++)Ct(n[r],n[++r],n[++r]);$.__c&&$.__c(t,e),e.some(function(l){try{e=l.__h,l.__h=[],e.some(function(s){s.call(l)})}catch(s){$.__e(s,l.__v)}})}function Nn(e){return typeof e!="object"||e==null||e.__b&&e.__b>0?e:je(e)?e.map(Nn):te({},e)}function hr(e,t,n,r,l,s,i,o,d){var c,f,u,m,p,S,C,I=n.props,D=t.props,b=t.type;if(b=="svg"?l="http://www.w3.org/2000/svg":b=="math"?l="http://www.w3.org/1998/Math/MathML":l||(l="http://www.w3.org/1999/xhtml"),s!=null){for(c=0;c<s.length;c++)if((p=s[c])&&"setAttribute"in p==!!b&&(b?p.localName==b:p.nodeType==3)){e=p,s[c]=null;break}}if(e==null){if(b==null)return document.createTextNode(D);e=document.createElementNS(l,b,D.is&&D),o&&($.__m&&$.__m(t,s),o=!1),s=null}if(b==null)I===D||o&&e.data==D||(e.data=D);else{if(s=s&&Me.call(e.childNodes),I=n.props||Ie,!o&&s!=null)for(I={},c=0;c<e.attributes.length;c++)I[(p=e.attributes[c]).name]=p.value;for(c in I)if(p=I[c],c!="children"){if(c=="dangerouslySetInnerHTML")u=p;else if(!(c in D)){if(c=="value"&&"defaultValue"in D||c=="checked"&&"defaultChecked"in D)continue;Ue(e,c,null,p,l)}}for(c in D)p=D[c],c=="children"?m=p:c=="dangerouslySetInnerHTML"?f=p:c=="value"?S=p:c=="checked"?C=p:o&&typeof p!="function"||I[c]===p||Ue(e,c,p,I[c],l);if(f)o||u&&(f.__html==u.__html||f.__html==e.innerHTML)||(e.innerHTML=f.__html),t.__k=[];else if(u&&(e.innerHTML=""),yn(t.type=="template"?e.content:e,je(m)?m:[m],t,n,r,b=="foreignObject"?"http://www.w3.org/1999/xhtml":l,s,i,s?s[0]:n.__k&&ye(n,0),o,d),s!=null)for(c=s.length;c--;)wt(s[c]);o||(c="value",b=="progress"&&S==null?e.removeAttribute("value"):S!=null&&(S!==e[c]||b=="progress"&&!S||b=="option"&&S!=I[c])&&Ue(e,c,S,I[c],l),c="checked",C!=null&&C!=e[c]&&Ue(e,c,C,I[c],l))}return e}function Ct(e,t,n){try{if(typeof e=="function"){var r=typeof e.__u=="function";r&&e.__u(),r&&t==null||(e.__u=e(t))}else e.current=t}catch(l){$.__e(l,n)}}function wn(e,t,n){var r,l;if($.unmount&&$.unmount(e),(r=e.ref)&&(r.current&&r.current!=e.__e||Ct(r,null,t)),(r=e.__c)!=null){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(s){$.__e(s,t)}r.base=r.__P=null}if(r=e.__k)for(l=0;l<r.length;l++)r[l]&&wn(r[l],t,n||typeof e.type!="function");n||wt(e.__e),e.__c=e.__=e.__e=void 0}function mr(e,t,n){return this.constructor(e,n)}function be(e,t,n){var r,l,s,i;t==document&&(t=document.documentElement),$.__&&$.__(e,t),l=(r=typeof n=="function")?null:n&&n.__k||t.__k,s=[],i=[],St(t,e=(!r&&n||t).__k=se(V,null,[e]),l||Ie,Ie,t.namespaceURI,!r&&n?[n]:l?null:t.firstChild?Me.call(t.childNodes):null,s,!r&&n?n:l?l.__e:t.firstChild,r,i),xn(s,e,i)}function Sn(e,t){be(e,t,Sn)}function pr(e,t,n){var r,l,s,i,o=te({},e.props);for(s in e.type&&e.type.defaultProps&&(i=e.type.defaultProps),t)s=="key"?r=t[s]:s=="ref"?l=t[s]:o[s]=t[s]===void 0&&i!=null?i[s]:t[s];return arguments.length>2&&(o.children=arguments.length>3?Me.call(arguments,2):n),ke(e.type,o,r||e.key,l||e.ref,null)}function _r(e){function t(n){var r,l;return this.getChildContext||(r=new Set,(l={})[t.__c]=this,this.getChildContext=function(){return l},this.componentWillUnmount=function(){r=null},this.shouldComponentUpdate=function(s){this.props.value!=s.value&&r.forEach(function(i){i.__e=!0,mt(i)})},this.sub=function(s){r.add(s);var i=s.componentWillUnmount;s.componentWillUnmount=function(){r&&r.delete(s),i&&i.call(s)}}),n.children}return t.__c="__cC"+pn++,t.__=e,t.Provider=t.__l=(t.Consumer=function(n,r){return n.children(r)}).contextType=t,t}Me=_n.slice,$={__e:function(e,t,n,r){for(var l,s,i;t=t.__;)if((l=t.__c)&&!l.__)try{if((s=l.constructor)&&s.getDerivedStateFromError!=null&&(l.setState(s.getDerivedStateFromError(e)),i=l.__d),l.componentDidCatch!=null&&(l.componentDidCatch(e,r||{}),i=l.__d),i)return l.__E=l}catch(o){e=o}throw e}},dn=0,fn=function(e){return e!=null&&e.constructor==null},ee.prototype.setState=function(e,t){var n;n=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=te({},this.state),typeof e=="function"&&(e=e(te({},n),this.props)),e&&te(n,e),e!=null&&this.__v&&(t&&this._sb.push(t),mt(this))},ee.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),mt(this))},ee.prototype.render=V,fe=[],vn=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,hn=function(e,t){return e.__v.__b-t.__v.__b},Be.__r=0,mn=/(PointerCapture)$|Capture$/i,Nt=0,vt=At(!1),ht=At(!0),pn=0;var gr=0;function a(e,t,n,r,l,s){t||(t={});var i,o,d=t;if("ref"in d)for(o in d={},t)o=="ref"?i=t[o]:d[o]=t[o];var c={type:e,props:d,key:n,ref:i,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--gr,__i:-1,__u:0,__source:l,__self:s};if(typeof e=="function"&&(i=e.defaultProps))for(o in i)d[o]===void 0&&(d[o]=i[o]);return $.vnode&&$.vnode(c),c}var ce,A,st,Ut,xe=0,Cn=[],U=$,Jt=U.__b,Rt=U.__r,Vt=U.diffed,Wt=U.__c,Ht=U.unmount,zt=U.__;function we(e,t){U.__h&&U.__h(A,e,xe||t),xe=0;var n=A.__H||(A.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({}),n.__[e]}function he(e){return xe=1,$t(Dn,e)}function $t(e,t,n){var r=we(ce++,2);if(r.t=e,!r.__c&&(r.__=[n?n(t):Dn(void 0,t),function(o){var d=r.__N?r.__N[0]:r.__[0],c=r.t(d,o);d!==c&&(r.__N=[c,r.__[1]],r.__c.setState({}))}],r.__c=A,!A.__f)){var l=function(o,d,c){if(!r.__c.__H)return!0;var f=r.__c.__H.__.filter(function(m){return!!m.__c});if(f.every(function(m){return!m.__N}))return!s||s.call(this,o,d,c);var u=r.__c.props!==o;return f.forEach(function(m){if(m.__N){var p=m.__[0];m.__=m.__N,m.__N=void 0,p!==m.__[0]&&(u=!0)}}),s&&s.call(this,o,d,c)||u};A.__f=!0;var s=A.shouldComponentUpdate,i=A.componentWillUpdate;A.componentWillUpdate=function(o,d,c){if(this.__e){var f=s;s=void 0,l(o,d,c),s=f}i&&i.call(this,o,d,c)},A.shouldComponentUpdate=l}return r.__N||r.__}function Z(e,t){var n=we(ce++,3);!U.__s&&Lt(n.__H,t)&&(n.__=e,n.u=t,A.__H.__h.push(n))}function Pe(e,t){var n=we(ce++,4);!U.__s&&Lt(n.__H,t)&&(n.__=e,n.u=t,A.__h.push(n))}function J(e){return xe=5,K(function(){return{current:e}},[])}function $n(e,t,n){xe=6,Pe(function(){if(typeof e=="function"){var r=e(t());return function(){e(null),r&&typeof r=="function"&&r()}}if(e)return e.current=t(),function(){return e.current=null}},n==null?n:n.concat(e))}function K(e,t){var n=we(ce++,7);return Lt(n.__H,t)&&(n.__=e(),n.__H=t,n.__h=e),n.__}function Fe(e,t){return xe=8,K(function(){return e},t)}function Ln(e){var t=A.context[e.__c],n=we(ce++,9);return n.c=e,t?(n.__==null&&(n.__=!0,t.sub(A)),t.props.value):e.__}function On(e,t){U.useDebugValue&&U.useDebugValue(t?t(e):e)}function kn(){var e=we(ce++,11);if(!e.__){for(var t=A.__v;t!==null&&!t.__m&&t.__!==null;)t=t.__;var n=t.__m||(t.__m=[0,0]);e.__="P"+n[0]+"-"+n[1]++}return e.__}function yr(){for(var e;e=Cn.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(We),e.__H.__h.forEach(_t),e.__H.__h=[]}catch(t){e.__H.__h=[],U.__e(t,e.__v)}}U.__b=function(e){A=null,Jt&&Jt(e)},U.__=function(e,t){e&&t.__k&&t.__k.__m&&(e.__m=t.__k.__m),zt&&zt(e,t)},U.__r=function(e){Rt&&Rt(e),ce=0;var t=(A=e.__c).__H;t&&(st===A?(t.__h=[],A.__h=[],t.__.forEach(function(n){n.__N&&(n.__=n.__N),n.u=n.__N=void 0})):(t.__h.forEach(We),t.__h.forEach(_t),t.__h=[],ce=0)),st=A},U.diffed=function(e){Vt&&Vt(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(Cn.push(t)!==1&&Ut===U.requestAnimationFrame||((Ut=U.requestAnimationFrame)||br)(yr)),t.__H.__.forEach(function(n){n.u&&(n.__H=n.u),n.u=void 0})),st=A=null},U.__c=function(e,t){t.some(function(n){try{n.__h.forEach(We),n.__h=n.__h.filter(function(r){return!r.__||_t(r)})}catch(r){t.some(function(l){l.__h&&(l.__h=[])}),t=[],U.__e(r,n.__v)}}),Wt&&Wt(e,t)},U.unmount=function(e){Ht&&Ht(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach(function(r){try{We(r)}catch(l){t=l}}),n.__H=void 0,t&&U.__e(t,n.__v))};var qt=typeof requestAnimationFrame=="function";function br(e){var t,n=function(){clearTimeout(r),qt&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,35);qt&&(t=requestAnimationFrame(n))}function We(e){var t=A,n=e.__c;typeof n=="function"&&(e.__c=void 0,n()),A=t}function _t(e){var t=A;e.__c=e.__(),A=t}function Lt(e,t){return!e||e.length!==t.length||t.some(function(n,r){return n!==e[r]})}function Dn(e,t){return typeof t=="function"?t(e):t}var xr=Symbol.for("preact-signals");function Ot(){if(_e>1)_e--;else{for(var e,t=!1;De!==void 0;){var n=De;for(De=void 0,gt++;n!==void 0;){var r=n.o;if(n.o=void 0,n.f&=-3,!(8&n.f)&&Fn(n))try{n.c()}catch(l){t||(e=l,t=!0)}n=r}}if(gt=0,_e--,t)throw e}}var T=void 0;function En(e){var t=T;T=void 0;try{return e()}finally{T=t}}var De=void 0,_e=0,gt=0,Ge=0;function In(e){if(T!==void 0){var t=e.n;if(t===void 0||t.t!==T)return t={i:0,S:e,p:T.s,n:void 0,t:T,e:void 0,x:void 0,r:t},T.s!==void 0&&(T.s.n=t),T.s=t,e.n=t,32&T.f&&e.S(t),t;if(t.i===-1)return t.i=0,t.n!==void 0&&(t.n.p=t.p,t.p!==void 0&&(t.p.n=t.n),t.p=T.s,t.n=void 0,T.s.n=t,T.s=t),t}}function z(e,t){this.v=e,this.i=0,this.n=void 0,this.t=void 0,this.W=t?.watched,this.Z=t?.unwatched}z.prototype.brand=xr;z.prototype.h=function(){return!0};z.prototype.S=function(e){var t=this,n=this.t;n!==e&&e.e===void 0&&(e.x=n,this.t=e,n!==void 0?n.e=e:En(function(){var r;(r=t.W)==null||r.call(t)}))};z.prototype.U=function(e){var t=this;if(this.t!==void 0){var n=e.e,r=e.x;n!==void 0&&(n.x=r,e.e=void 0),r!==void 0&&(r.e=n,e.x=void 0),e===this.t&&(this.t=r,r===void 0&&En(function(){var l;(l=t.Z)==null||l.call(t)}))}};z.prototype.subscribe=function(e){var t=this;return Dt(function(){var n=t.value,r=T;T=void 0;try{e(n)}finally{T=r}})};z.prototype.valueOf=function(){return this.value};z.prototype.toString=function(){return this.value+""};z.prototype.toJSON=function(){return this.value};z.prototype.peek=function(){var e=T;T=void 0;try{return this.value}finally{T=e}};Object.defineProperty(z.prototype,"value",{get:function(){var e=In(this);return e!==void 0&&(e.i=this.i),this.v},set:function(e){if(e!==this.v){if(gt>100)throw new Error("Cycle detected");this.v=e,this.i++,Ge++,_e++;try{for(var t=this.t;t!==void 0;t=t.x)t.t.N()}finally{Ot()}}}});function Q(e,t){return new z(e,t)}function Fn(e){for(var t=e.s;t!==void 0;t=t.n)if(t.S.i!==t.i||!t.S.h()||t.S.i!==t.i)return!0;return!1}function Tn(e){for(var t=e.s;t!==void 0;t=t.n){var n=t.S.n;if(n!==void 0&&(t.r=n),t.S.n=t,t.i=-1,t.n===void 0){e.s=t;break}}}function Mn(e){for(var t=e.s,n=void 0;t!==void 0;){var r=t.p;t.i===-1?(t.S.U(t),r!==void 0&&(r.n=t.n),t.n!==void 0&&(t.n.p=r)):n=t,t.S.n=t.r,t.r!==void 0&&(t.r=void 0),t=r}e.s=n}function me(e,t){z.call(this,void 0),this.x=e,this.s=void 0,this.g=Ge-1,this.f=4,this.W=t?.watched,this.Z=t?.unwatched}me.prototype=new z;me.prototype.h=function(){if(this.f&=-3,1&this.f)return!1;if((36&this.f)==32||(this.f&=-5,this.g===Ge))return!0;if(this.g=Ge,this.f|=1,this.i>0&&!Fn(this))return this.f&=-2,!0;var e=T;try{Tn(this),T=this;var t=this.x();(16&this.f||this.v!==t||this.i===0)&&(this.v=t,this.f&=-17,this.i++)}catch(n){this.v=n,this.f|=16,this.i++}return T=e,Mn(this),this.f&=-2,!0};me.prototype.S=function(e){if(this.t===void 0){this.f|=36;for(var t=this.s;t!==void 0;t=t.n)t.S.S(t)}z.prototype.S.call(this,e)};me.prototype.U=function(e){if(this.t!==void 0&&(z.prototype.U.call(this,e),this.t===void 0)){this.f&=-33;for(var t=this.s;t!==void 0;t=t.n)t.S.U(t)}};me.prototype.N=function(){if(!(2&this.f)){this.f|=6;for(var e=this.t;e!==void 0;e=e.x)e.t.N()}};Object.defineProperty(me.prototype,"value",{get:function(){if(1&this.f)throw new Error("Cycle detected");var e=In(this);if(this.h(),e!==void 0&&(e.i=this.i),16&this.f)throw this.v;return this.v}});function ue(e,t){return new me(e,t)}function jn(e){var t=e.u;if(e.u=void 0,typeof t=="function"){_e++;var n=T;T=void 0;try{t()}catch(r){throw e.f&=-2,e.f|=8,kt(e),r}finally{T=n,Ot()}}}function kt(e){for(var t=e.s;t!==void 0;t=t.n)t.S.U(t);e.x=void 0,e.s=void 0,jn(e)}function Nr(e){if(T!==this)throw new Error("Out-of-order effect");Mn(this),T=e,this.f&=-2,8&this.f&&kt(this),Ot()}function Se(e){this.x=e,this.u=void 0,this.s=void 0,this.o=void 0,this.f=32}Se.prototype.c=function(){var e=this.S();try{if(8&this.f||this.x===void 0)return;var t=this.x();typeof t=="function"&&(this.u=t)}finally{e()}};Se.prototype.S=function(){if(1&this.f)throw new Error("Cycle detected");this.f|=1,this.f&=-9,jn(this),Tn(this),_e++;var e=T;return T=this,Nr.bind(this,e)};Se.prototype.N=function(){2&this.f||(this.f|=2,this.o=De,De=this)};Se.prototype.d=function(){this.f|=8,1&this.f||kt(this)};Se.prototype.dispose=function(){this.d()};function Dt(e){var t=new Se(e);try{t.c()}catch(r){throw t.d(),r}var n=t.d.bind(t);return n[Symbol.dispose]=n,n}var Qe,it;function Ce(e,t){$[e]=t.bind(null,$[e]||function(){})}function Ye(e){it&&it(),it=e&&e.S()}function Pn(e){var t=this,n=e.data,r=R(n);r.value=n;var l=K(function(){for(var s=t.__v;s=s.__;)if(s.__c){s.__c.__$f|=4;break}return t.__$u.c=function(){var i,o=t.__$u.S(),d=l.value;o(),fn(d)||((i=t.base)==null?void 0:i.nodeType)!==3?(t.__$f|=1,t.setState({})):t.base.data=d},ue(function(){var i=r.value.value;return i===0?0:i===!0?"":i||""})},[]);return l.value}Pn.displayName="_st";Object.defineProperties(z.prototype,{constructor:{configurable:!0,value:void 0},type:{configurable:!0,value:Pn},props:{configurable:!0,get:function(){return{data:this}}},__b:{configurable:!0,value:1}});Ce("__b",function(e,t){if(typeof t.type=="string"){var n,r=t.props;for(var l in r)if(l!=="children"){var s=r[l];s instanceof z&&(n||(t.__np=n={}),n[l]=s,r[l]=s.peek())}}e(t)});Ce("__r",function(e,t){Ye();var n,r=t.__c;r&&(r.__$f&=-2,(n=r.__$u)===void 0&&(r.__$u=n=function(l){var s;return Dt(function(){s=this}),s.c=function(){r.__$f|=1,r.setState({})},s}())),Qe=r,Ye(n),e(t)});Ce("__e",function(e,t,n,r){Ye(),Qe=void 0,e(t,n,r)});Ce("diffed",function(e,t){Ye(),Qe=void 0;var n;if(typeof t.type=="string"&&(n=t.__e)){var r=t.__np,l=t.props;if(r){var s=n.U;if(s)for(var i in s){var o=s[i];o!==void 0&&!(i in r)&&(o.d(),s[i]=void 0)}else n.U=s={};for(var d in r){var c=s[d],f=r[d];c===void 0?(c=wr(n,d,f,l),s[d]=c):c.o(f,l)}}}e(t)});function wr(e,t,n,r){var l=t in e&&e.ownerSVGElement===void 0,s=Q(n);return{o:function(i,o){s.value=i,r=o},d:Dt(function(){var i=s.value.value;r[t]!==i&&(r[t]=i,l?e[t]=i:i?e.setAttribute(t,i):e.removeAttribute(t))})}}Ce("unmount",function(e,t){if(typeof t.type=="string"){var n=t.__e;if(n){var r=n.U;if(r){n.U=void 0;for(var l in r){var s=r[l];s&&s.d()}}}}else{var i=t.__c;if(i){var o=i.__$u;o&&(i.__$u=void 0,o.d())}}e(t)});Ce("__h",function(e,t,n,r){(r<3||r===9)&&(t.__$f|=2),e(t,n,r)});ee.prototype.shouldComponentUpdate=function(e,t){var n=this.__$u,r=n&&n.s!==void 0;for(var l in t)return!0;if(this.__f||typeof this.u=="boolean"&&this.u===!0){if(!(r||2&this.__$f||4&this.__$f)||1&this.__$f)return!0}else if(!(r||4&this.__$f)||3&this.__$f)return!0;for(var s in e)if(s!=="__source"&&e[s]!==this.props[s])return!0;for(var i in this.props)if(!(i in e))return!0;return!1};function R(e){return K(function(){return Q(e)},[])}function L(e){var t=J(e);return t.current=e,Qe.__$f|=4,K(function(){return ue(function(){return t.current()})},[])}const Sr=e=>{try{return[JSON.parse(e),null]}catch(t){return[null,t instanceof Error?t.message:"Parse error"]}},Xe=e=>{const t=new Set,n=l=>{l&&typeof l=="string"&&t.add(l)},r=l=>{for(const s of l||[]){s.id&&n(s.id);for(const i of s.items||[])i.id&&n(i.id),i.legendDescription&&n(i.legendDescription)}};return r(e.weatherFeatures),r(e.features),t},Et=e=>{const t=new Set,n=r=>{for(const l of r||[])for(const s of l.items||[])for(const i of s.layersIds||[])t.add(i)};return n(e.weatherFeatures),n(e.features),t},Cr=(e,t)=>{const n=[],r=(l,s)=>{l.forEach((i,o)=>{(i.items||[]).forEach((d,c)=>{(d.layersIds||[]).includes(t)&&n.push({featureType:s,featureIndex:o,featureName:i.name||i.id||`${s} ${o+1}`,itemIndex:c,itemName:d.name||d.id||`Item ${c+1}`})})})};return r(e.weatherFeatures,"weatherFeatures"),r(e.features,"features"),n},$r=(e,t,n="application/json")=>{const r=new Blob([t],{type:n}),l=URL.createObjectURL(r),s=document.createElement("a");s.href=l,s.download=e,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(l)},Lr=()=>({weatherFeatures:[],features:[],layers:[],intl:{en:{},da:{},nb:{},sv:{}}}),An="hemswx-map-editor-settings",Or={customLogicLayers:new Set},kr=()=>{try{const e=localStorage.getItem(An);if(e){const t=JSON.parse(e);return{customLogicLayers:new Set(t.customLogicLayers||[])}}}catch(e){console.warn("Failed to load settings:",e)}return Or},Un=e=>{try{const t={customLogicLayers:Array.from(e.customLogicLayers)};localStorage.setItem(An,JSON.stringify(t))}catch(t){console.warn("Failed to save settings:",t)}},ne=Q(kr());ue(()=>ne.value.customLogicLayers);const Dr=e=>{const t=new Set(ne.value.customLogicLayers);t.add(e);const n={...ne.value,customLogicLayers:t};ne.value=n,Un(n)},Er=e=>{const t=new Set(ne.value.customLogicLayers);t.delete(e);const n={...ne.value,customLogicLayers:t};ne.value=n,Un(n)},Ne=e=>ne.value.customLogicLayers.has(e),Ir=e=>{Ne(e)?Er(e):Dr(e)},Fr=e=>{const[t,n]=Sr(e);if(n)return{valid:!1,errors:[`JSON Parse Error: ${n}`],warnings:[]};const r=[],l=[];if(!t||typeof t!="object")return r.push("Root must be an object"),{valid:!1,errors:r,warnings:l};const s=["weatherFeatures","features","layers"];for(const i of s)Array.isArray(t[i])||r.push(`Missing or invalid '${i}' array`);if(!t.intl||typeof t.intl!="object")r.push("Missing or invalid 'intl' object");else{const i=["en","da","nb","sv"];for(const o of i)(!t.intl[o]||typeof t.intl[o]!="object")&&l.push(`Missing or invalid '${o}' translations`)}try{const i=Et(t),o=new Set((t.layers||[]).map(c=>c.id).filter(Boolean)),d=[...i].filter(c=>!o.has(c));d.length>0&&l.push(`Missing layer definitions: ${d.join(", ")}`)}catch{l.push("Could not validate layer references")}return{valid:r.length===0,errors:r,warnings:l}},Jn=e=>{try{const t=Et(e),n=new Set((e.layers||[]).map(f=>f.id)),r=ne.value.customLogicLayers,l=new Set([...t,...r]),s=[...t].filter(f=>!n.has(f)),i=[...n].filter(f=>!l.has(f)),o=Xe(e),d=Object.keys(e.intl||{}),c={};for(const f of d){const u=e.intl[f]||{};c[f]=[...o].filter(m=>!(m in u))}return{missingLayers:s,unusedLayers:i,missingIntl:c,weatherFeatureCount:e.weatherFeatures?.length||0,featureCount:e.features?.length||0,layerCount:e.layers?.length||0,languageCount:d.length}}catch(t){return console.warn("Error computing stats:",t),{missingLayers:[],unusedLayers:[],missingIntl:{},weatherFeatureCount:0,featureCount:0,layerCount:0,languageCount:0}}},Tr=e=>{const t=Jn(e);return`WF: ${t.weatherFeatureCount} • F: ${t.featureCount} • Layers: ${t.layerCount} • Langs: ${t.languageCount}`},F=["en","da","nb","sv"],Mr=(e,t)=>{const n={...e};n.intl||(n.intl={en:{},da:{},nb:{},sv:{}});const r=[];return t.id?.trim()&&r.push({key:t.id,defaultValue:t.name?.trim()||t.id}),(t.items||[]).forEach(l=>{l.id?.trim()&&r.push({key:l.id,defaultValue:l.name?.trim()||l.id}),l.legendDescription?.trim()&&r.push({key:l.legendDescription,defaultValue:l.legendDescription})}),F.forEach(l=>{n.intl[l]||(n.intl[l]={}),r.forEach(({key:s,defaultValue:i})=>{n.intl[l][s]||(l==="en"?n.intl[l][s]=i:n.intl[l][s]=n.intl.en[s]||i)})}),n},jr=e=>{const t={...e},n=t.intl?.en||{},r={},l=(o,d)=>{!r[o]&&d&&(r[o]=d)},s=o=>{for(const d of o||[]){d.id&&d.name&&l(d.id,d.name);for(const c of d.items||[])c.id&&c.name&&l(c.id,c.name),c.legendDescription&&l(c.legendDescription,n[c.legendDescription]||c.legendDescription)}};s(t.weatherFeatures),s(t.features);const i=new Set([...Xe(t)]);return t.intl||(t.intl={en:{},da:{},nb:{},sv:{}}),F.forEach(o=>{const d=t.intl[o]||{},c={};i.forEach(f=>{d[f]?c[f]=d[f]:o==="en"&&r[f]?c[f]=r[f]:n[f]?c[f]=n[f]:c[f]=f}),t.intl[o]=c}),t},yt=["wms","tiled","mapImage","portalItem","vectorTiled","feature"],Pr=e=>{const t={type:e,opacity:1,zIndex:0};switch(e){case"wms":return{...t,source:"https://example.com/wms",options:{layerNames:["layer1"]}};case"tiled":return{...t,source:"https://example.com/tiles/{z}/{y}/{x}.png"};case"vectorTiled":return{...t,source:"https://example.com/vectortiles/{z}/{y}/{x}.pbf"};case"mapImage":return{...t,source:"https://example.com/arcgis/rest/services/MapServer"};case"feature":return{...t,source:"https://example.com/arcgis/rest/services/FeatureServer/0"};case"portalItem":return{...t,source:"portal-item-id",options:{layerId:0}};default:return t}},Ar=e=>{const t=[];if(yt.includes(e.type)||t.push(`Invalid layer type "${e.type}". Must be one of: ${yt.join(", ")}`),!e.source||e.source.trim()===""?t.push("Layer source is required and cannot be empty"):e.type==="portalItem"?(e.source.length<10||e.source.includes(" "))&&t.push("Portal item source should be a valid portal item ID (no spaces, at least 10 characters)"):e.type!=="portalItem"&&!e.source.startsWith("http")&&t.push(`${e.type.toUpperCase()} layers typically require a URL starting with http:// or https://`),e.type==="wms"){const n=e.options?.layerNames;(!n||!Array.isArray(n)||n.length===0)&&t.push("WMS layers require layerNames array in options (list of layer names to include)")}return e.opacity!==void 0&&(e.opacity<0||e.opacity>1)&&t.push("Opacity must be a number between 0.0 (transparent) and 1.0 (opaque)"),e.zIndex!==void 0&&!Number.isInteger(e.zIndex)&&t.push("Z-Index must be a whole number (determines layer stacking order)"),{valid:t.length===0,errors:t}},Ur=e=>{const t=[];return!e.id||e.id.trim()===""?t.push("Layer ID is required and cannot be empty"):/^[a-zA-Z0-9_-]+$/.test(e.id.trim())||t.push("Layer ID can only contain letters, numbers, hyphens, and underscores"),(!e.layers||e.layers.length===0)&&t.push("Layer must contain at least one sublayer"),e.layers.forEach((n,r)=>{const l=Ar(n);l.valid||t.push(...l.errors.map(s=>`Sublayer ${r+1}: ${s}`))}),{valid:t.length===0,errors:t}},Jr=(e,t)=>{const n={...e},r=n.layers.findIndex(l=>l.id===t.id);return r>=0?(n.layers=[...n.layers],n.layers[r]=t):n.layers=[...n.layers,t],n},O=Q(Lr()),$e=Q(!1),X=Q({type:null,index:-1}),le=Q({index:-1}),H=Q({}),ve=Q({weatherFeatures:{},features:{}}),de=Q("features"),Rn=Q("json");Q("en");const He=Q("Ready");ue(()=>JSON.stringify(O.value,null,2));const Rr=ue(()=>Jn(O.value)),Vr=ue(()=>Tr(O.value)),Wr=ue(()=>{const e=X.value;return e.type===null||e.index<0?null:O.value[e.type][e.index]||null}),Hr=ue(()=>{const e=le.value;return e.index<0?null:O.value.layers[e.index]||null}),W=e=>{O.value=e,$e.value=!0;try{localStorage.setItem("hemswx-last-json-data",JSON.stringify(e))}catch(r){console.warn("Failed to save JSON data to localStorage:",r)}const t=X.value;if(t.type&&t.index>=0){const r=e[t.type];t.index>=r.length&&(X.value={type:null,index:-1})}const n=le.value;n.index>=0&&n.index>=e.layers.length&&(le.value={index:-1})},zr=()=>{try{const e=localStorage.getItem("hemswx-last-json-data");if(e){const t=JSON.parse(e);return W(t),M("✅ Last session data loaded"),!0}}catch(e){console.warn("Failed to load JSON data from localStorage:",e),M("⚠️ Failed to load last session data")}return!1},M=e=>{He.value=e,setTimeout(()=>{He.value===e&&(He.value="Ready")},5e3)},Vn=(e,t)=>{X.value={type:e,index:t},Rn.value="feature"},ze=e=>{le.value={index:e},Rn.value="layer"},qr=e=>H.value[e],re=(e,t)=>{H.value={...H.value,[e]:t}},Je=e=>{const t={...H.value};delete t[e],H.value=t},Kr=(e,t)=>ve.value[e][t],ot=(e,t,n)=>{ve.value={...ve.value,[e]:{...ve.value[e],[t]:n}}},Kt=(e,t)=>{const n={...ve.value[e]};delete n[t],ve.value={...ve.value,[e]:n}},Wn=()=>{const e=jr(O.value);W(e),M("✅ Missing translations synchronized")},Br=(e,t)=>{const n={...O.value};n[e]=n[e].filter((l,s)=>s!==t),W(n);const r=X.value;r.type===e&&r.index===t?X.value={type:null,index:-1}:r.type===e&&r.index>t&&(X.value={...r,index:r.index-1}),M("✅ Feature deleted")},Gr=(e,t,n)=>{if(e===n)return;const r=JSON.parse(JSON.stringify(O.value)),[l]=r[e].splice(t,1);r[n].push(l),W(r);const s=r[n].length-1;X.value={type:n,index:s},M(`✅ Moved feature to ${n==="weatherFeatures"?"Weather":"General"}`)},qe=(e,t,n,r)=>{const l=[...O.value[e]],s=e===n?l:[...O.value[n]];if(t<0||t>=l.length||r<0||r>s.length)return;const[i]=l.splice(t,1),o=e===n&&t<r?r-1:r;s.splice(o,0,i);const d={...O.value,[e]:e===n?s:l,[n]:s};W(d),X.value={type:n,index:o},M("✅ Feature moved")},Hn=e=>{const t={...O.value};t.layers=t.layers.filter((r,l)=>l!==e),W(t);const n=le.value;n.index===e?le.value={index:-1}:n.index>e&&(le.value={index:n.index-1}),M("✅ Layer deleted")};function Yr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Bt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function Gt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Bt(Object(n),!0).forEach(function(r){Yr(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Bt(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Zr(e,t){if(e==null)return{};var n={},r=Object.keys(e),l,s;for(s=0;s<r.length;s++)l=r[s],!(t.indexOf(l)>=0)&&(n[l]=e[l]);return n}function Qr(e,t){if(e==null)return{};var n=Zr(e,t),r,l;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(l=0;l<s.length;l++)r=s[l],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Xr(e,t){return ea(e)||ta(e,t)||na(e,t)||ra()}function ea(e){if(Array.isArray(e))return e}function ta(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var n=[],r=!0,l=!1,s=void 0;try{for(var i=e[Symbol.iterator](),o;!(r=(o=i.next()).done)&&(n.push(o.value),!(t&&n.length===t));r=!0);}catch(d){l=!0,s=d}finally{try{!r&&i.return!=null&&i.return()}finally{if(l)throw s}}return n}}function na(e,t){if(e){if(typeof e=="string")return Yt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Yt(e,t)}}function Yt(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ra(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aa(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Zt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function Qt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Zt(Object(n),!0).forEach(function(r){aa(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Zt(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function la(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(r){return t.reduceRight(function(l,s){return s(l)},r)}}function Le(e){return function t(){for(var n=this,r=arguments.length,l=new Array(r),s=0;s<r;s++)l[s]=arguments[s];return l.length>=e.length?e.apply(this,l):function(){for(var i=arguments.length,o=new Array(i),d=0;d<i;d++)o[d]=arguments[d];return t.apply(n,[].concat(l,o))}}}function Ze(e){return{}.toString.call(e).includes("Object")}function sa(e){return!Object.keys(e).length}function Te(e){return typeof e=="function"}function ia(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function oa(e,t){return Ze(t)||oe("changeType"),Object.keys(t).some(function(n){return!ia(e,n)})&&oe("changeField"),t}function ca(e){Te(e)||oe("selectorType")}function ua(e){Te(e)||Ze(e)||oe("handlerType"),Ze(e)&&Object.values(e).some(function(t){return!Te(t)})&&oe("handlersType")}function da(e){e||oe("initialIsRequired"),Ze(e)||oe("initialType"),sa(e)&&oe("initialContent")}function fa(e,t){throw new Error(e[t]||e.default)}var va={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},oe=Le(fa)(va),Re={changes:oa,selector:ca,handler:ua,initial:da};function ha(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Re.initial(e),Re.handler(t);var n={current:e},r=Le(_a)(n,t),l=Le(pa)(n),s=Le(Re.changes)(e),i=Le(ma)(n);function o(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(f){return f};return Re.selector(c),c(n.current)}function d(c){la(r,l,s,i)(c)}return[o,d]}function ma(e,t){return Te(t)?t(e.current):t}function pa(e,t){return e.current=Qt(Qt({},e.current),t),t}function _a(e,t,n){return Te(t)?t(e.current):Object.keys(n).forEach(function(r){var l;return(l=t[r])===null||l===void 0?void 0:l.call(t,e.current[r])}),n}var ga={create:ha},ya={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.52.2/min/vs"}};function ba(e){return function t(){for(var n=this,r=arguments.length,l=new Array(r),s=0;s<r;s++)l[s]=arguments[s];return l.length>=e.length?e.apply(this,l):function(){for(var i=arguments.length,o=new Array(i),d=0;d<i;d++)o[d]=arguments[d];return t.apply(n,[].concat(l,o))}}}function xa(e){return{}.toString.call(e).includes("Object")}function Na(e){return e||Xt("configIsRequired"),xa(e)||Xt("configType"),e.urls?(wa(),{paths:{vs:e.urls.monacoBase}}):e}function wa(){console.warn(zn.deprecation)}function Sa(e,t){throw new Error(e[t]||e.default)}var zn={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},Xt=ba(Sa)(zn),Ca={config:Na},$a=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return function(l){return n.reduceRight(function(s,i){return i(s)},l)}};function qn(e,t){return Object.keys(t).forEach(function(n){t[n]instanceof Object&&e[n]&&Object.assign(t[n],qn(e[n],t[n]))}),Gt(Gt({},e),t)}var La={type:"cancelation",msg:"operation is manually canceled"};function ct(e){var t=!1,n=new Promise(function(r,l){e.then(function(s){return t?l(La):r(s)}),e.catch(l)});return n.cancel=function(){return t=!0},n}var Oa=ga.create({config:ya,isInitialized:!1,resolve:null,reject:null,monaco:null}),Kn=Xr(Oa,2),Ae=Kn[0],et=Kn[1];function ka(e){var t=Ca.config(e),n=t.monaco,r=Qr(t,["monaco"]);et(function(l){return{config:qn(l.config,r),monaco:n}})}function Da(){var e=Ae(function(t){var n=t.monaco,r=t.isInitialized,l=t.resolve;return{monaco:n,isInitialized:r,resolve:l}});if(!e.isInitialized){if(et({isInitialized:!0}),e.monaco)return e.resolve(e.monaco),ct(ut);if(window.monaco&&window.monaco.editor)return Bn(window.monaco),e.resolve(window.monaco),ct(ut);$a(Ea,Fa)(Ta)}return ct(ut)}function Ea(e){return document.body.appendChild(e)}function Ia(e){var t=document.createElement("script");return e&&(t.src=e),t}function Fa(e){var t=Ae(function(r){var l=r.config,s=r.reject;return{config:l,reject:s}}),n=Ia("".concat(t.config.paths.vs,"/loader.js"));return n.onload=function(){return e()},n.onerror=t.reject,n}function Ta(){var e=Ae(function(n){var r=n.config,l=n.resolve,s=n.reject;return{config:r,resolve:l,reject:s}}),t=window.require;t.config(e.config),t(["vs/editor/editor.main"],function(n){Bn(n),e.resolve(n)},function(n){e.reject(n)})}function Bn(e){Ae().monaco||et({monaco:e})}function Ma(){return Ae(function(e){var t=e.monaco;return t})}var ut=new Promise(function(e,t){return et({resolve:e,reject:t})}),Gn={config:ka,init:Da,__getMonacoInstance:Ma};function Yn(e,t){for(var n in t)e[n]=t[n];return e}function bt(e,t){for(var n in e)if(n!=="__source"&&!(n in t))return!0;for(var r in t)if(r!=="__source"&&e[r]!==t[r])return!0;return!1}function Zn(e,t){var n=t(),r=he({t:{__:n,u:t}}),l=r[0].t,s=r[1];return Pe(function(){l.__=n,l.u=t,dt(l)&&s({t:l})},[e,n,t]),Z(function(){return dt(l)&&s({t:l}),e(function(){dt(l)&&s({t:l})})},[e]),n}function dt(e){var t,n,r=e.u,l=e.__;try{var s=r();return!((t=l)===(n=s)&&(t!==0||1/t==1/n)||t!=t&&n!=n)}catch{return!0}}function Qn(e){e()}function Xn(e){return e}function er(){return[!1,Qn]}var tr=Pe;function xt(e,t){this.props=e,this.context=t}function tt(e,t){function n(l){var s=this.props.ref,i=s==l.ref;return!i&&s&&(s.call?s(null):s.current=null),t?!t(this.props,l)||!i:bt(this.props,l)}function r(l){return this.shouldComponentUpdate=n,se(e,l)}return r.displayName="Memo("+(e.displayName||e.name)+")",r.prototype.isReactComponent=!0,r.__f=!0,r}(xt.prototype=new ee).isPureReactComponent=!0,xt.prototype.shouldComponentUpdate=function(e,t){return bt(this.props,e)||bt(this.state,t)};var en=$.__b;$.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),en&&en(e)};var ja=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function Pa(e){function t(n){var r=Yn({},n);return delete r.ref,e(r,n.ref||null)}return t.$$typeof=ja,t.render=t,t.prototype.isReactComponent=t.__f=!0,t.displayName="ForwardRef("+(e.displayName||e.name)+")",t}var tn=function(e,t){return e==null?null:ae(ae(e).map(t))},Aa={map:tn,forEach:tn,count:function(e){return e?ae(e).length:0},only:function(e){var t=ae(e);if(t.length!==1)throw"Children.only";return t[0]},toArray:ae},Ua=$.__e;$.__e=function(e,t,n,r){if(e.then){for(var l,s=t;s=s.__;)if((l=s.__c)&&l.__c)return t.__e==null&&(t.__e=n.__e,t.__k=n.__k),l.__c(e,t)}Ua(e,t,n,r)};var nn=$.unmount;function nr(e,t,n){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach(function(r){typeof r.__c=="function"&&r.__c()}),e.__c.__H=null),(e=Yn({},e)).__c!=null&&(e.__c.__P===n&&(e.__c.__P=t),e.__c.__e=!0,e.__c=null),e.__k=e.__k&&e.__k.map(function(r){return nr(r,t,n)})),e}function rr(e,t,n){return e&&n&&(e.__v=null,e.__k=e.__k&&e.__k.map(function(r){return rr(r,t,n)}),e.__c&&e.__c.__P===t&&(e.__e&&n.appendChild(e.__e),e.__c.__e=!0,e.__c.__P=n)),e}function Ke(){this.__u=0,this.o=null,this.__b=null}function ar(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function Ja(e){var t,n,r;function l(s){if(t||(t=e()).then(function(i){n=i.default||i},function(i){r=i}),r)throw r;if(!n)throw t;return se(n,s)}return l.displayName="Lazy",l.__f=!0,l}function Oe(){this.i=null,this.l=null}$.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&32&e.__u&&(e.type=null),nn&&nn(e)},(Ke.prototype=new ee).__c=function(e,t){var n=t.__c,r=this;r.o==null&&(r.o=[]),r.o.push(n);var l=ar(r.__v),s=!1,i=function(){s||(s=!0,n.__R=null,l?l(o):o())};n.__R=i;var o=function(){if(!--r.__u){if(r.state.__a){var d=r.state.__a;r.__v.__k[0]=rr(d,d.__c.__P,d.__c.__O)}var c;for(r.setState({__a:r.__b=null});c=r.o.pop();)c.forceUpdate()}};r.__u++||32&t.__u||r.setState({__a:r.__b=r.__v.__k[0]}),e.then(i,i)},Ke.prototype.componentWillUnmount=function(){this.o=[]},Ke.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=nr(this.__b,n,r.__O=r.__P)}this.__b=null}var l=t.__a&&se(V,null,e.fallback);return l&&(l.__u&=-33),[se(V,null,t.__a?null:e.children),l]};var rn=function(e,t,n){if(++n[1]===n[0]&&e.l.delete(t),e.props.revealOrder&&(e.props.revealOrder[0]!=="t"||!e.l.size))for(n=e.i;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.i=n=n[2]}};function Ra(e){return this.getChildContext=function(){return e.context},e.children}function Va(e){var t=this,n=e.h;if(t.componentWillUnmount=function(){be(null,t.v),t.v=null,t.h=null},t.h&&t.h!==n&&t.componentWillUnmount(),!t.v){for(var r=t.__v;r!==null&&!r.__m&&r.__!==null;)r=r.__;t.h=n,t.v={nodeType:1,parentNode:n,childNodes:[],__k:{__m:r.__m},contains:function(){return!0},insertBefore:function(l,s){this.childNodes.push(l),t.h.insertBefore(l,s)},removeChild:function(l){this.childNodes.splice(this.childNodes.indexOf(l)>>>1,1),t.h.removeChild(l)}}}be(se(Ra,{context:t.context},e.__v),t.v)}function Wa(e,t){var n=se(Va,{__v:e,h:t});return n.containerInfo=t,n}(Oe.prototype=new ee).__a=function(e){var t=this,n=ar(t.__v),r=t.l.get(e);return r[0]++,function(l){var s=function(){t.props.revealOrder?(r.push(l),rn(t,e,r)):l()};n?n(s):s()}},Oe.prototype.render=function(e){this.i=null,this.l=new Map;var t=ae(e.children);e.revealOrder&&e.revealOrder[0]==="b"&&t.reverse();for(var n=t.length;n--;)this.l.set(t[n],this.i=[1,0,this.i]);return e.children},Oe.prototype.componentDidUpdate=Oe.prototype.componentDidMount=function(){var e=this;this.l.forEach(function(t,n){rn(e,n,t)})};var lr=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,Ha=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,za=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,qa=/[A-Z0-9]/g,Ka=typeof document<"u",Ba=function(e){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/:/fil|che|ra/).test(e)};function Ga(e,t,n){return t.__k==null&&(t.textContent=""),be(e,t),typeof n=="function"&&n(),e?e.__c:null}function Ya(e,t,n){return Sn(e,t),typeof n=="function"&&n(),e?e.__c:null}ee.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(e){Object.defineProperty(ee.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})});var an=$.event;function Za(){}function Qa(){return this.cancelBubble}function Xa(){return this.defaultPrevented}$.event=function(e){return an&&(e=an(e)),e.persist=Za,e.isPropagationStopped=Qa,e.isDefaultPrevented=Xa,e.nativeEvent=e};var It,el={enumerable:!1,configurable:!0,get:function(){return this.class}},ln=$.vnode;$.vnode=function(e){typeof e.type=="string"&&function(t){var n=t.props,r=t.type,l={},s=r.indexOf("-")===-1;for(var i in n){var o=n[i];if(!(i==="value"&&"defaultValue"in n&&o==null||Ka&&i==="children"&&r==="noscript"||i==="class"||i==="className")){var d=i.toLowerCase();i==="defaultValue"&&"value"in n&&n.value==null?i="value":i==="download"&&o===!0?o="":d==="translate"&&o==="no"?o=!1:d[0]==="o"&&d[1]==="n"?d==="ondoubleclick"?i="ondblclick":d!=="onchange"||r!=="input"&&r!=="textarea"||Ba(n.type)?d==="onfocus"?i="onfocusin":d==="onblur"?i="onfocusout":za.test(i)&&(i=d):d=i="oninput":s&&Ha.test(i)?i=i.replace(qa,"-$&").toLowerCase():o===null&&(o=void 0),d==="oninput"&&l[i=d]&&(i="oninputCapture"),l[i]=o}}r=="select"&&l.multiple&&Array.isArray(l.value)&&(l.value=ae(n.children).forEach(function(c){c.props.selected=l.value.indexOf(c.props.value)!=-1})),r=="select"&&l.defaultValue!=null&&(l.value=ae(n.children).forEach(function(c){c.props.selected=l.multiple?l.defaultValue.indexOf(c.props.value)!=-1:l.defaultValue==c.props.value})),n.class&&!n.className?(l.class=n.class,Object.defineProperty(l,"className",el)):(n.className&&!n.class||n.class&&n.className)&&(l.class=l.className=n.className),t.props=l}(e),e.$$typeof=lr,ln&&ln(e)};var sn=$.__r;$.__r=function(e){sn&&sn(e),It=e.__c};var on=$.diffed;$.diffed=function(e){on&&on(e);var t=e.props,n=e.__e;n!=null&&e.type==="textarea"&&"value"in t&&t.value!==n.value&&(n.value=t.value==null?"":t.value),It=null};var tl={ReactCurrentDispatcher:{current:{readContext:function(e){return It.__n[e.__c].props.value},useCallback:Fe,useContext:Ln,useDebugValue:On,useDeferredValue:Xn,useEffect:Z,useId:kn,useImperativeHandle:$n,useInsertionEffect:tr,useLayoutEffect:Pe,useMemo:K,useReducer:$t,useRef:J,useState:he,useSyncExternalStore:Zn,useTransition:er}}};function nl(e){return se.bind(null,e)}function nt(e){return!!e&&e.$$typeof===lr}function rl(e){return nt(e)&&e.type===V}function al(e){return!!e&&!!e.displayName&&(typeof e.displayName=="string"||e.displayName instanceof String)&&e.displayName.startsWith("Memo(")}function ll(e){return nt(e)?pr.apply(null,arguments):e}function sl(e){return!!e.__k&&(be(null,e),!0)}function il(e){return e&&(e.base||e.nodeType===1&&e)||null}var ol=function(e,t){return e(t)},cl=function(e,t){return e(t)},ul=V,dl=nt,ge={useState:he,useId:kn,useReducer:$t,useEffect:Z,useLayoutEffect:Pe,useInsertionEffect:tr,useTransition:er,useDeferredValue:Xn,useSyncExternalStore:Zn,startTransition:Qn,useRef:J,useImperativeHandle:$n,useMemo:K,useCallback:Fe,useContext:Ln,useDebugValue:On,version:"18.3.1",Children:Aa,render:Ga,hydrate:Ya,unmountComponentAtNode:sl,createPortal:Wa,createElement:se,createContext:_r,createFactory:nl,cloneElement:ll,createRef:dr,Fragment:V,isValidElement:nt,isElement:dl,isFragment:rl,isMemo:al,findDOMNode:il,Component:ee,PureComponent:xt,memo:tt,forwardRef:Pa,flushSync:cl,unstable_batchedUpdates:ol,StrictMode:ul,Suspense:Ke,SuspenseList:Oe,lazy:Ja,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:tl},fl={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},ft=fl,vl={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},hl=vl;function ml({children:e}){return ge.createElement("div",{style:hl.container},e)}var pl=ml,_l=pl;function gl({width:e,height:t,isEditorReady:n,loading:r,_ref:l,className:s,wrapperProps:i}){return ge.createElement("section",{style:{...ft.wrapper,width:e,height:t},...i},!n&&ge.createElement(_l,null,r),ge.createElement("div",{ref:l,style:{...ft.fullWidth,...!n&&ft.hide},className:s}))}var yl=gl,sr=tt(yl);function bl(e){Z(e,[])}var ir=bl;function xl(e,t,n=!0){let r=J(!0);Z(r.current||!n?()=>{r.current=!1}:e,t)}var Y=xl;function Ee(){}function pe(e,t,n,r){return Nl(e,r)||wl(e,t,n,r)}function Nl(e,t){return e.editor.getModel(or(e,t))}function wl(e,t,n,r){return e.editor.createModel(t,n,r?or(e,r):void 0)}function or(e,t){return e.Uri.parse(t)}function Sl({original:e,modified:t,language:n,originalLanguage:r,modifiedLanguage:l,originalModelPath:s,modifiedModelPath:i,keepCurrentOriginalModel:o=!1,keepCurrentModifiedModel:d=!1,theme:c="light",loading:f="Loading...",options:u={},height:m="100%",width:p="100%",className:S,wrapperProps:C={},beforeMount:I=Ee,onMount:D=Ee}){let[b,v]=he(!1),[_,y]=he(!0),N=J(null),h=J(null),w=J(null),g=J(D),x=J(I),k=J(!1);ir(()=>{let j=Gn.init();return j.then(q=>(h.current=q)&&y(!1)).catch(q=>q?.type!=="cancelation"&&console.error("Monaco initialization: error:",q)),()=>N.current?G():j.cancel()}),Y(()=>{if(N.current&&h.current){let j=N.current.getOriginalEditor(),q=pe(h.current,e||"",r||n||"text",s||"");q!==j.getModel()&&j.setModel(q)}},[s],b),Y(()=>{if(N.current&&h.current){let j=N.current.getModifiedEditor(),q=pe(h.current,t||"",l||n||"text",i||"");q!==j.getModel()&&j.setModel(q)}},[i],b),Y(()=>{let j=N.current.getModifiedEditor();j.getOption(h.current.editor.EditorOption.readOnly)?j.setValue(t||""):t!==j.getValue()&&(j.executeEdits("",[{range:j.getModel().getFullModelRange(),text:t||"",forceMoveMarkers:!0}]),j.pushUndoStop())},[t],b),Y(()=>{N.current?.getModel()?.original.setValue(e||"")},[e],b),Y(()=>{let{original:j,modified:q}=N.current.getModel();h.current.editor.setModelLanguage(j,r||n||"text"),h.current.editor.setModelLanguage(q,l||n||"text")},[n,r,l],b),Y(()=>{h.current?.editor.setTheme(c)},[c],b),Y(()=>{N.current?.updateOptions(u)},[u],b);let E=Fe(()=>{if(!h.current)return;x.current(h.current);let j=pe(h.current,e||"",r||n||"text",s||""),q=pe(h.current,t||"",l||n||"text",i||"");N.current?.setModel({original:j,modified:q})},[n,t,l,e,r,s,i]),P=Fe(()=>{!k.current&&w.current&&(N.current=h.current.editor.createDiffEditor(w.current,{automaticLayout:!0,...u}),E(),h.current?.editor.setTheme(c),v(!0),k.current=!0)},[u,c,E]);Z(()=>{b&&g.current(N.current,h.current)},[b]),Z(()=>{!_&&!b&&P()},[_,b,P]);function G(){let j=N.current?.getModel();o||j?.original?.dispose(),d||j?.modified?.dispose(),N.current?.dispose()}return ge.createElement(sr,{width:p,height:m,isEditorReady:b,loading:f,_ref:w,className:S,wrapperProps:C})}var Cl=Sl;tt(Cl);function $l(e){let t=J();return Z(()=>{t.current=e},[e]),t.current}var Ll=$l,Ve=new Map;function Ol({defaultValue:e,defaultLanguage:t,defaultPath:n,value:r,language:l,path:s,theme:i="light",line:o,loading:d="Loading...",options:c={},overrideServices:f={},saveViewState:u=!0,keepCurrentModel:m=!1,width:p="100%",height:S="100%",className:C,wrapperProps:I={},beforeMount:D=Ee,onMount:b=Ee,onChange:v,onValidate:_=Ee}){let[y,N]=he(!1),[h,w]=he(!0),g=J(null),x=J(null),k=J(null),E=J(b),P=J(D),G=J(),j=J(r),q=Ll(s),Tt=J(!1),rt=J(!1);ir(()=>{let B=Gn.init();return B.then(ie=>(g.current=ie)&&w(!1)).catch(ie=>ie?.type!=="cancelation"&&console.error("Monaco initialization: error:",ie)),()=>x.current?cr():B.cancel()}),Y(()=>{let B=pe(g.current,e||r||"",t||l||"",s||n||"");B!==x.current?.getModel()&&(u&&Ve.set(q,x.current?.saveViewState()),x.current?.setModel(B),u&&x.current?.restoreViewState(Ve.get(s)))},[s],y),Y(()=>{x.current?.updateOptions(c)},[c],y),Y(()=>{!x.current||r===void 0||(x.current.getOption(g.current.editor.EditorOption.readOnly)?x.current.setValue(r):r!==x.current.getValue()&&(rt.current=!0,x.current.executeEdits("",[{range:x.current.getModel().getFullModelRange(),text:r,forceMoveMarkers:!0}]),x.current.pushUndoStop(),rt.current=!1))},[r],y),Y(()=>{let B=x.current?.getModel();B&&l&&g.current?.editor.setModelLanguage(B,l)},[l],y),Y(()=>{o!==void 0&&x.current?.revealLine(o)},[o],y),Y(()=>{g.current?.editor.setTheme(i)},[i],y);let Mt=Fe(()=>{if(!(!k.current||!g.current)&&!Tt.current){P.current(g.current);let B=s||n,ie=pe(g.current,r||e||"",t||l||"",B||"");x.current=g.current?.editor.create(k.current,{model:ie,automaticLayout:!0,...c},f),u&&x.current.restoreViewState(Ve.get(B)),g.current.editor.setTheme(i),o!==void 0&&x.current.revealLine(o),N(!0),Tt.current=!0}},[e,t,n,r,l,s,c,f,u,i,o]);Z(()=>{y&&E.current(x.current,g.current)},[y]),Z(()=>{!h&&!y&&Mt()},[h,y,Mt]),j.current=r,Z(()=>{y&&v&&(G.current?.dispose(),G.current=x.current?.onDidChangeModelContent(B=>{rt.current||v(x.current.getValue(),B)}))},[y,v]),Z(()=>{if(y){let B=g.current.editor.onDidChangeMarkers(ie=>{let at=x.current.getModel()?.uri;if(at&&ie.find(lt=>lt.path===at.path)){let lt=g.current.editor.getModelMarkers({resource:at});_?.(lt)}});return()=>{B?.dispose()}}return()=>{}},[y,_]);function cr(){G.current?.dispose(),m?u&&Ve.set(s,x.current.saveViewState()):x.current.getModel()?.dispose(),x.current.dispose()}return ge.createElement(sr,{width:p,height:S,isEditorReady:y,loading:d,_ref:k,className:C,wrapperProps:I})}var kl=Ol,Dl=tt(kl),El=Dl;function Ft({title:e="JSON Editor",value:t,onChange:n,placeholder:r="{}",readOnly:l=!1,height:s="400px"}){const i=J(null),o=J(null),d=R(!0),c=R(""),f=R(!1),u=L(()=>typeof navigator<"u"&&navigator.platform.toUpperCase().indexOf("MAC")>=0),m=L(()=>u.value?"Cmd":"Ctrl"),p=L(()=>{try{return t==null?"":JSON.stringify(t,null,2)}catch{return""}}),S=(v,_)=>{i.current=v,o.current=_,_.languages.json.jsonDefaults.setDiagnosticsOptions({validate:!0,allowComments:!1,schemas:[],enableSchemaRequest:!1}),v.updateOptions({minimap:{enabled:!1},fontSize:12,tabSize:2,insertSpaces:!0,wordWrap:"on",lineNumbers:"on",folding:!0,bracketPairColorization:{enabled:!0},autoIndent:"full",formatOnPaste:!0,formatOnType:!0}),v.addCommand(_.KeyMod.CtrlCmd|_.KeyCode.KeyS,()=>{I()}),v.addCommand(_.KeyMod.CtrlCmd|_.KeyMod.Shift|_.KeyCode.KeyF,()=>{D()})},C=v=>{if(!(l||!v))try{const _=JSON.parse(v);d.value=!0,c.value="",n(_)}catch(_){d.value=!1,c.value=_ instanceof Error?_.message:"Invalid JSON"}},I=()=>{if(!i.current||l)return;const v=i.current.getValue();C(v)},D=async()=>{if(!(!i.current||!o.current||l)){f.value=!0;try{const v=i.current.getValue(),_=JSON.parse(v),y=JSON.stringify(_,null,2);i.current.setValue(y),n(_),d.value=!0,c.value=""}catch{await i.current.getAction("editor.action.formatDocument")?.run()}finally{f.value=!1}}};return a("div",{className:"flex flex-col h-full min-h-0",children:[a("div",{className:"flex flex-wrap gap-2 mb-3 items-center flex-shrink-0",children:[a("span",{className:"text-slate-500",children:e}),a("div",{className:"ml-auto flex gap-2",children:!l&&a(V,{children:[a("button",{className:"btn small",onClick:()=>{if(!i.current)return;const v=i.current.getValue();try{return JSON.parse(v),d.value=!0,c.value="",!0}catch(_){return d.value=!1,c.value=_ instanceof Error?_.message:"Invalid JSON",!1}},title:"Validate JSON",children:"Validate"}),a("button",{className:"btn small",onClick:D,disabled:f.value,title:`Format JSON (${m.value}+Shift+F)`,children:f.value?"Formatting...":"Format"})]})})]}),!d.value&&c.value&&a("div",{className:"bg-red-900/30 border border-red-500/50 rounded p-2 mb-2 flex-shrink-0",children:a("div",{className:"text-red-300 text-xs",children:[a("span",{className:"font-medium",children:"JSON Error:"})," ",c.value]})}),d.value&&!l&&a("div",{className:"bg-green-900/30 border border-green-500/50 rounded p-2 mb-2 flex-shrink-0",children:a("div",{className:"text-green-300 text-xs",children:["✓ Valid JSON - Press ",m.value,"+S to save changes"]})}),a("div",{className:"flex-1 min-h-0 border border-slate-600 rounded overflow-hidden",children:a(El,{height:s,language:"json",theme:"vs-dark",value:p.value||r,onChange:C,onMount:S,options:{readOnly:l,contextmenu:!0,automaticLayout:!0},loading:a("div",{className:"flex items-center justify-center h-full text-slate-400",children:"Loading JSON Editor..."})})}),a("div",{className:"text-xs text-slate-500 mt-2 flex-shrink-0",children:l?"Read-only JSON view":a(V,{children:[a("span",{className:"font-medium",children:"Shortcuts:"})," ",m.value,"+S to save • ",m.value,"+Shift+F to format • Auto-validation enabled"]})})]})}function Il({feature:e,type:t,index:n,rearrange:r}){const l=L(()=>X.value.type===t&&X.value.index===n),s=L(()=>t==="weatherFeatures"?(O.value.weatherFeatures||[]).length:(O.value.features||[]).length),i=R(!1),o=R(null),d=L(()=>{const b=[];e.id?.trim()&&b.push(e.id),(e.items||[]).forEach(w=>{w.id?.trim()&&b.push(w.id),w.legendDescription?.trim()&&b.push(w.legendDescription)});const v=[...new Set(b)];if(v.length===0)return{percentage:100,missingCount:0,totalKeys:0};let _=0,y=0;v.forEach(w=>{F.forEach(g=>{_++;const x=O.value.intl?.[g]?.[w];x&&x.trim()&&y++})});const N=_>0?Math.round(y/_*100):100,h=_-y;return{percentage:N,missingCount:h,totalKeys:v.length}}),c=()=>{Vn(t,n)},f=b=>{b.stopPropagation(),confirm("Are you sure you want to delete this feature?")&&Br(t,n)},u=b=>{b.stopPropagation(),!(n<=0)&&qe(t,n,t,n-1)},m=b=>{b.stopPropagation();const v=(t==="weatherFeatures"?O.value.weatherFeatures:O.value.features).length;n>=v-1||qe(t,n,t,n+1)},p=b=>{b.stopPropagation(),Gr(t,n,t==="weatherFeatures"?"features":"weatherFeatures")},S=(e.items||[]).length,C=e.presentation||"single",I=e.name||C==="single"&&e.items?.[0]?.name||e.id||"Unnamed Feature",D=e.mutuallyExclusive?" • Exclusive":"";return a("div",{className:`feature-list-item relative ${l.value?"selected":""} ${i.value?"ring-1 ring-blue-500":""}`,onClick:c,draggable:r,onDragStart:b=>{if(!r)return;const v=JSON.stringify({kind:"feature",type:t,index:n});b.dataTransfer.setData("application/x-feature",v),b.dataTransfer.setData("text/plain",v),b.dataTransfer.effectAllowed="move"},onDragOver:b=>{if(!r||!Array.from(b.dataTransfer?.types||[]).includes("application/x-feature"))return;b.preventDefault(),b.dataTransfer.dropEffect="move",i.value=!0;const _=b.currentTarget.getBoundingClientRect(),y=b.clientY<_.top+_.height/2;o.value=y?"before":"after"},onDragLeave:()=>{i.value=!1,o.value=null},onDrop:b=>{if(!r)return;b.preventDefault(),i.value=!1;const v=o.value;o.value=null;const _=b.dataTransfer.getData("application/x-feature")||b.dataTransfer.getData("text/plain");if(_)try{const y=JSON.parse(_);if(y.kind!=="feature")return;const N=v==="after"?n+1:n;qe(y.type,y.index,t,N)}catch{}},children:[i.value&&o.value==="before"&&a("div",{className:"absolute -top-[1px] left-0 right-0 h-0.5 bg-blue-500 rounded-full"}),a("div",{className:"feature-info",children:[a("div",{className:"feature-name",children:I}),a("div",{className:"feature-details",children:[S," item(s) • ",C,D]}),d.value.totalKeys>0&&a("div",{className:"flex items-center gap-1 mt-1",children:[a("span",{className:"text-xs text-slate-400",children:"i18n:"}),a("span",{className:`text-xs px-1.5 py-0.5 rounded-full ${d.value.percentage===100?"bg-green-600 text-white":d.value.percentage>50?"bg-yellow-600 text-white":"bg-red-600 text-white"}`,children:[d.value.percentage,"%"]}),d.value.missingCount>0&&a("span",{className:"text-xs text-orange-400",children:["(",d.value.missingCount," missing)"]})]})]}),a("div",{className:"feature-actions flex gap-1",children:[r&&a(V,{children:[a("button",{className:"btn small",onClick:u,disabled:n===0,title:"Move up",children:"↑"}),a("button",{className:"btn small",onClick:m,disabled:n>=s.value-1,title:"Move down",children:"↓"}),a("button",{className:"btn ghost small",onClick:p,title:t==="weatherFeatures"?"Move to General":"Move to Weather",children:t==="weatherFeatures"?"To General":"To Weather"})]}),a("button",{className:"btn danger small",onClick:f,children:"Delete"})]}),i.value&&o.value==="after"&&a("div",{className:"absolute -bottom-[1px] left-0 right-0 h-0.5 bg-blue-500 rounded-full"})]})}function cn({title:e,type:t,features:n,rearrange:r}){const l=R(!1);return a("details",{open:!0,className:`feature-category ${l.value?"ring-1 ring-blue-700 rounded":""}`,onDragOver:s=>{!r||!Array.from(s.dataTransfer?.types||[]).includes("application/x-feature")||(s.preventDefault(),l.value=!0)},onDragLeave:()=>{l.value=!1},onDrop:s=>{if(!r)return;s.preventDefault(),l.value=!1;const i=s.dataTransfer.getData("application/x-feature")||s.dataTransfer.getData("text/plain");if(i)try{const o=JSON.parse(i);if(o.kind!=="feature")return;const d=(t==="weatherFeatures"?O.value.weatherFeatures:O.value.features).length;qe(o.type,o.index,t,d)}catch{}},children:[a("summary",{className:"feature-category-header",children:e}),a("div",{className:"feature-category-content",children:n.length===0?a("div",{className:"p-3 text-slate-500 text-center",children:["No ",e.toLowerCase()," found"]}):n.map((s,i)=>a(Il,{feature:s,type:t,index:i,rearrange:r},i))})]})}function Fl(){const e=L(()=>O.value.weatherFeatures||[]),t=L(()=>O.value.features||[]),n=R(!1);return a("div",{className:"flex flex-col h-full",children:[a("div",{className:"flex items-center justify-between mb-2",children:[a("div",{className:"text-sm text-slate-400",children:"Features"}),a("button",{className:`btn tiny ${n.value?"success":"ghost"}`,onClick:()=>n.value=!n.value,title:"Toggle rearrange mode",children:n.value?"Done":"Rearrange"})]}),a("div",{className:"feature-browser flex-1 overflow-auto",children:[a(cn,{title:"Weather Features",type:"weatherFeatures",features:e.value,rearrange:n.value}),a(cn,{title:"General Features",type:"features",features:t.value,rearrange:n.value})]})]})}function Tl({layer:e,index:t,isUsed:n}){const r=L(()=>le.value.index===t),l=Ne(e.id),s=()=>{ze(t)},i=o=>{o.stopPropagation(),confirm(`Are you sure you want to delete layer "${e.id}"?`)&&Hn(t)};return a("div",{className:`feature-list-item ${r.value?"selected":""}`,onClick:s,children:[a("div",{className:"feature-info",children:[a("div",{className:"feature-name",children:e.id||"(no id)"}),a("div",{className:"feature-details",children:[a("span",{className:`pill ${n?"ok":"warn"}`,children:n?"used":"unused"}),l&&a("span",{className:"ml-2 text-xs bg-blue-600 text-white px-1.5 py-0.5 rounded",children:"referenced"}),a("span",{className:"ml-2 text-xs",children:[e.layers?.length||0," sublayer",(e.layers?.length||0)===1?"":"s"]})]})]}),a("div",{className:"feature-actions",children:a("button",{className:"btn danger small",onClick:i,children:"Delete"})})]})}function Ml(){const e=L(()=>O.value.layers||[]),t=L(()=>Et(O.value));return a("div",{className:"flex flex-col h-full",children:a("div",{className:"feature-browser flex-1 overflow-auto",children:a("div",{className:"feature-category",children:[a("div",{className:"feature-category-header",children:"Layers"}),a("div",{className:"feature-category-content",children:e.value.length===0?a("div",{className:"p-3 text-slate-500 text-center",children:"No layers found"}):e.value.map((n,r)=>a(Tl,{layer:n,index:r,isUsed:t.value.has(n.id)},n.id||r))})]})})})}const jl=[{id:"details",label:"Details"},{id:"json",label:"JSON"}];function Pl(){const e=L(()=>le.value.index),t=Hr,n=R("details"),r=L(()=>e.value>=0?e.value:null),l=L(()=>r.value===null?null:qr(r.value)||null),s=L(()=>!!H.value.new),i=L(()=>s.value||l.value!=null),o=L(()=>{const h=H.value.new;return h||(l.value?l.value:t.value||null)}),d=R([]),c=()=>{re("new",{id:"",layers:[]}),ze(-1),d.value=[]},f=()=>{e.value<0||!t.value||(re(e.value,{...t.value}),d.value=[])},u=()=>{const h=s.value,w=h?"new":r.value,g=h?H.value.new:H.value[w];if(!g)return;const x=Ur(g);if(!x.valid){d.value=x.errors,M(`❌ Layer validation failed: ${x.errors[0]}`);return}const k=Jr(O.value,g);W(k);const E=k.layers.findIndex(P=>P.id===g.id);E>=0&&ze(E),Je("new"),!h&&typeof w=="number"&&Je(w),d.value=[],M("✅ Layer saved successfully")},m=()=>{Je("new"),typeof r.value=="number"&&Je(r.value),d.value=[]},p=()=>{if(e.value<0||!t.value)return;const h=t.value.id||`Layer ${e.value+1}`;confirm(`Are you sure you want to delete layer "${h}"? This action cannot be undone.`)&&Hn(e.value)},S=()=>{if(e.value<0||!t.value)return;const h=t.value,w={id:`${h.id}_copy`,layers:JSON.parse(JSON.stringify(h.layers||[]))};re("new",w),ze(-1),d.value=[]},C=h=>{const w=s.value||r.value===null,g=w?"new":r.value,k={...w?H.value.new:H.value[g],...h};re(g,k)},I=(h,w)=>{const g=s.value||r.value===null,x=g?"new":r.value,k=g?H.value.new:H.value[x],E=[...k.layers||[]];E[h]={...E[h],...w},re(x,{...k,layers:E})},D=h=>{const w=s.value||r.value===null,g=w?"new":r.value,x=w?H.value.new:H.value[g],k=[...x.layers||[]];k.splice(h,1),re(g,{...x,layers:k})},b=(h="wms")=>{const w=s.value||r.value===null,g=w?"new":r.value,x=w?H.value.new:H.value[g],k={type:h,source:"",opacity:1,zIndex:0},E=[...x.layers||[],k];re(g,{...x,layers:E})},v=h=>{t.value&&r.value===e.value&&!l.value&&!s.value&&re(e.value,{...t.value});const g=s.value||r.value===null?"new":r.value;re(g,h)},_=L(()=>e.value>=0&&!!t.value),y=L(()=>t.value?.id?Cr(O.value,t.value.id):[]),N=L(()=>t.value?.id?Ne(t.value.id):!1);return a("div",{className:"flex flex-col h-full",children:[a("div",{className:"flex flex-wrap gap-2 mb-3 items-center flex-shrink-0",children:[a("div",{children:[a("span",{className:"text-slate-500",children:i.value?e.value>=0?"Edit Layer":"New Layer":"Layer Details"}),o.value&&a("div",{className:"text-xs text-slate-400 mt-0.5",children:[o.value.id,N.value&&!i.value&&a("span",{className:"ml-2 text-xs bg-blue-600 text-white px-2 py-0.5 rounded",children:"Referenced"})]})]}),a("div",{className:"ml-auto flex gap-2",children:[!i.value&&_.value&&a(V,{children:[a("button",{className:"btn small",onClick:f,children:"Edit"}),a("button",{className:"btn ghost small",onClick:S,children:"Duplicate"}),a("button",{className:"btn danger small",onClick:p,children:"Delete"})]}),a("button",{className:"btn primary small",onClick:c,children:"New Layer"}),i.value&&a(V,{children:[a("button",{className:"btn success small",onClick:u,children:"Save"}),a("button",{className:"btn ghost small",onClick:m,children:"Cancel"})]})]})]}),d.value.length>0&&a("div",{className:"mb-3 p-2 bg-red-500 text-white rounded text-xs",children:[a("strong",{children:"Validation Errors:"}),a("ul",{className:"mt-1 ml-4 p-0",children:d.value.map((h,w)=>a("li",{children:h},w))})]}),o.value?a(V,{children:[a("div",{className:"flex gap-1 mb-3 border-b border-slate-700 pb-2 flex-shrink-0",children:jl.map(h=>a("button",{className:`px-3 py-1.5 rounded-t-md text-xs transition-all duration-150 ${n.value===h.id?"bg-blue-500 text-white":"bg-slate-950 text-slate-500 border border-slate-700 hover:border-slate-600 hover:text-slate-200"}`,onClick:()=>n.value=h.id,children:h.label},h.id))}),a("div",{className:"flex-1 overflow-hidden",children:[n.value==="details"&&a("div",{className:"h-full overflow-auto",children:[a("div",{className:"layer-section",children:a("div",{className:"form-group",children:[a("label",{className:"form-label",children:"Layer ID"}),a("input",{type:"text",className:"form-input",value:o.value.id,onChange:h=>C({id:h.target.value}),placeholder:"unique_layer_id",disabled:!i.value})]})}),a("div",{className:"layer-section",children:[a("div",{className:"flex items-center justify-between mb-2",children:[a("label",{className:"form-label",children:"Sublayers"}),i.value&&a("button",{className:"btn small",onClick:()=>b("wms"),children:"+ Add Sublayer"})]}),o.value.layers.length===0&&a("div",{className:"text-slate-500 text-sm",children:"No sublayers. Add one to get started."}),a("div",{className:"space-y-2",children:o.value.layers.map((h,w)=>a("div",{className:"border border-slate-600 rounded p-3 bg-slate-900",draggable:i.value&&o.value.layers.length>1,onDragStart:g=>{i.value&&(g.dataTransfer.setData("text/plain",w.toString()),g.dataTransfer.effectAllowed="move")},onDragOver:g=>{i.value&&(g.preventDefault(),g.dataTransfer.dropEffect="move")},onDrop:g=>{if(!i.value)return;g.preventDefault();const x=parseInt(g.dataTransfer.getData("text/plain"));if(x!==w){const E=[...o.value.layers||[]],P=E[x];E.splice(x,1),E.splice(w,0,P),C({layers:E})}},style:{cursor:i.value&&o.value.layers.length>1?"grab":"default"},children:[a("div",{className:"mb-2",children:[a("div",{className:"flex items-center gap-2 mb-1",children:[i.value&&o.value.layers.length>1&&a("div",{className:"cursor-move text-slate-400 hover:text-slate-300 px-1 select-none",title:"Drag to reorder",children:"⋮⋮"}),a("span",{className:"text-xs text-slate-400 font-mono",children:["#",w+1]}),a("div",{className:"flex-1 text-sm font-medium",children:h.type.toUpperCase()}),i.value&&a("button",{className:"btn tiny danger",onClick:()=>D(w),children:"×"})]}),a("div",{className:"text-xs text-slate-400 break-all pl-6",children:h.source||"No source"})]}),i.value&&a("div",{className:"space-y-2 text-xs",children:[a("div",{className:"grid grid-cols-2 gap-2",children:[a("div",{children:[a("label",{className:"block text-slate-400 mb-1",children:"Type"}),a("select",{className:"w-full px-2 py-1 text-xs bg-slate-800 border border-slate-600 rounded",value:h.type,onChange:g=>{const x=g.target.value,E={...Pr(x).options||{},...h.options||{}};I(w,{type:x,source:h.source,options:E})},children:yt.map(g=>a("option",{value:g,children:g.toUpperCase()},g))})]}),a("div",{children:[a("label",{className:"block text-slate-400 mb-1",children:"Opacity"}),a("input",{type:"number",className:"w-full px-2 py-1 text-xs bg-slate-800 border border-slate-600 rounded",min:"0",max:"1",step:"0.1",value:h.opacity??1,onChange:g=>I(w,{opacity:parseFloat(g.target.value)})})]})]}),a("div",{className:"grid grid-cols-2 gap-2",children:[a("div",{children:[a("label",{className:"block text-slate-400 mb-1",children:"Z-Index"}),a("input",{type:"number",className:"w-full px-2 py-1 text-xs bg-slate-800 border border-slate-600 rounded",value:h.zIndex??0,onChange:g=>I(w,{zIndex:parseInt(g.target.value)})})]}),a("div",{children:[a("label",{className:"block text-slate-400 mb-1",children:"Source URL/ID"}),a("input",{type:"text",className:"w-full px-2 py-1 text-xs bg-slate-800 border border-slate-600 rounded",value:h.source||"",onChange:g=>I(w,{source:g.target.value}),placeholder:h.type==="portalItem"?"e.g. abc123def456":h.type==="wms"?"https://example.com/wms":h.type==="tiled"?"https://example.com/tiles/{z}/{y}/{x}.png":h.type==="vectorTiled"?"https://example.com/vectortiles/{z}/{y}/{x}.pbf":h.type==="feature"?"https://example.com/arcgis/rest/services/FeatureServer/0":"https://example.com/arcgis/rest/services/MapServer"}),a("div",{className:"text-[10px] text-slate-500 mt-1",children:[h.type==="portalItem"&&"ArcGIS Online portal item ID",h.type==="wms"&&"WMS service endpoint URL",h.type==="tiled"&&"Tile template URL with {z}/{y}/{x}",h.type==="vectorTiled"&&"Vector tile template URL with {z}/{y}/{x}",h.type==="mapImage"&&"ArcGIS REST MapServer endpoint",h.type==="feature"&&"ArcGIS REST FeatureServer endpoint"]})]})]}),h.type==="portalItem"&&a("div",{children:[a("label",{className:"block text-slate-400 mb-1",children:"Portal Layer ID"}),a("input",{type:"number",className:"w-full px-2 py-1 text-xs bg-slate-800 border border-slate-600 rounded",value:h.options?.layerId||0,onChange:g=>I(w,{options:{...h.options||{},layerId:parseInt(g.target.value)||0}}),placeholder:"0"})]}),h.type==="wms"&&a("div",{children:[a("label",{className:"block text-slate-400 mb-1",children:"WMS Layer Names"}),a("div",{className:"space-y-2",children:[(h.options?.layerNames||[]).map((g,x)=>a("div",{className:"flex gap-2",children:[a("input",{type:"text",className:"w-full px-2 py-1 text-xs bg-slate-800 border border-slate-600 rounded",value:g,onChange:k=>{const E=[...h.options?.layerNames||[]];E[x]=k.target.value,I(w,{options:{...h.options||{},layerNames:E}})},placeholder:`layer${x+1}`}),(h.options?.layerNames||[]).length>1&&a("button",{type:"button",className:"btn tiny danger",onClick:()=>{const k=[...h.options?.layerNames||[]];k.splice(x,1),I(w,{options:{...h.options||{},layerNames:k}})},children:"×"})]},x)),a("button",{type:"button",className:"btn tiny",onClick:()=>{const g=[...h.options?.layerNames||[],""];I(w,{options:{...h.options||{},layerNames:g}})},children:"+ Add Layer Name"})]})]})]})]},w))}),!i.value&&y.value.length>0&&a("div",{className:"form-group mt-3",children:[a("label",{className:"form-label",children:"Layer Usage"}),a("div",{className:"bg-slate-700 rounded p-3 text-sm",children:[a("div",{className:"text-slate-300 mb-2",children:["This layer is referenced by ",y.value.length," item(s):"]}),a("div",{className:"space-y-1 max-h-32 overflow-y-auto",children:y.value.map((h,w)=>a("div",{className:"text-slate-400 text-xs flex items-center gap-2",children:[a("span",{className:"bg-slate-600 px-2 py-0.5 rounded text-xs",children:h.featureType==="weatherFeatures"?"Weather":"Feature"}),a("span",{children:h.featureName}),a("span",{className:"text-slate-500",children:"→"}),a("span",{children:h.itemName})]},w))})]})]}),!i.value&&y.value.length===0&&t.value&&a("div",{className:"form-group mt-3",children:[a("label",{className:"form-label",children:"Layer Usage"}),a("div",{className:"bg-slate-700 rounded p-3 text-sm text-slate-400",children:["This layer is not currently referenced by any features or items.",a("br",{}),a("span",{className:"text-xs text-slate-500",children:"Consider deleting if no longer needed."})]})]})]})]}),n.value==="json"&&a("div",{className:"h-full min-h-0",children:a(Ft,{title:"Selected Layer JSON",value:o.value,onChange:v,readOnly:!i.value,height:"100%"},`${r.value??"new"}:${i.value?"edit":"view"}`)})]})]}):a("div",{className:"text-center p-5 text-slate-500 flex-1 flex items-center justify-center",children:a("div",{children:[a("p",{children:"Select a layer to view/edit or create a new one"}),a("button",{className:"btn primary",onClick:c,children:"New Layer"})]})})]})}function Al({feature:e,isEditing:t}){const n=L(()=>O.value),r=L(()=>{const f=[];return e.id?.trim()&&f.push(e.id),(e.items||[]).forEach(u=>{u.id?.trim()&&f.push(u.id),u.legendDescription?.trim()&&f.push(u.legendDescription)}),[...new Set(f)]}),l=L(()=>r.value.map(f=>{const u={};let m=0;return F.forEach(p=>{const S=n.value.intl?.[p]?.[f]||"";u[p]=S,S.trim()||m++}),{key:f,translations:u,missingCount:m,isComplete:m===0,completionPercentage:Math.round((F.length-m)/F.length*100)}})),s=L(()=>{if(l.value.length===0)return 100;const f=l.value.length*F.length,u=l.value.reduce((m,p)=>m+(F.length-p.missingCount),0);return Math.round(u/f*100)}),i=(f,u,m)=>{const p={...n.value,intl:{...n.value.intl}};p.intl[u]||(p.intl[u]={}),p.intl[u]={...p.intl[u],[f]:m},W(p)},o=f=>{const u=l.value.find(S=>S.key===f);if(!u)return;const m=u.translations.en;if(!m.trim())return;const p={...n.value,intl:{...n.value.intl}};F.forEach(S=>{S!=="en"&&!u.translations[S].trim()&&(p.intl[S]||(p.intl[S]={}),p.intl[S][f]=m)}),W(p)},d=f=>{if(!confirm(`Clear all translations for "${f}"?`))return;const u={...n.value,intl:{...n.value.intl}};F.forEach(m=>{u.intl[m]&&u.intl[m][f]&&delete u.intl[m][f]}),W(u)},c=f=>{if(f===e.id)return"Feature ID";const u=(e.items||[]).find(m=>m.id===f||m.legendDescription===f);if(u){if(u.id===f)return`Item ID (${u.name||"Unnamed"})`;if(u.legendDescription===f)return`Legend Description (${u.name||u.id||"Unnamed"})`}return"Unknown"};return r.value.length===0?a("div",{className:"h-full flex items-center justify-center",children:a("div",{className:"text-center text-slate-500",children:[a("div",{className:"text-4xl mb-3",children:"🌐"}),a("div",{className:"text-sm font-medium mb-1",children:"No Translation Keys"}),a("div",{className:"text-xs",children:"Add feature and item IDs to enable translations"})]})}):a("div",{className:"h-full flex flex-col",children:[a("div",{className:"mb-4 pb-3 border-b border-slate-700",children:[a("div",{className:"flex items-center justify-between mb-2",children:[a("h3",{className:"text-lg font-medium text-slate-200",children:"Translations"}),a("div",{className:"flex items-center gap-2",children:[a("span",{className:"text-xs text-slate-400",children:[r.value.length," key",r.value.length!==1?"s":""]}),a("div",{className:`pill ${s.value===100?"ok":s.value>50?"warn":"error"}`,children:[s.value,"% complete"]})]})]}),a("div",{className:"text-xs text-slate-500",children:"Manage translations for all feature and item IDs. Missing translations will fall back to English or the ID itself."})]}),a("div",{className:"flex-1 overflow-y-auto space-y-4",children:l.value.map(f=>a("div",{className:"border border-slate-600 rounded-lg p-4 bg-slate-900/50",children:[a("div",{className:"flex items-start justify-between mb-3",children:[a("div",{className:"flex-1 min-w-0",children:[a("div",{className:"flex items-center gap-2 mb-1",children:[a("code",{className:"text-sm text-slate-300 font-mono",children:f.key}),a("span",{className:"text-xs text-slate-500",children:["(",c(f.key),")"]})]}),a("div",{className:"flex items-center gap-2",children:[a("div",{className:`pill tiny ${f.isComplete?"ok":f.completionPercentage>50?"warn":"error"}`,children:[f.completionPercentage,"%"]}),f.missingCount>0&&a("span",{className:"text-xs text-orange-400",children:[f.missingCount," missing"]})]})]}),a("div",{className:"flex gap-1",children:[f.missingCount>0&&f.translations.en.trim()&&a("button",{className:"btn tiny",onClick:()=>o(f.key),disabled:!t,title:"Fill missing translations with English text",children:"Fill EN"}),a("button",{className:"btn danger tiny",onClick:()=>d(f.key),disabled:!t,title:"Clear all translations for this key",children:"Clear"})]})]}),a("div",{className:"grid gap-3",children:F.map(u=>a("div",{className:"grid grid-cols-4 gap-2 items-start",children:[a("div",{className:"flex items-center gap-2",children:[a("span",{className:"font-mono text-xs bg-slate-700 px-2 py-1 rounded text-center min-w-[2.5rem]",children:u.toUpperCase()}),u==="en"&&a("span",{className:"text-slate-500 text-xs",children:"Default"}),!f.translations[u].trim()&&a("span",{className:"text-orange-400 text-xs",children:"•"})]}),a("div",{className:"col-span-3",children:a("textarea",{className:"form-textarea text-xs",rows:2,value:f.translations[u],onInput:m=>i(f.key,u,m.target.value),placeholder:u==="en"?`Enter ${u.toUpperCase()} text`:`Translate to ${u.toUpperCase()}`,disabled:!t})})]},u))})]},f.key))}),a("div",{className:"mt-4 pt-3 border-t border-slate-700",children:a("div",{className:"text-xs text-slate-500",children:[a("div",{className:"mb-1",children:[a("strong",{children:"Translation Coverage:"})," ",F.length*r.value.length-l.value.reduce((f,u)=>f+u.missingCount,0),"/",F.length*r.value.length," entries complete"]}),!t&&a("div",{className:"text-slate-400",children:a("em",{children:"Enable editing mode to modify translations"})})]})})]})}function Ul({isOpen:e,selectedLayerIds:t,onClose:n,onSave:r}){const l=R(t),s=R([]);JSON.stringify(s.value)!==JSON.stringify(t)&&(l.value=[...t],s.value=[...t]);const i=L(()=>O.value.layers||[]),o=L(()=>{const m=new Set;return[...O.value.weatherFeatures||[],...O.value.features||[]].forEach(p=>{(p.items||[]).forEach(S=>{(S.layersIds||[]).forEach(C=>{t.includes(C)||m.add(C)})})}),m}),d=L(()=>i.value.map(p=>({id:p.id,title:p.id||"Unnamed Layer",isAssigned:o.value.has(p.id)})).sort((p,S)=>p.isAssigned!==S.isAssigned?p.isAssigned?1:-1:p.title.localeCompare(S.title))),c=m=>{const p=l.value||[];l.value=p.includes(m)?p.filter(S=>S!==m):[...p,m]},f=()=>{r(l.value),n()},u=()=>{l.value=t,n()};return e?a("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:u,children:a("div",{className:"bg-slate-800 border border-slate-600 rounded-lg w-96 max-h-[80vh] flex flex-col",onClick:m=>m.stopPropagation(),children:[a("div",{className:"p-4 border-b border-slate-700",children:[a("h3",{className:"text-lg font-medium text-white",children:"Select Layers"}),a("p",{className:"text-sm text-slate-400 mt-1",children:["Choose one or more layers for this item (",l.value.length," selected)"]})]}),a("div",{className:"flex-1 overflow-y-auto p-2 max-h-96",children:d.value.length===0?a("div",{className:"p-4 text-center text-slate-500",children:"No layers available"}):a("div",{className:"space-y-1",children:d.value.map(m=>{const p=l.value.includes(m.id);return a("label",{className:"flex items-center gap-3 p-2 hover:bg-slate-700 rounded cursor-pointer",children:[a("input",{type:"checkbox",className:"form-checkbox",checked:p,onChange:()=>c(m.id)}),a("div",{className:"flex-1",children:[a("div",{className:`text-sm ${m.isAssigned?"text-slate-200":"text-green-300 font-medium"} flex items-center gap-2`,children:[m.title,Ne(m.id)&&a("span",{className:"text-xs bg-blue-600 text-white px-1.5 py-0.5 rounded",children:"referenced"})]}),a("div",{className:"text-xs text-slate-500",children:["ID: ",m.id,!m.isAssigned&&a("span",{className:"ml-2 text-green-400",children:"• Available"}),m.isAssigned&&a("span",{className:"ml-2 text-orange-400",children:"• In use"})]})]})]},m.id)})})}),a("div",{className:"p-4 border-t border-slate-700 flex gap-2 justify-end",children:[a("button",{className:"btn ghost small",onClick:u,children:"Cancel"}),a("button",{className:"btn success small",onClick:f,children:["Save Selection (",l.value.length,")"]})]})]})}):null}function Jl({selectedLayerIds:e,onChange:t}){const n=R(!1),r=e.length,l=O.value.layers||[],s=e.map(o=>l.find(c=>c.id===o)?.id||o).slice(0,2),i=r===0?"No layers selected":r<=2?s.join(", "):`${s.join(", ")} +${r-2} more`;return a(V,{children:[a("button",{type:"button",className:"w-full px-2 py-1 text-xs bg-slate-800 border border-slate-600 rounded text-left hover:border-slate-500 focus:border-blue-500 transition-colors",onClick:()=>n.value=!0,children:a("div",{className:"flex items-center justify-between",children:[a("span",{className:r>0?"text-slate-200":"text-slate-500",children:i}),a("span",{className:"text-slate-400 text-xs",children:[r>0&&a("span",{className:"bg-blue-600 text-white px-1.5 py-0.5 rounded-full mr-1",children:r}),"Click to select..."]})]})}),a(Ul,{isOpen:n.value,selectedLayerIds:e,onClose:()=>n.value=!1,onSave:t})]})}const Rl=[{id:"details",label:"Details"},{id:"intl",label:"i18n"},{id:"json",label:"JSON"}],Vl=e=>{if(!e)return"";const t=e.id||e.name;return t?.trim()?t:(e.items||[])[0]?.id||""},Wl=e=>{if(!e)return"";const t=e.name;if(t?.trim())return t;if(e.presentation==="single"){const n=(e.items||[])[0];if(n?.name?.trim())return n.name}return e.id||""},un=()=>({presentation:"single",items:[{id:"",name:"",showLegend:!1,layersIds:[]}]});function Hl(){const e=X,t=Wr,n=R("details"),r=R({active:!1,featureType:"weatherFeatures",draft:null}),l=L(()=>r.value.active?r.value.draft:!e.value.type||e.value.index<0?null:Kr(e.value.type,e.value.index)||null),s=L(()=>l.value!=null||r.value.active),i=L(()=>l.value?l.value:r.value.active?r.value.draft:t.value||null),o=L(()=>Wl(i.value)||"Unnamed Feature"),d=L(()=>Vl(i.value)||"No ID"),c=L(()=>i.value?.presentation==="single"&&(i.value.items||[]).length===1),f=L(()=>{const v=i.value;if(!v||v.presentation!=="single")return!1;const _=v.items||[];if(_.length!==1)return!1;const y=_[0],N=v.id?.trim(),h=v.name?.trim(),w=y?.id?.trim(),g=y?.name?.trim();return!N&&w||!h&&g}),u=L(()=>{if(!i.value)return{percentage:100,missingCount:0,totalKeys:0};const v=i.value,_=[];v.id?.trim()&&_.push(v.id),(v.items||[]).forEach(x=>{x.id?.trim()&&_.push(x.id),x.legendDescription?.trim()&&_.push(x.legendDescription)});const y=[...new Set(_)];if(y.length===0)return{percentage:100,missingCount:0,totalKeys:0};let N=0,h=0;y.forEach(x=>{F.forEach(k=>{N++;const E=O.value.intl?.[k]?.[x];E&&E.trim()&&h++})});const w=N>0?Math.round(h/N*100):100,g=N-h;return{percentage:w,missingCount:g,totalKeys:y.length}}),m=()=>{!e.value.type||e.value.index<0||!t.value||ot(e.value.type,e.value.index,{...t.value})},p=()=>{if(r.value.active)r.value={active:!1,featureType:"weatherFeatures",draft:null};else{if(!e.value.type||e.value.index<0)return;Kt(e.value.type,e.value.index)}},S=()=>{const v=l.value;if(!v)return;const _=r.value.active;if(!_&&(!e.value.type||e.value.index<0))return;if(!v.presentation||!Array.isArray(v.items)){M("❌ Feature is missing required fields");return}if(v.items.length===0){M("❌ Feature must have at least one item");return}if(v.name!==void 0&&v.name!==null&&!v.name.trim()){M("❌ Feature name cannot be empty string (leave blank to inherit from item)");return}if(v.id!==void 0&&v.id!==null&&!v.id.trim()){M("❌ Feature ID cannot be empty string (leave blank to inherit from item)");return}if(v.items.filter(P=>!P.id?.trim()||!P.name?.trim()).length>0){M("❌ All items must have both ID and Name");return}const N=v.items.map(P=>P.id.trim()),h=N.filter((P,G)=>N.indexOf(P)!==G);if(h.length>0){M(`❌ Duplicate item IDs found: ${[...new Set(h)].join(", ")}`);return}if(v.presentation==="multiple"){const P=v.items.filter(j=>!j.name?.trim()),G=v.name?.trim();if(P.length>0&&!G){M("❌ Multiple presentation features must have a feature name when items are missing names");return}}if(v.items.filter(P=>!P.layersIds||P.layersIds.length===0).length>0){M("❌ All items must have at least one layer assigned");return}const g=new Set((O.value.layers||[]).map(P=>P.id)),x=new Set;if(v.items.forEach(P=>{(P.layersIds||[]).forEach(G=>{g.has(G)||x.add(G)})}),x.size>0){M(`❌ Invalid layer IDs: ${Array.from(x).join(", ")}`);return}const k=Mr(O.value,v),E=JSON.parse(JSON.stringify(k));if(_){const P=r.value.featureType==="weatherFeatures"?E.weatherFeatures:E.features;P.push(JSON.parse(JSON.stringify(v)));const G=r.value.featureType,j=P.length-1;r.value={active:!1,featureType:"weatherFeatures",draft:null},setTimeout(()=>{Vn(G,j)},0),M("✅ Feature created successfully")}else e.value.type&&(E[e.value.type][e.value.index]=JSON.parse(JSON.stringify(v)),Kt(e.value.type,e.value.index)),M("✅ Feature saved successfully");W(E)},C=v=>{if(r.value.active){const _=r.value.draft||un();r.value={...r.value,draft:{..._,...v}}}else{if(!e.value.type||e.value.index<0)return;const _=l.value||t.value;ot(e.value.type,e.value.index,{..._,...v})}},I=v=>{if(r.value.active)r.value={...r.value,draft:v};else{if(!e.value.type||e.value.index<0)return;ot(e.value.type,e.value.index,v)}},D=()=>{const v=e.value.type==="features"?"features":"weatherFeatures";r.value={active:!0,featureType:v,draft:un()}},b=()=>{if(!e.value.type||e.value.index<0||!i.value)return;const v=i.value,_=e.value.type,y={...v,id:v.id?`${v.id}_copy`:"",name:v.name?`${v.name} (Copy)`:"",items:(v.items||[]).map(N=>({...N,id:N.id?`${N.id}_copy`:"",name:N.name?`${N.name} (Copy)`:"",layersIds:[...N.layersIds||[]]}))};r.value={active:!0,featureType:_,draft:y}};return a("div",{className:"flex flex-col h-full",children:[a("div",{className:"flex flex-wrap gap-2 mb-3 items-center flex-shrink-0",children:[a("div",{children:[a("span",{className:"text-slate-500",children:r.value.active?"Create New Feature":s.value?"Edit Feature":"Feature Details"}),i.value&&a("div",{className:"text-xs text-slate-400 mt-0.5",children:r.value.active?`New ${r.value.featureType==="weatherFeatures"?"Weather":"General"} Feature`:`${o.value} ${d.value!==o.value&&`(${d.value})`}`}),r.value.active&&a("div",{className:"flex items-center gap-2 mt-2",children:[a("label",{className:"text-xs text-slate-400",children:"Category"}),a("select",{className:"form-select text-xs py-1 px-2",value:r.value.featureType,onChange:v=>{const _=v.target.value;r.value={...r.value,featureType:_}},children:[a("option",{value:"weatherFeatures",children:"Weather"}),a("option",{value:"features",children:"General"})]})]})]}),a("div",{className:"ml-auto flex gap-2",children:[!s.value&&e.value.type&&e.value.index>=0&&a(V,{children:[a("button",{className:"btn small",onClick:D,children:"New Feature"}),a("button",{className:"btn small",onClick:b,children:"Clone Feature"}),a("button",{className:"btn small",onClick:m,children:"Edit"})]}),!s.value&&(!e.value.type||e.value.index<0)&&a("button",{className:"btn small",onClick:D,children:"New Feature"}),s.value&&a(V,{children:[a("button",{className:"btn success small",onClick:S,children:r.value.active?"Create Feature":"Save"}),a("button",{className:"btn ghost small",onClick:p,children:"Cancel"})]})]})]}),i.value?a(V,{children:[a("div",{className:"flex gap-1 mb-3 border-b border-slate-700 pb-2 flex-shrink-0",children:Rl.map(v=>a("button",{className:`px-3 py-1.5 rounded-t-md text-xs transition-all duration-150 flex items-center gap-2 ${n.value===v.id?"bg-blue-500 text-white":"bg-slate-950 text-slate-500 border border-slate-700 hover:border-slate-600 hover:text-slate-200"}`,onClick:()=>n.value=v.id,children:[a("span",{children:v.label}),v.id==="intl"&&u.value.totalKeys>0&&a("span",{className:`text-xs px-1.5 py-0.5 rounded-full ${u.value.percentage===100?"bg-green-600 text-white":u.value.percentage>50?"bg-yellow-600 text-white":"bg-red-600 text-white"}`,children:[u.value.percentage,"%"]})]},v.id))}),a("div",{className:"flex-1 overflow-hidden",children:[n.value==="details"&&a("div",{className:"h-full overflow-auto",children:[f.value&&s.value&&a("div",{className:"bg-blue-900/30 border border-blue-500/50 rounded p-3 mb-4",children:a("div",{className:"flex items-start gap-2",children:[a("div",{className:"text-blue-400 text-sm",children:"💡"}),a("div",{className:"flex-1",children:[a("div",{className:"text-blue-300 text-sm font-medium mb-1",children:"Single Item Feature Detected"}),a("div",{className:"text-blue-200 text-xs mb-2",children:"For single-item features, you can leave Feature ID and Name empty to inherit from the item."}),a("button",{className:"btn tiny",onClick:()=>{C({id:"",name:""})},children:"Clear Feature Fields"})]})]})}),a("div",{className:"layer-section",children:[a("div",{className:"form-group",children:[a("label",{className:"form-label",children:"Feature ID"}),a("input",{type:"text",className:"form-input",value:i.value.id||"",onChange:v=>C({id:v.target.value}),placeholder:i.value.presentation==="single"?"Leave empty to use first item ID":"e.g. icing_index, radar, wind_60min",disabled:!s.value}),a("div",{className:"text-xs text-slate-500 mt-1",children:i.value.presentation==="single"?"Optional - will inherit from first item if empty":"Optional unique identifier for this feature group"})]}),a("div",{className:"form-group",children:[a("label",{className:"form-label",children:"Feature Name"}),a("input",{type:"text",className:"form-input",value:i.value.name||"",onChange:v=>C({name:v.target.value}),placeholder:i.value.presentation==="single"?"Leave empty to use first item name":"e.g. Weather Layers, Navigation Features",disabled:!s.value}),a("div",{className:"text-xs text-slate-500 mt-1",children:i.value.presentation==="single"?"Optional - will inherit from first item if empty":"Optional display name for this feature group"})]}),a("div",{className:"form-group",children:[a("label",{className:"form-label",children:"Presentation"}),a("select",{className:"form-select",value:i.value.presentation,onChange:v=>C({presentation:v.target.value}),disabled:!s.value,children:[a("option",{value:"single",children:"Single"}),a("option",{value:"multiple",children:"Multiple"})]}),a("div",{className:"text-xs text-slate-500 mt-1",children:i.value.presentation==="single"?a(V,{children:[a("span",{className:"font-medium text-blue-300",children:"Single:"})," Only one item can be selected.",c.value&&a("span",{className:"text-blue-300",children:" Feature can inherit from item."})]}):a(V,{children:[a("span",{className:"font-medium text-green-300",children:"Multiple:"})," Multiple items can be selected. Feature should have its own name."]})})]}),i.value.presentation==="multiple"&&a("div",{className:"form-group",children:[a("label",{className:"form-label",children:"Mutually Exclusive"}),a("div",{children:[a("input",{type:"checkbox",className:"form-checkbox",checked:!!i.value.mutuallyExclusive,onChange:v=>C({mutuallyExclusive:v.target.checked}),disabled:!s.value}),a("span",{className:"text-slate-200 text-sm",children:"Only one item selectable at a time"})]}),a("div",{className:"text-xs text-slate-500 mt-1",children:"When enabled, selecting one item automatically deselects others"})]}),a("div",{className:"form-group",children:[a("label",{className:"form-label",children:["Items",(i.value.items||[]).length===0&&a("span",{className:"text-orange-400 text-xs ml-1",children:"(at least one required)"})]}),(i.value.items||[]).length===0?a("div",{className:"text-center p-4 border border-dashed border-slate-600 rounded bg-slate-900",children:[a("div",{className:"text-slate-400 text-sm mb-2",children:"No items defined"}),s.value&&a("button",{className:"btn small primary",onClick:()=>{C({items:[{id:"",name:"",layersIds:[]}]})},children:"Add First Item"})]}):a("div",{className:"space-y-2",children:[i.value&&(i.value.items||[]).map((v,_)=>a("div",{className:"border border-slate-600 rounded p-3 bg-slate-900",draggable:!!(s.value&&i.value&&(i.value.items||[]).length>1),onDragStart:y=>{!s.value||!y.dataTransfer||(y.dataTransfer.setData("text/plain",_.toString()),y.dataTransfer.effectAllowed="move")},onDragOver:y=>{!s.value||!y.dataTransfer||(y.preventDefault(),y.dataTransfer.dropEffect="move")},onDrop:y=>{if(!s.value||!y.dataTransfer||!i.value)return;y.preventDefault();const N=parseInt(y.dataTransfer.getData("text/plain"));if(N!==_){const h=[...i.value.items||[]],w=h[N];h.splice(N,1),h.splice(_,0,w),C({items:h})}},style:{opacity:(s.value&&i.value&&(i.value.items||[]).length>1,"1"),cursor:s.value&&i.value&&(i.value.items||[]).length>1?"grab":"default"},children:[a("div",{className:"flex items-center gap-2 mb-2",children:[s.value&&i.value&&(i.value.items||[]).length>1&&a("div",{className:"cursor-move text-slate-400 hover:text-slate-300 px-1 select-none",title:"Drag to reorder items",onMouseDown:y=>y.stopPropagation(),children:"⋮⋮"}),a("span",{className:"text-xs text-slate-400 font-mono",children:["#",_+1]}),a("div",{className:"flex-1",children:[a("div",{className:"text-sm font-medium",children:v.name||v.id||`Item ${_+1}`}),a("div",{className:"text-xs text-slate-500",children:["ID: ",v.id||"(empty)"," • Layers: ",(v.layersIds||[]).length," • Legend: ",v.showLegend?"Yes":"No"]})]}),s.value&&i.value&&a("button",{className:"btn tiny danger",onClick:()=>{if(!i.value)return;const y=[...i.value.items||[]];y.splice(_,1),C({items:y})},children:"×"})]}),s.value&&a("div",{className:"space-y-2 text-xs",children:[a("div",{className:"grid grid-cols-2 gap-2",children:[a("div",{children:[a("label",{className:"block text-slate-400 mb-1",children:"Item ID"}),a("input",{type:"text",className:"w-full px-2 py-1 text-xs bg-slate-800 border border-slate-600 rounded",value:v.id||"",onChange:y=>{if(!i.value)return;const N=[...i.value.items||[]];N[_]={...v,id:y.target.value},C({items:N})},placeholder:"e.g. icing_index"})]}),a("div",{children:[a("label",{className:"block text-slate-400 mb-1",children:"Item Name"}),a("input",{type:"text",className:"w-full px-2 py-1 text-xs bg-slate-800 border border-slate-600 rounded",value:v.name||"",onChange:y=>{if(!i.value)return;const N=[...i.value.items||[]];N[_]={...v,name:y.target.value},C({items:N})},placeholder:"e.g. Icing Index (60 min)"})]})]}),a("div",{children:[a("label",{className:"block text-slate-400 mb-1",children:"Layer IDs"}),a(Jl,{selectedLayerIds:v.layersIds||[],onChange:y=>{if(!i.value)return;const N=[...i.value.items||[]];N[_]={...v,layersIds:y},C({items:N})}})]}),a("div",{className:"flex items-center gap-2",children:[a("input",{type:"checkbox",className:"form-checkbox",checked:v.showLegend||!1,onChange:y=>{if(!i.value)return;const N=[...i.value.items||[]];N[_]={...v,showLegend:y.target.checked},C({items:N})}}),a("span",{className:"text-slate-400",children:"Show Legend"})]})]})]},_)),i.value&&i.value.presentation!=="single"&&a("button",{className:"btn small w-full",onClick:()=>{if(s.value||m(),!i.value)return;const v={id:"",name:"",layersIds:[]};C({items:[...i.value.items||[],v]})},children:"+ Add Another Item"})]})]})]})]}),n.value==="intl"&&i.value&&a("div",{className:"h-full",children:a(Al,{feature:i.value,isEditing:s.value},`${e.value.type??"none"}:${e.value.index}:${s.value?"edit":"view"}`)}),n.value==="json"&&a("div",{className:"h-full min-h-0",children:a(Ft,{title:"Selected Feature JSON",value:i.value,onChange:I,readOnly:!s.value,height:"100%"},`${e.value.type??"none"}:${e.value.index}:${s.value?"edit":"view"}`)})]})]}):a("div",{className:"text-center p-5 text-slate-500 flex-1 flex items-center justify-center",children:r.value.active?"Creating new feature...":"Select a feature on the left to view/edit"})]})}function zl(){const e=L(()=>Rr.value),t=e.value.missingLayers.length,n=e.value.unusedLayers.length,r=Object.entries(e.value.missingIntl).map(([l,s])=>({lang:l,count:s.length})).filter(l=>l.count>0);return!t&&!n&&r.length===0?null:a("div",{className:"fixed bottom-0 left-0 right-0 bg-slate-800 border-t border-slate-700 p-2 px-3 text-xs flex gap-3 items-center z-10",children:[t>0&&a("span",{className:`pill ${t>0?"bad":"ok"}`,children:["Missing layers: ",t]}),n>0&&a("span",{className:`pill ${n>0?"warn":"ok"}`,children:["Unused layers: ",n]}),r.map(({lang:l,count:s})=>a("span",{className:`pill ${s>0?"warn":"ok"}`,children:[l," missing: ",s]},l)),e.value.missingLayers.length>0&&a("div",{className:"text-slate-500 text-[10px]",children:["Missing: ",e.value.missingLayers.join(", ")]}),e.value.unusedLayers.length>0&&a("div",{className:"text-slate-500 text-[10px]",children:["Unused: ",e.value.unusedLayers.join(", ")]})]})}function ql(){const e=L(()=>O.value),t=R(""),n=R(!1),r=R("any"),l=K(()=>{try{return[...Xe(e.value)].sort()}catch{return[]}},[e.value]),s=K(()=>{const o=t.value.toLowerCase().trim(),d=r.value,c=(f,u)=>{const m=e.value.intl?.[u]?.[f];return m===void 0||m===""};return l.filter(f=>{if(o){const u=f.toLowerCase().includes(o),m=F.some(p=>(e.value.intl?.[p]?.[f]||"").toLowerCase().includes(o));if(!u&&!m)return!1}if(n.value){if(d==="any"){if(!F.some(u=>c(f,u)))return!1}else if(!c(f,d))return!1}return!0})},[l,t.value,n.value,r.value,e.value]),i=(o,d,c)=>{const f={...e.value,intl:{...e.value.intl}};f.intl[d]={...f.intl[d]||{},[o]:c},W(f)};return l.length===0?a("div",{className:"p-4 text-center text-slate-500",children:"No translation keys found"}):a("div",{children:[a("div",{className:"flex gap-2 items-center mb-3",children:[a("button",{className:"btn small",onClick:Wn,children:"Fill missing from EN"}),a("input",{type:"text",className:"form-input",placeholder:"Search keys or translations…",value:t.value,onInput:o=>t.value=o.target.value}),a("label",{className:"flex items-center gap-2 text-xs text-slate-400",children:[a("input",{type:"checkbox",checked:n.value,onChange:o=>n.value=o.target.checked}),"Show missing only"]}),a("select",{className:"form-select text-xs",value:r.value,onChange:o=>r.value=o.target.value,children:[a("option",{value:"any",children:"Any language"}),F.map(o=>a("option",{value:o,children:o.toUpperCase()},o))]})]}),a("div",{className:"overflow-auto",children:a("table",{className:"w-full text-sm border-collapse",children:[a("thead",{children:a("tr",{children:[a("th",{className:"text-left p-2 border-b border-slate-700 sticky top-0 bg-slate-800",children:"Key"}),F.map(o=>a("th",{className:"text-left p-2 border-b border-slate-700 sticky top-0 bg-slate-800",children:o.toUpperCase()},o))]})}),a("tbody",{children:s.map(o=>a("tr",{className:"align-top",children:[a("td",{className:"p-2 border-b border-slate-800 text-slate-300 whitespace-nowrap",children:o}),F.map(d=>a("td",{className:"p-2 border-b border-slate-800 min-w-[220px]",children:a("input",{type:"text",className:"form-input w-full",value:e.value.intl?.[d]?.[o]??"",onInput:c=>i(o,d,c.target.value),placeholder:`[${d}] ${o}`})},d))]},o))})]})})]})}function Kl({translationKey:e,isSelected:t,onSelect:n}){const r=L(()=>O.value),l=K(()=>F.reduce((i,o)=>{const d=r.value.intl?.[o]?.[e];return i+(d===void 0||d===""?1:0)},0),[e,r.value]),s=K(()=>F.some(i=>{const o=r.value.intl?.[i]?.[e];return o!==void 0&&o!==""}),[e,r.value]);return a("div",{className:`feature-list-item ${t?"selected":""}`,onClick:n,children:[a("div",{className:"feature-info",children:[a("div",{className:"feature-name",children:e}),a("div",{className:"feature-details",children:[F.length-l,"/",F.length," languages",l>0&&` • ${l} missing`,!s&&" • No translations"]})]}),a("div",{className:"feature-actions",children:[l>0&&a("span",{className:"pill warn",children:["Missing ",l]}),!s&&a("span",{className:"pill bad",children:"Empty"}),l===0&&s&&a("span",{className:"pill ok",children:"Complete"})]})]})}function Bl({title:e,keys:t,selectedKey:n,onSelectKey:r}){return a("details",{open:!0,className:"feature-category",children:[a("summary",{className:"feature-category-header",children:e}),a("div",{className:"feature-category-content",children:t.length===0?a("div",{className:"p-3 text-slate-500 text-center",children:["No ",e.toLowerCase()," found"]}):t.map(l=>a(Kl,{translationKey:l,isSelected:n===l,onSelect:()=>r(l)},l))})]})}function Gl({selectedKey:e,onSelectKey:t}){const n=L(()=>O.value),r=R(""),l=R(!1),s=R("any"),i=K(()=>{try{return[...Xe(n.value)].sort()}catch{return[]}},[n.value]),o=K(()=>{const c=r.value.toLowerCase().trim(),f=s.value,u=(m,p)=>{const S=n.value.intl?.[p]?.[m];return S===void 0||S===""};return i.filter(m=>{if(c){const p=m.toLowerCase().includes(c),S=F.some(C=>(n.value.intl?.[C]?.[m]||"").toLowerCase().includes(c));if(!p&&!S)return!1}if(l.value){if(f==="any"){if(!F.some(p=>u(m,p)))return!1}else if(!u(m,f))return!1}return!0})},[i,r.value,l.value,s.value,n.value]),d=K(()=>{const c={"Weather Features":[],"General Features":[],Layers:[],Other:[]};return o.forEach(f=>{f.includes("weather")||f.includes("radar")||f.includes("wind")||f.includes("cloud")?c["Weather Features"].push(f):f.includes("layer")||f.includes("overlay")?c.Layers.push(f):f.includes("feature")||f.includes("item")?c["General Features"].push(f):c.Other.push(f)}),c},[o]);return i.length===0?a("div",{children:[a("div",{className:"mb-3",children:a("button",{className:"btn primary",disabled:!0,children:"No Translation Keys Found"})}),a("div",{className:"p-4 text-center text-slate-500",children:"Load a JSON file with translation keys to get started"})]}):a("div",{children:[a("div",{className:"mb-3",children:a("button",{className:"btn primary",onClick:Wn,children:"🌐 Fill Missing from EN"})}),a("div",{className:"flex flex-col gap-2 items-stretch mb-3",children:[a("input",{type:"text",className:"form-input",placeholder:"Search keys or translations…",value:r.value,onInput:c=>r.value=c.target.value}),a("div",{className:"flex gap-2 items-center",children:[a("label",{className:"flex items-center gap-2 text-xs text-slate-400",children:[a("input",{type:"checkbox",checked:l.value,onChange:c=>l.value=c.target.checked}),"Show missing only"]}),a("select",{className:"form-select text-xs flex-1",value:s.value,onChange:c=>s.value=c.target.value,children:[a("option",{value:"any",children:"Any language"}),F.map(c=>a("option",{value:c,children:c.toUpperCase()},c))]})]})]}),a("div",{className:"feature-browser",children:Object.entries(d).map(([c,f])=>f.length>0&&a(Bl,{title:c,keys:f,selectedKey:e,onSelectKey:t},c))})]})}function Yl({selectedKey:e}){const t=L(()=>O.value),n=K(()=>{if(!e)return null;const o={};return F.forEach(d=>{o[d]=t.value.intl?.[d]?.[e]??""}),o},[e,t.value]),r=K(()=>n?F.filter(o=>n[o]===void 0||n[o]===""):[],[n]),l=(o,d)=>{if(!e)return;const c={...t.value,intl:{...t.value.intl}};c.intl[o]={...c.intl[o]||{},[e]:d},W(c)},s=()=>{if(!e||!n)return;const o=n.en;if(!o)return;const d={...t.value,intl:{...t.value.intl}};r.forEach(c=>{d.intl[c]||(d.intl[c]={}),d.intl[c][e]=o}),W(d)},i=()=>{if(!e||!confirm("Are you sure you want to clear all translations for this key?"))return;const o={...t.value,intl:{...t.value.intl}};F.forEach(d=>{o.intl[d]&&o.intl[d][e]&&delete o.intl[d][e]}),W(o)};return e?n?a("div",{className:"h-full flex flex-col",children:[a("div",{className:"mb-4",children:[a("h3",{className:"text-lg font-medium text-slate-200 mb-1",children:"Translation Editor"}),a("div",{className:"flex items-center gap-2",children:[a("code",{className:"inline text-slate-400",children:e}),r.length>0&&a("span",{className:"pill warn",children:[r.length," missing"]}),r.length===0&&a("span",{className:"pill ok",children:"Complete"})]})]}),a("div",{className:"flex gap-2 mb-4",children:[r.length>0&&n.en&&a("button",{className:"btn small",onClick:s,children:"Fill missing from EN"}),a("button",{className:"btn danger small",onClick:i,children:"Clear all"})]}),a("div",{className:"flex-1 overflow-y-auto",children:a("div",{className:"space-y-4",children:F.map(o=>a("div",{className:"form-group",children:[a("label",{className:"form-label flex items-center gap-2",children:[a("span",{className:"font-mono text-xs bg-slate-700 px-2 py-1 rounded",children:o.toUpperCase()}),o==="en"&&a("span",{className:"text-slate-500 text-xs",children:"(Default)"}),r.includes(o)&&a("span",{className:"text-yellow-500 text-xs",children:"• Missing"})]}),a("textarea",{className:"form-textarea",rows:3,value:n[o],onInput:d=>l(o,d.target.value),placeholder:`Enter ${o.toUpperCase()} translation for "${e}"`}),o==="en"&&n[o]&&a("div",{className:"form-help",children:"This will be used as fallback for missing translations"})]},o))})}),a("div",{className:"mt-4 pt-4 border-t border-slate-700",children:a("div",{className:"text-xs text-slate-500",children:[a("div",{className:"mb-1",children:[a("strong",{children:"Translation Status:"})," ",F.length-r.length,"/",F.length," languages"]}),r.length>0&&a("div",{children:[a("strong",{children:"Missing:"})," ",r.map(o=>o.toUpperCase()).join(", ")]})]})})]}):a("div",{className:"h-full flex items-center justify-center",children:a("div",{className:"text-center text-slate-500",children:[a("div",{className:"text-6xl mb-4",children:"⚠️"}),a("div",{className:"text-lg font-medium mb-2",children:"Error Loading Translations"}),a("div",{className:"text-sm",children:"Unable to load translation data for this key"})]})}):a("div",{className:"h-full flex flex-col",children:[a("div",{className:"mb-4",children:[a("h3",{className:"text-lg font-medium text-slate-200 mb-2",children:"Translation Editor"}),a("p",{className:"text-slate-500 text-sm",children:"Select a translation key from the left panel to edit its translations."})]}),a("div",{className:"flex-1 flex items-center justify-center",children:a("div",{className:"text-center text-slate-500",children:[a("div",{className:"text-6xl mb-4",children:"🌐"}),a("div",{className:"text-lg font-medium mb-2",children:"No Key Selected"}),a("div",{className:"text-sm",children:"Choose a translation key to start editing"})]})})]})}function Zl(){const e=L(()=>O.value.layers?.map(n=>n.id).filter(Boolean)||[]),t=L(()=>ne.value.customLogicLayers);return a("div",{className:"max-h-[calc(100vh-180px)] overflow-auto",children:[a("div",{className:"mb-4",children:[a("h3",{className:"text-lg font-semibold mb-2",children:"Application Settings"}),a("p",{className:"text-sm text-slate-400 mb-4",children:"Configure layers with custom logic that are referenced in your application code."})]}),a("div",{className:"space-y-4",children:[a("div",{children:[a("h4",{className:"font-medium mb-3",children:"Referenced Layers"}),a("p",{className:"text-sm text-slate-400 mb-3",children:'Layers marked as "referenced" are used in your application code (Dart) and should be handled differently during validation.'}),a("div",{className:"space-y-3",children:[a("div",{className:"p-3 bg-slate-700 rounded",children:[a("div",{className:"text-sm font-medium mb-2",children:"Current Referenced Layers:"}),t.value.size===0?a("div",{className:"text-slate-400 text-sm italic",children:"None"}):a("div",{className:"font-mono text-sm text-blue-300",children:Array.from(t.value).join(", ")})]}),a("div",{className:"p-3 bg-slate-700 rounded",children:[a("div",{className:"text-sm font-medium mb-2",children:"Available Layers:"}),e.value.length===0?a("div",{className:"text-slate-400 text-sm",children:"No layers found. Add some layers first."}):a("div",{className:"flex flex-wrap gap-2",children:e.value.map(n=>a("button",{onClick:()=>Ir(n),className:`px-2 py-1 rounded text-xs font-mono transition-colors ${Ne(n)?"bg-blue-600 text-white hover:bg-blue-700":"bg-slate-600 text-slate-300 hover:bg-slate-500"}`,children:[Ne(n)?"✓ ":"+ ",n]},n))})]})]})]}),a("div",{className:"mt-6 p-3 bg-slate-700 rounded text-sm",children:[a("h5",{className:"font-medium mb-2",children:'What does "Referenced" mean?'}),a("ul",{className:"text-slate-400 space-y-1 text-xs",children:[a("li",{children:"• Layer is referenced/used in your Dart application code"}),a("li",{children:"• Layer should be handled differently during validation"}),a("li",{children:"• Layer appears with visual indicators throughout the UI"}),a("li",{children:"• Settings are saved locally in your browser"})]})]}),t.value.size>0&&a("div",{className:"mt-4 p-3 bg-blue-900/20 border border-blue-700 rounded text-sm",children:[a("h5",{className:"font-medium mb-2 text-blue-300",children:["Referenced Layers (",t.value.size,")"]}),a("div",{className:"flex flex-wrap gap-1",children:Array.from(t.value).map(n=>a("span",{className:"font-mono text-xs bg-blue-600 text-white px-2 py-1 rounded",children:n},n))})]})]})]})}function Ql({onOpenClick:e}){return a("div",{className:"flex items-center justify-center min-h-[60vh]",onPaste:l=>{const s=l.clipboardData?.getData("text");if(s)try{const i=JSON.parse(s);W(i),M("✅ JSON pasted from clipboard")}catch{}},children:a("div",{className:"w-full max-w-2xl text-center p-8 border border-dashed border-slate-600 rounded-xl bg-slate-900/40",onDrop:l=>{l.preventDefault();const i=Array.from(l.dataTransfer?.files||[]).find(o=>o.type==="application/json"||o.name.endsWith(".json"));if(i){const o=new FileReader;o.onload=d=>{const c=d.target?.result;if(c)try{const f=JSON.parse(c);W(f),M("✅ JSON file loaded successfully")}catch{M("❌ Invalid JSON dropped")}},o.readAsText(i)}},onDragOver:l=>{l.preventDefault()},children:[a("h2",{className:"text-lg mb-2 text-slate-100",children:"Drop your JSON here"}),a("p",{className:"mb-4 text-slate-400",children:"or"}),a("div",{className:"flex flex-col gap-2 items-center",children:a("button",{className:"btn primary",onClick:e,children:"Click to Open JSON…"})}),a("div",{className:"mt-4 text-xs text-slate-500",children:"Tip: You can also paste JSON here"})]})})}const Xl=[{id:"features",label:"Features"},{id:"layers",label:"Layers"},{id:"internationalization",label:"i18n"},{id:"json",label:"JSON"},{id:"settings",label:"Settings"}];function es(){const e=J(null),t=R(null),n=R("split");Z(()=>{$e.value||zr()},[]);const r=()=>{e.current?.click()};return a("div",{className:"app",children:[a("input",{ref:e,type:"file",accept:"application/json,.json",style:{display:"none"},onChange:l=>{const s=l.target.files?.[0];if(s){const i=new FileReader;i.onload=o=>{const d=o.target?.result;if(d)try{const c=JSON.parse(d);W(c),M("✅ JSON file loaded successfully")}catch(c){M(`❌ Invalid JSON: ${c instanceof Error?c.message:"Parse error"}`)}},i.readAsText(s)}}}),$e.value&&a("header",{className:"flex gap-3 items-center p-3 border-b border-slate-700 sticky top-0 z-[5]",style:{background:"rgba(15, 17, 21, 0.9)",backdropFilter:"saturate(1.2) blur(6px)"},children:[a("h1",{className:"text-base m-0 mr-2 opacity-95",children:"Map Layers JSON Editor"}),a("button",{className:"btn",onClick:r,children:"Open JSON…"}),a("div",{className:"ml-auto flex flex-col items-end gap-1",children:[$e.value&&a("span",{className:"text-slate-500",children:Vr.value}),a("div",{className:"text-xs max-w-[300px] text-right text-slate-500",children:He.value})]})]}),$e.value?a("div",{className:"p-3 min-h-[calc(100vh-80px)]",children:[a("div",{className:"flex gap-1 mb-3 border-b border-slate-700 pb-2",children:Xl.map(l=>a("button",{className:`px-4 py-2 rounded-t-md text-xs transition-all duration-150 text-decoration-none ${de.value===l.id?"bg-blue-500 text-white border-blue-500":"bg-slate-950 text-slate-500 border border-slate-700 hover:border-slate-600 hover:text-slate-200"}`,onClick:()=>de.value=l.id,children:l.label},l.id))}),de.value==="features"&&a("div",{className:"flex gap-3 h-[calc(100vh-200px)] overflow-hidden",children:[a("div",{className:"flex-1 min-w-0 bg-slate-800 border border-slate-700 rounded-xl p-3 flex flex-col",children:a(Fl,{})}),a("div",{className:"flex-1 min-w-0 bg-slate-800 border border-slate-700 rounded-xl p-3 flex flex-col",children:a(Hl,{})})]}),de.value==="layers"&&a("div",{className:"flex gap-3 h-[calc(100vh-200px)] overflow-hidden",children:[a("div",{className:"flex-1 min-w-0 bg-slate-800 border border-slate-700 rounded-xl p-3 flex flex-col",children:a(Ml,{})}),a("div",{className:"flex-1 min-w-0 bg-slate-800 border border-slate-700 rounded-xl p-3 flex flex-col",children:a(Pl,{})})]}),de.value==="internationalization"&&a("div",{children:[a("div",{className:"flex gap-1 mb-3 border-b border-slate-700 pb-2",children:[a("button",{className:`px-3 py-1.5 rounded text-xs transition-all duration-150 ${n.value==="split"?"bg-blue-500 text-white":"bg-slate-800 text-slate-500 border border-slate-700 hover:border-slate-600 hover:text-slate-200"}`,onClick:()=>n.value="split",children:"Split View"}),a("button",{className:`px-3 py-1.5 rounded text-xs transition-all duration-150 ${n.value==="table"?"bg-blue-500 text-white":"bg-slate-800 text-slate-500 border border-slate-700 hover:border-slate-600 hover:text-slate-200"}`,onClick:()=>n.value="table",children:"Table View"})]}),n.value==="split"&&a("div",{className:"flex gap-3 h-[calc(100vh-200px)] overflow-hidden",children:[a("div",{className:"flex-1 min-w-0 bg-slate-800 border border-slate-700 rounded-xl p-3 flex flex-col",children:a("div",{className:"flex-1 min-h-0 overflow-auto",children:a(Gl,{selectedKey:t.value,onSelectKey:l=>t.value=l})})}),a("div",{className:"flex-1 min-w-0 bg-slate-800 border border-slate-700 rounded-xl p-3 flex flex-col",children:a(Yl,{selectedKey:t.value})})]}),n.value==="table"&&a("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-3 flex flex-col h-[calc(100vh-200px)]",children:a("div",{className:"flex-1 min-h-0",children:a(ql,{})})})]}),de.value==="json"&&a("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-3 flex flex-col h-[calc(100vh-180px)]",children:[a("div",{className:"flex-1 min-h-0",children:a(Ft,{title:"Complete JSON Configuration",value:O.value,onChange:l=>{W(l),M("✅ JSON updated successfully")},height:"100%"})}),a("div",{className:"flex gap-2 mt-3 pt-3 border-t border-slate-700 flex-shrink-0",children:[a("button",{className:"btn small",onClick:()=>{const l=Fr(JSON.stringify(O.value));l.valid?M("✅ JSON is valid"):M(`❌ Validation failed: ${l.errors.length} error(s), ${l.warnings.length} warning(s)`)},children:"Validate Structure"}),a("button",{className:"btn success small",onClick:()=>{try{const l=JSON.stringify(O.value,null,2),s=new Date().toISOString().slice(0,19).replace(/[:.]/g,"-");$r(`map-layers-${s}.json`,l),M("✅ JSON file downloaded")}catch{M("❌ Download failed")}},children:"Download JSON"})]})]}),de.value==="settings"&&a("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-3",children:a(Zl,{})})]}):a("div",{className:"p-6",children:a(Ql,{onOpenClick:r})}),a(zl,{})]})}be(a(es,{}),document.getElementById("app"));
