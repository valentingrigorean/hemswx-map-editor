(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))a(l);new MutationObserver(l=>{for(const s of l)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function n(l){const s={};return l.integrity&&(s.integrity=l.integrity),l.referrerPolicy&&(s.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?s.credentials="include":l.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(l){if(l.ep)return;l.ep=!0;const s=n(l);fetch(l.href,s)}})();var je,k,fn,pn,fe,jt,hn,mn,vn,Nt,pt,ht,gn,Fe={},_n=[],fr=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,Ae=Array.isArray;function ee(e,t){for(var n in t)e[n]=t[n];return e}function wt(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function se(e,t,n){var a,l,s,i={};for(s in t)s=="key"?a=t[s]:s=="ref"?l=t[s]:i[s]=t[s];if(arguments.length>2&&(i.children=arguments.length>3?je.call(arguments,2):n),typeof e=="function"&&e.defaultProps!=null)for(s in e.defaultProps)i[s]===void 0&&(i[s]=e.defaultProps[s]);return De(e,i,a,l,null)}function De(e,t,n,a,l){var s={type:e,props:t,key:n,ref:a,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:l??++fn,__i:-1,__u:0};return l==null&&k.vnode!=null&&k.vnode(s),s}function pr(){return{current:null}}function V(e){return e.children}function X(e,t){this.props=e,this.context=t}function be(e,t){if(t==null)return e.__?be(e.__,e.__i+1):null;for(var n;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null)return n.__e;return typeof e.type=="function"?be(e):null}function yn(e){var t,n;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null){e.__e=e.__c.base=n.__e;break}return yn(e)}}function mt(e){(!e.__d&&(e.__d=!0)&&fe.push(e)&&!Be.__r++||jt!=k.debounceRendering)&&((jt=k.debounceRendering)||hn)(Be)}function Be(){for(var e,t,n,a,l,s,i,o=1;fe.length;)fe.length>o&&fe.sort(mn),e=fe.shift(),o=fe.length,e.__d&&(n=void 0,l=(a=(t=e).__v).__e,s=[],i=[],t.__P&&((n=ee({},a)).__v=a.__v+1,k.vnode&&k.vnode(n),St(t.__P,n,a,t.__n,t.__P.namespaceURI,32&a.__u?[l]:null,s,l??be(a),!!(32&a.__u),i),n.__v=a.__v,n.__.__k[n.__i]=n,Nn(s,n,i),n.__e!=l&&yn(n)));Be.__r=0}function bn(e,t,n,a,l,s,i,o,u,c,f){var d,m,g,C,j,O,$=a&&a.__k||_n,b=t.length;for(u=hr(n,t,$,u,b),d=0;d<b;d++)(g=n.__k[d])!=null&&(m=g.__i==-1?Fe:$[g.__i]||Fe,g.__i=d,O=St(e,g,m,l,s,i,o,u,c,f),C=g.__e,g.ref&&m.ref!=g.ref&&(m.ref&&Ct(m.ref,null,g),f.push(g.ref,g.__c||C,g)),j==null&&C!=null&&(j=C),4&g.__u||m.__k===g.__k?u=xn(g,u,e):typeof g.type=="function"&&O!==void 0?u=O:C&&(u=C.nextSibling),g.__u&=-7);return n.__e=j,u}function hr(e,t,n,a,l){var s,i,o,u,c,f=n.length,d=f,m=0;for(e.__k=new Array(l),s=0;s<l;s++)(i=t[s])!=null&&typeof i!="boolean"&&typeof i!="function"?(u=s+m,(i=e.__k[s]=typeof i=="string"||typeof i=="number"||typeof i=="bigint"||i.constructor==String?De(null,i,null,null,null):Ae(i)?De(V,{children:i},null,null,null):i.constructor==null&&i.__b>0?De(i.type,i.props,i.key,i.ref?i.ref:null,i.__v):i).__=e,i.__b=e.__b+1,o=null,(c=i.__i=mr(i,n,u,d))!=-1&&(d--,(o=n[c])&&(o.__u|=2)),o==null||o.__v==null?(c==-1&&(l>f?m--:l<f&&m++),typeof i.type!="function"&&(i.__u|=4)):c!=u&&(c==u-1?m--:c==u+1?m++:(c>u?m--:m++,i.__u|=4))):e.__k[s]=null;if(d)for(s=0;s<f;s++)(o=n[s])!=null&&!(2&o.__u)&&(o.__e==a&&(a=be(o)),Sn(o,o));return a}function xn(e,t,n){var a,l;if(typeof e.type=="function"){for(a=e.__k,l=0;a&&l<a.length;l++)a[l]&&(a[l].__=e,t=xn(a[l],t,n));return t}e.__e!=t&&(t&&e.type&&!n.contains(t)&&(t=be(e)),n.insertBefore(e.__e,t||null),t=e.__e);do t=t&&t.nextSibling;while(t!=null&&t.nodeType==8);return t}function ae(e,t){return t=t||[],e==null||typeof e=="boolean"||(Ae(e)?e.some(function(n){ae(n,t)}):t.push(e)),t}function mr(e,t,n,a){var l,s,i,o=e.key,u=e.type,c=t[n],f=c!=null&&(2&c.__u)==0;if(c===null&&e.key==null||f&&o==c.key&&u==c.type)return n;if(a>(f?1:0)){for(l=n-1,s=n+1;l>=0||s<t.length;)if((c=t[i=l>=0?l--:s++])!=null&&!(2&c.__u)&&o==c.key&&u==c.type)return i}return-1}function At(e,t,n){t[0]=="-"?e.setProperty(t,n??""):e[t]=n==null?"":typeof n!="number"||fr.test(t)?n:n+"px"}function Je(e,t,n,a,l){var s,i;e:if(t=="style")if(typeof n=="string")e.style.cssText=n;else{if(typeof a=="string"&&(e.style.cssText=a=""),a)for(t in a)n&&t in n||At(e.style,t,"");if(n)for(t in n)a&&n[t]==a[t]||At(e.style,t,n[t])}else if(t[0]=="o"&&t[1]=="n")s=t!=(t=t.replace(vn,"$1")),i=t.toLowerCase(),t=i in e||t=="onFocusOut"||t=="onFocusIn"?i.slice(2):t.slice(2),e.l||(e.l={}),e.l[t+s]=n,n?a?n.u=a.u:(n.u=Nt,e.addEventListener(t,s?ht:pt,s)):e.removeEventListener(t,s?ht:pt,s);else{if(l=="http://www.w3.org/2000/svg")t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!="width"&&t!="height"&&t!="href"&&t!="list"&&t!="form"&&t!="tabIndex"&&t!="download"&&t!="rowSpan"&&t!="colSpan"&&t!="role"&&t!="popover"&&t in e)try{e[t]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&t[4]!="-"?e.removeAttribute(t):e.setAttribute(t,t=="popover"&&n==1?"":n))}}function Pt(e){return function(t){if(this.l){var n=this.l[t.type+e];if(t.t==null)t.t=Nt++;else if(t.t<n.u)return;return n(k.event?k.event(t):t)}}}function St(e,t,n,a,l,s,i,o,u,c){var f,d,m,g,C,j,O,$,b,A,p,_,N,w,h,y,v,x=t.type;if(t.constructor!=null)return null;128&n.__u&&(u=!!(32&n.__u),s=[o=t.__e=n.__e]),(f=k.__b)&&f(t);e:if(typeof x=="function")try{if($=t.props,b="prototype"in x&&x.prototype.render,A=(f=x.contextType)&&a[f.__c],p=f?A?A.props.value:f.__:a,n.__c?O=(d=t.__c=n.__c).__=d.__E:(b?t.__c=d=new x($,p):(t.__c=d=new X($,p),d.constructor=x,d.render=gr),A&&A.sub(d),d.props=$,d.state||(d.state={}),d.context=p,d.__n=a,m=d.__d=!0,d.__h=[],d._sb=[]),b&&d.__s==null&&(d.__s=d.state),b&&x.getDerivedStateFromProps!=null&&(d.__s==d.state&&(d.__s=ee({},d.__s)),ee(d.__s,x.getDerivedStateFromProps($,d.__s))),g=d.props,C=d.state,d.__v=t,m)b&&x.getDerivedStateFromProps==null&&d.componentWillMount!=null&&d.componentWillMount(),b&&d.componentDidMount!=null&&d.__h.push(d.componentDidMount);else{if(b&&x.getDerivedStateFromProps==null&&$!==g&&d.componentWillReceiveProps!=null&&d.componentWillReceiveProps($,p),!d.__e&&d.shouldComponentUpdate!=null&&d.shouldComponentUpdate($,d.__s,p)===!1||t.__v==n.__v){for(t.__v!=n.__v&&(d.props=$,d.state=d.__s,d.__d=!1),t.__e=n.__e,t.__k=n.__k,t.__k.some(function(L){L&&(L.__=t)}),_=0;_<d._sb.length;_++)d.__h.push(d._sb[_]);d._sb=[],d.__h.length&&i.push(d);break e}d.componentWillUpdate!=null&&d.componentWillUpdate($,d.__s,p),b&&d.componentDidUpdate!=null&&d.__h.push(function(){d.componentDidUpdate(g,C,j)})}if(d.context=p,d.props=$,d.__P=e,d.__e=!1,N=k.__r,w=0,b){for(d.state=d.__s,d.__d=!1,N&&N(t),f=d.render(d.props,d.state,d.context),h=0;h<d._sb.length;h++)d.__h.push(d._sb[h]);d._sb=[]}else do d.__d=!1,N&&N(t),f=d.render(d.props,d.state,d.context),d.state=d.__s;while(d.__d&&++w<25);d.state=d.__s,d.getChildContext!=null&&(a=ee(ee({},a),d.getChildContext())),b&&!m&&d.getSnapshotBeforeUpdate!=null&&(j=d.getSnapshotBeforeUpdate(g,C)),y=f,f!=null&&f.type===V&&f.key==null&&(y=wn(f.props.children)),o=bn(e,Ae(y)?y:[y],t,n,a,l,s,i,o,u,c),d.base=t.__e,t.__u&=-161,d.__h.length&&i.push(d),O&&(d.__E=d.__=null)}catch(L){if(t.__v=null,u||s!=null)if(L.then){for(t.__u|=u?160:128;o&&o.nodeType==8&&o.nextSibling;)o=o.nextSibling;s[s.indexOf(o)]=null,t.__e=o}else{for(v=s.length;v--;)wt(s[v]);vt(t)}else t.__e=n.__e,t.__k=n.__k,L.then||vt(t);k.__e(L,t,n)}else s==null&&t.__v==n.__v?(t.__k=n.__k,t.__e=n.__e):o=t.__e=vr(n.__e,t,n,a,l,s,i,u,c);return(f=k.diffed)&&f(t),128&t.__u?void 0:o}function vt(e){e&&e.__c&&(e.__c.__e=!0),e&&e.__k&&e.__k.forEach(vt)}function Nn(e,t,n){for(var a=0;a<n.length;a++)Ct(n[a],n[++a],n[++a]);k.__c&&k.__c(t,e),e.some(function(l){try{e=l.__h,l.__h=[],e.some(function(s){s.call(l)})}catch(s){k.__e(s,l.__v)}})}function wn(e){return typeof e!="object"||e==null||e.__b&&e.__b>0?e:Ae(e)?e.map(wn):ee({},e)}function vr(e,t,n,a,l,s,i,o,u){var c,f,d,m,g,C,j,O=n.props,$=t.props,b=t.type;if(b=="svg"?l="http://www.w3.org/2000/svg":b=="math"?l="http://www.w3.org/1998/Math/MathML":l||(l="http://www.w3.org/1999/xhtml"),s!=null){for(c=0;c<s.length;c++)if((g=s[c])&&"setAttribute"in g==!!b&&(b?g.localName==b:g.nodeType==3)){e=g,s[c]=null;break}}if(e==null){if(b==null)return document.createTextNode($);e=document.createElementNS(l,b,$.is&&$),o&&(k.__m&&k.__m(t,s),o=!1),s=null}if(b==null)O===$||o&&e.data==$||(e.data=$);else{if(s=s&&je.call(e.childNodes),O=n.props||Fe,!o&&s!=null)for(O={},c=0;c<e.attributes.length;c++)O[(g=e.attributes[c]).name]=g.value;for(c in O)if(g=O[c],c!="children"){if(c=="dangerouslySetInnerHTML")d=g;else if(!(c in $)){if(c=="value"&&"defaultValue"in $||c=="checked"&&"defaultChecked"in $)continue;Je(e,c,null,g,l)}}for(c in $)g=$[c],c=="children"?m=g:c=="dangerouslySetInnerHTML"?f=g:c=="value"?C=g:c=="checked"?j=g:o&&typeof g!="function"||O[c]===g||Je(e,c,g,O[c],l);if(f)o||d&&(f.__html==d.__html||f.__html==e.innerHTML)||(e.innerHTML=f.__html),t.__k=[];else if(d&&(e.innerHTML=""),bn(t.type=="template"?e.content:e,Ae(m)?m:[m],t,n,a,b=="foreignObject"?"http://www.w3.org/1999/xhtml":l,s,i,s?s[0]:n.__k&&be(n,0),o,u),s!=null)for(c=s.length;c--;)wt(s[c]);o||(c="value",b=="progress"&&C==null?e.removeAttribute("value"):C!=null&&(C!==e[c]||b=="progress"&&!C||b=="option"&&C!=O[c])&&Je(e,c,C,O[c],l),c="checked",j!=null&&j!=e[c]&&Je(e,c,j,O[c],l))}return e}function Ct(e,t,n){try{if(typeof e=="function"){var a=typeof e.__u=="function";a&&e.__u(),a&&t==null||(e.__u=e(t))}else e.current=t}catch(l){k.__e(l,n)}}function Sn(e,t,n){var a,l;if(k.unmount&&k.unmount(e),(a=e.ref)&&(a.current&&a.current!=e.__e||Ct(a,null,t)),(a=e.__c)!=null){if(a.componentWillUnmount)try{a.componentWillUnmount()}catch(s){k.__e(s,t)}a.base=a.__P=null}if(a=e.__k)for(l=0;l<a.length;l++)a[l]&&Sn(a[l],t,n||typeof e.type!="function");n||wt(e.__e),e.__c=e.__=e.__e=void 0}function gr(e,t,n){return this.constructor(e,n)}function xe(e,t,n){var a,l,s,i;t==document&&(t=document.documentElement),k.__&&k.__(e,t),l=(a=typeof n=="function")?null:n&&n.__k||t.__k,s=[],i=[],St(t,e=(!a&&n||t).__k=se(V,null,[e]),l||Fe,Fe,t.namespaceURI,!a&&n?[n]:l?null:t.firstChild?je.call(t.childNodes):null,s,!a&&n?n:l?l.__e:t.firstChild,a,i),Nn(s,e,i)}function Cn(e,t){xe(e,t,Cn)}function _r(e,t,n){var a,l,s,i,o=ee({},e.props);for(s in e.type&&e.type.defaultProps&&(i=e.type.defaultProps),t)s=="key"?a=t[s]:s=="ref"?l=t[s]:o[s]=t[s]===void 0&&i!=null?i[s]:t[s];return arguments.length>2&&(o.children=arguments.length>3?je.call(arguments,2):n),De(e.type,o,a||e.key,l||e.ref,null)}function yr(e){function t(n){var a,l;return this.getChildContext||(a=new Set,(l={})[t.__c]=this,this.getChildContext=function(){return l},this.componentWillUnmount=function(){a=null},this.shouldComponentUpdate=function(s){this.props.value!=s.value&&a.forEach(function(i){i.__e=!0,mt(i)})},this.sub=function(s){a.add(s);var i=s.componentWillUnmount;s.componentWillUnmount=function(){a&&a.delete(s),i&&i.call(s)}}),n.children}return t.__c="__cC"+gn++,t.__=e,t.Provider=t.__l=(t.Consumer=function(n,a){return n.children(a)}).contextType=t,t}je=_n.slice,k={__e:function(e,t,n,a){for(var l,s,i;t=t.__;)if((l=t.__c)&&!l.__)try{if((s=l.constructor)&&s.getDerivedStateFromError!=null&&(l.setState(s.getDerivedStateFromError(e)),i=l.__d),l.componentDidCatch!=null&&(l.componentDidCatch(e,a||{}),i=l.__d),i)return l.__E=l}catch(o){e=o}throw e}},fn=0,pn=function(e){return e!=null&&e.constructor==null},X.prototype.setState=function(e,t){var n;n=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=ee({},this.state),typeof e=="function"&&(e=e(ee({},n),this.props)),e&&ee(n,e),e!=null&&this.__v&&(t&&this._sb.push(t),mt(this))},X.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),mt(this))},X.prototype.render=V,fe=[],hn=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,mn=function(e,t){return e.__v.__b-t.__v.__b},Be.__r=0,vn=/(PointerCapture)$|Capture$/i,Nt=0,pt=Pt(!1),ht=Pt(!0),gn=0;var br=0;function r(e,t,n,a,l,s){t||(t={});var i,o,u=t;if("ref"in u)for(o in u={},t)o=="ref"?i=t[o]:u[o]=t[o];var c={type:e,props:u,key:n,ref:i,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--br,__i:-1,__u:0,__source:l,__self:s};if(typeof e=="function"&&(i=e.defaultProps))for(o in i)u[o]===void 0&&(u[o]=i[o]);return k.vnode&&k.vnode(c),c}var ce,U,st,Ut,Ne=0,$n=[],J=k,Jt=J.__b,Rt=J.__r,Wt=J.diffed,Vt=J.__c,zt=J.unmount,Ht=J.__;function Se(e,t){J.__h&&J.__h(U,e,Ne||t),Ne=0;var n=U.__H||(U.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({}),n.__[e]}function he(e){return Ne=1,$t(En,e)}function $t(e,t,n){var a=Se(ce++,2);if(a.t=e,!a.__c&&(a.__=[n?n(t):En(void 0,t),function(o){var u=a.__N?a.__N[0]:a.__[0],c=a.t(u,o);u!==c&&(a.__N=[c,a.__[1]],a.__c.setState({}))}],a.__c=U,!U.__f)){var l=function(o,u,c){if(!a.__c.__H)return!0;var f=a.__c.__H.__.filter(function(m){return!!m.__c});if(f.every(function(m){return!m.__N}))return!s||s.call(this,o,u,c);var d=a.__c.props!==o;return f.forEach(function(m){if(m.__N){var g=m.__[0];m.__=m.__N,m.__N=void 0,g!==m.__[0]&&(d=!0)}}),s&&s.call(this,o,u,c)||d};U.__f=!0;var s=U.shouldComponentUpdate,i=U.componentWillUpdate;U.componentWillUpdate=function(o,u,c){if(this.__e){var f=s;s=void 0,l(o,u,c),s=f}i&&i.call(this,o,u,c)},U.shouldComponentUpdate=l}return a.__N||a.__}function Y(e,t){var n=Se(ce++,3);!J.__s&&Lt(n.__H,t)&&(n.__=e,n.u=t,U.__H.__h.push(n))}function Pe(e,t){var n=Se(ce++,4);!J.__s&&Lt(n.__H,t)&&(n.__=e,n.u=t,U.__h.push(n))}function R(e){return Ne=5,K(function(){return{current:e}},[])}function Ln(e,t,n){Ne=6,Pe(function(){if(typeof e=="function"){var a=e(t());return function(){e(null),a&&typeof a=="function"&&a()}}if(e)return e.current=t(),function(){return e.current=null}},n==null?n:n.concat(e))}function K(e,t){var n=Se(ce++,7);return Lt(n.__H,t)&&(n.__=e(),n.__H=t,n.__h=e),n.__}function Te(e,t){return Ne=8,K(function(){return e},t)}function On(e){var t=U.context[e.__c],n=Se(ce++,9);return n.c=e,t?(n.__==null&&(n.__=!0,t.sub(U)),t.props.value):e.__}function In(e,t){J.useDebugValue&&J.useDebugValue(t?t(e):e)}function Dn(){var e=Se(ce++,11);if(!e.__){for(var t=U.__v;t!==null&&!t.__m&&t.__!==null;)t=t.__;var n=t.__m||(t.__m=[0,0]);e.__="P"+n[0]+"-"+n[1]++}return e.__}function xr(){for(var e;e=$n.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(ze),e.__H.__h.forEach(gt),e.__H.__h=[]}catch(t){e.__H.__h=[],J.__e(t,e.__v)}}J.__b=function(e){U=null,Jt&&Jt(e)},J.__=function(e,t){e&&t.__k&&t.__k.__m&&(e.__m=t.__k.__m),Ht&&Ht(e,t)},J.__r=function(e){Rt&&Rt(e),ce=0;var t=(U=e.__c).__H;t&&(st===U?(t.__h=[],U.__h=[],t.__.forEach(function(n){n.__N&&(n.__=n.__N),n.u=n.__N=void 0})):(t.__h.forEach(ze),t.__h.forEach(gt),t.__h=[],ce=0)),st=U},J.diffed=function(e){Wt&&Wt(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&($n.push(t)!==1&&Ut===J.requestAnimationFrame||((Ut=J.requestAnimationFrame)||Nr)(xr)),t.__H.__.forEach(function(n){n.u&&(n.__H=n.u),n.u=void 0})),st=U=null},J.__c=function(e,t){t.some(function(n){try{n.__h.forEach(ze),n.__h=n.__h.filter(function(a){return!a.__||gt(a)})}catch(a){t.some(function(l){l.__h&&(l.__h=[])}),t=[],J.__e(a,n.__v)}}),Vt&&Vt(e,t)},J.unmount=function(e){zt&&zt(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach(function(a){try{ze(a)}catch(l){t=l}}),n.__H=void 0,t&&J.__e(t,n.__v))};var qt=typeof requestAnimationFrame=="function";function Nr(e){var t,n=function(){clearTimeout(a),qt&&cancelAnimationFrame(t),setTimeout(e)},a=setTimeout(n,35);qt&&(t=requestAnimationFrame(n))}function ze(e){var t=U,n=e.__c;typeof n=="function"&&(e.__c=void 0,n()),U=t}function gt(e){var t=U;e.__c=e.__(),U=t}function Lt(e,t){return!e||e.length!==t.length||t.some(function(n,a){return n!==e[a]})}function En(e,t){return typeof t=="function"?t(e):t}var wr=Symbol.for("preact-signals");function Ot(){if(_e>1)_e--;else{for(var e,t=!1;Ee!==void 0;){var n=Ee;for(Ee=void 0,_t++;n!==void 0;){var a=n.o;if(n.o=void 0,n.f&=-3,!(8&n.f)&&Tn(n))try{n.c()}catch(l){t||(e=l,t=!0)}n=a}}if(_t=0,_e--,t)throw e}}var M=void 0;function kn(e){var t=M;M=void 0;try{return e()}finally{M=t}}var Ee=void 0,_e=0,_t=0,Ge=0;function Fn(e){if(M!==void 0){var t=e.n;if(t===void 0||t.t!==M)return t={i:0,S:e,p:M.s,n:void 0,t:M,e:void 0,x:void 0,r:t},M.s!==void 0&&(M.s.n=t),M.s=t,e.n=t,32&M.f&&e.S(t),t;if(t.i===-1)return t.i=0,t.n!==void 0&&(t.n.p=t.p,t.p!==void 0&&(t.p.n=t.n),t.p=M.s,t.n=void 0,M.s.n=t,M.s=t),t}}function q(e,t){this.v=e,this.i=0,this.n=void 0,this.t=void 0,this.W=t?.watched,this.Z=t?.unwatched}q.prototype.brand=wr;q.prototype.h=function(){return!0};q.prototype.S=function(e){var t=this,n=this.t;n!==e&&e.e===void 0&&(e.x=n,this.t=e,n!==void 0?n.e=e:kn(function(){var a;(a=t.W)==null||a.call(t)}))};q.prototype.U=function(e){var t=this;if(this.t!==void 0){var n=e.e,a=e.x;n!==void 0&&(n.x=a,e.e=void 0),a!==void 0&&(a.e=n,e.x=void 0),e===this.t&&(this.t=a,a===void 0&&kn(function(){var l;(l=t.Z)==null||l.call(t)}))}};q.prototype.subscribe=function(e){var t=this;return Dt(function(){var n=t.value,a=M;M=void 0;try{e(n)}finally{M=a}})};q.prototype.valueOf=function(){return this.value};q.prototype.toString=function(){return this.value+""};q.prototype.toJSON=function(){return this.value};q.prototype.peek=function(){var e=M;M=void 0;try{return this.value}finally{M=e}};Object.defineProperty(q.prototype,"value",{get:function(){var e=Fn(this);return e!==void 0&&(e.i=this.i),this.v},set:function(e){if(e!==this.v){if(_t>100)throw new Error("Cycle detected");this.v=e,this.i++,Ge++,_e++;try{for(var t=this.t;t!==void 0;t=t.x)t.t.N()}finally{Ot()}}}});function Q(e,t){return new q(e,t)}function Tn(e){for(var t=e.s;t!==void 0;t=t.n)if(t.S.i!==t.i||!t.S.h()||t.S.i!==t.i)return!0;return!1}function Mn(e){for(var t=e.s;t!==void 0;t=t.n){var n=t.S.n;if(n!==void 0&&(t.r=n),t.S.n=t,t.i=-1,t.n===void 0){e.s=t;break}}}function jn(e){for(var t=e.s,n=void 0;t!==void 0;){var a=t.p;t.i===-1?(t.S.U(t),a!==void 0&&(a.n=t.n),t.n!==void 0&&(t.n.p=a)):n=t,t.S.n=t.r,t.r!==void 0&&(t.r=void 0),t=a}e.s=n}function me(e,t){q.call(this,void 0),this.x=e,this.s=void 0,this.g=Ge-1,this.f=4,this.W=t?.watched,this.Z=t?.unwatched}me.prototype=new q;me.prototype.h=function(){if(this.f&=-3,1&this.f)return!1;if((36&this.f)==32||(this.f&=-5,this.g===Ge))return!0;if(this.g=Ge,this.f|=1,this.i>0&&!Tn(this))return this.f&=-2,!0;var e=M;try{Mn(this),M=this;var t=this.x();(16&this.f||this.v!==t||this.i===0)&&(this.v=t,this.f&=-17,this.i++)}catch(n){this.v=n,this.f|=16,this.i++}return M=e,jn(this),this.f&=-2,!0};me.prototype.S=function(e){if(this.t===void 0){this.f|=36;for(var t=this.s;t!==void 0;t=t.n)t.S.S(t)}q.prototype.S.call(this,e)};me.prototype.U=function(e){if(this.t!==void 0&&(q.prototype.U.call(this,e),this.t===void 0)){this.f&=-33;for(var t=this.s;t!==void 0;t=t.n)t.S.U(t)}};me.prototype.N=function(){if(!(2&this.f)){this.f|=6;for(var e=this.t;e!==void 0;e=e.x)e.t.N()}};Object.defineProperty(me.prototype,"value",{get:function(){if(1&this.f)throw new Error("Cycle detected");var e=Fn(this);if(this.h(),e!==void 0&&(e.i=this.i),16&this.f)throw this.v;return this.v}});function ue(e,t){return new me(e,t)}function An(e){var t=e.u;if(e.u=void 0,typeof t=="function"){_e++;var n=M;M=void 0;try{t()}catch(a){throw e.f&=-2,e.f|=8,It(e),a}finally{M=n,Ot()}}}function It(e){for(var t=e.s;t!==void 0;t=t.n)t.S.U(t);e.x=void 0,e.s=void 0,An(e)}function Sr(e){if(M!==this)throw new Error("Out-of-order effect");jn(this),M=e,this.f&=-2,8&this.f&&It(this),Ot()}function Ce(e){this.x=e,this.u=void 0,this.s=void 0,this.o=void 0,this.f=32}Ce.prototype.c=function(){var e=this.S();try{if(8&this.f||this.x===void 0)return;var t=this.x();typeof t=="function"&&(this.u=t)}finally{e()}};Ce.prototype.S=function(){if(1&this.f)throw new Error("Cycle detected");this.f|=1,this.f&=-9,An(this),Mn(this),_e++;var e=M;return M=this,Sr.bind(this,e)};Ce.prototype.N=function(){2&this.f||(this.f|=2,this.o=Ee,Ee=this)};Ce.prototype.d=function(){this.f|=8,1&this.f||It(this)};Ce.prototype.dispose=function(){this.d()};function Dt(e){var t=new Ce(e);try{t.c()}catch(a){throw t.d(),a}var n=t.d.bind(t);return n[Symbol.dispose]=n,n}var Qe,it;function $e(e,t){k[e]=t.bind(null,k[e]||function(){})}function Ye(e){it&&it(),it=e&&e.S()}function Pn(e){var t=this,n=e.data,a=W(n);a.value=n;var l=K(function(){for(var s=t.__v;s=s.__;)if(s.__c){s.__c.__$f|=4;break}return t.__$u.c=function(){var i,o=t.__$u.S(),u=l.value;o(),pn(u)||((i=t.base)==null?void 0:i.nodeType)!==3?(t.__$f|=1,t.setState({})):t.base.data=u},ue(function(){var i=a.value.value;return i===0?0:i===!0?"":i||""})},[]);return l.value}Pn.displayName="_st";Object.defineProperties(q.prototype,{constructor:{configurable:!0,value:void 0},type:{configurable:!0,value:Pn},props:{configurable:!0,get:function(){return{data:this}}},__b:{configurable:!0,value:1}});$e("__b",function(e,t){if(typeof t.type=="string"){var n,a=t.props;for(var l in a)if(l!=="children"){var s=a[l];s instanceof q&&(n||(t.__np=n={}),n[l]=s,a[l]=s.peek())}}e(t)});$e("__r",function(e,t){Ye();var n,a=t.__c;a&&(a.__$f&=-2,(n=a.__$u)===void 0&&(a.__$u=n=function(l){var s;return Dt(function(){s=this}),s.c=function(){a.__$f|=1,a.setState({})},s}())),Qe=a,Ye(n),e(t)});$e("__e",function(e,t,n,a){Ye(),Qe=void 0,e(t,n,a)});$e("diffed",function(e,t){Ye(),Qe=void 0;var n;if(typeof t.type=="string"&&(n=t.__e)){var a=t.__np,l=t.props;if(a){var s=n.U;if(s)for(var i in s){var o=s[i];o!==void 0&&!(i in a)&&(o.d(),s[i]=void 0)}else n.U=s={};for(var u in a){var c=s[u],f=a[u];c===void 0?(c=Cr(n,u,f,l),s[u]=c):c.o(f,l)}}}e(t)});function Cr(e,t,n,a){var l=t in e&&e.ownerSVGElement===void 0,s=Q(n);return{o:function(i,o){s.value=i,a=o},d:Dt(function(){var i=s.value.value;a[t]!==i&&(a[t]=i,l?e[t]=i:i?e.setAttribute(t,i):e.removeAttribute(t))})}}$e("unmount",function(e,t){if(typeof t.type=="string"){var n=t.__e;if(n){var a=n.U;if(a){n.U=void 0;for(var l in a){var s=a[l];s&&s.d()}}}}else{var i=t.__c;if(i){var o=i.__$u;o&&(i.__$u=void 0,o.d())}}e(t)});$e("__h",function(e,t,n,a){(a<3||a===9)&&(t.__$f|=2),e(t,n,a)});X.prototype.shouldComponentUpdate=function(e,t){var n=this.__$u,a=n&&n.s!==void 0;for(var l in t)return!0;if(this.__f||typeof this.u=="boolean"&&this.u===!0){if(!(a||2&this.__$f||4&this.__$f)||1&this.__$f)return!0}else if(!(a||4&this.__$f)||3&this.__$f)return!0;for(var s in e)if(s!=="__source"&&e[s]!==this.props[s])return!0;for(var i in this.props)if(!(i in e))return!0;return!1};function W(e){return K(function(){return Q(e)},[])}function D(e){var t=R(e);return t.current=e,Qe.__$f|=4,K(function(){return ue(function(){return t.current()})},[])}const $r=e=>{try{return[JSON.parse(e),null]}catch(t){return[null,t instanceof Error?t.message:"Parse error"]}},Xe=e=>{const t=new Set,n=l=>{l&&typeof l=="string"&&t.add(l)},a=l=>{for(const s of l||[]){s.id&&n(s.id);for(const i of s.items||[])i.id&&n(i.id),i.legendDescription&&n(i.legendDescription)}};return a(e.weatherFeatures),a(e.features),t},Et=e=>{const t=new Set,n=a=>{for(const l of a||[])for(const s of l.items||[])for(const i of s.layersIds||[])t.add(i)};return n(e.weatherFeatures),n(e.features),t},Lr=(e,t)=>{const n=[],a=(l,s)=>{l.forEach((i,o)=>{(i.items||[]).forEach((u,c)=>{(u.layersIds||[]).includes(t)&&n.push({featureType:s,featureIndex:o,featureName:i.name||i.id||`${s} ${o+1}`,itemIndex:c,itemName:u.name||u.id||`Item ${c+1}`})})})};return a(e.weatherFeatures,"weatherFeatures"),a(e.features,"features"),n},Or=(e,t,n="application/json")=>{const a=new Blob([t],{type:n}),l=URL.createObjectURL(a),s=document.createElement("a");s.href=l,s.download=e,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(l)},kt=()=>({weatherFeatures:[],features:[],layers:[],intl:{en:{},da:{},nb:{},sv:{}}}),yt=e=>{if(!e||typeof e!="object")return kt();if(e.map_layers&&typeof e.map_layers=="object"){const t=e.map_layers;return{weatherFeatures:t.weatherFeatures||[],features:t.features||[],layers:t.layers||[],intl:t.intl||{en:{},da:{},nb:{},sv:{}}}}return{weatherFeatures:e.weatherFeatures||[],features:e.features||[],layers:e.layers||[],intl:e.intl||{en:{},da:{},nb:{},sv:{}}}},Un="hemswx-map-editor-settings",Ir={customLogicLayers:new Set(["aviation_obstacle"])},Dr=()=>{try{const e=localStorage.getItem(Un);if(e){const t=JSON.parse(e);return{customLogicLayers:new Set(t.customLogicLayers||["aviation_obstacle"])}}}catch(e){console.warn("Failed to load settings:",e)}return{...Ir,customLogicLayers:new Set(["aviation_obstacle"])}},Jn=e=>{try{const t={customLogicLayers:Array.from(e.customLogicLayers)};localStorage.setItem(Un,JSON.stringify(t))}catch(t){console.warn("Failed to save settings:",t)}},ne=Q(Dr());ue(()=>ne.value.customLogicLayers);const Er=e=>{const t=new Set(ne.value.customLogicLayers);t.add(e);const n={...ne.value,customLogicLayers:t};ne.value=n,Jn(n)},kr=e=>{const t=new Set(ne.value.customLogicLayers);t.delete(e);const n={...ne.value,customLogicLayers:t};ne.value=n,Jn(n)},we=e=>ne.value.customLogicLayers.has(e),Fr=e=>{we(e)?kr(e):Er(e)},Tr=e=>{const[t,n]=$r(e);if(n)return{valid:!1,errors:[`JSON Parse Error: ${n}`],warnings:[]};const a=[],l=[];if(!t||typeof t!="object")return a.push("Root must be an object"),{valid:!1,errors:a,warnings:l};const s=["weatherFeatures","features","layers"];for(const o of s)Array.isArray(t[o])||a.push(`Missing or invalid '${o}' array`);if(!t.intl||typeof t.intl!="object")a.push("Missing or invalid 'intl' object");else{const o=["en","da","nb","sv"];for(const u of o)(!t.intl[u]||typeof t.intl[u]!="object")&&l.push(`Missing or invalid '${u}' translations`)}[...t.weatherFeatures||[],...t.features||[]].forEach((o,u)=>{const c=u<(t.weatherFeatures?.length||0)?"weatherFeature":"feature",f=u<(t.weatherFeatures?.length||0)?u:u-(t.weatherFeatures?.length||0);(!o.presentation||!["single","multiple"].includes(o.presentation))&&a.push(`${c} ${f+1}: presentation field is required and must be "single" or "multiple"`),!o.items||!Array.isArray(o.items)?a.push(`${c} ${f+1}: items field is required and must be an array`):o.items.forEach((d,m)=>{(!d.id||typeof d.id!="string"||d.id.trim()==="")&&a.push(`${c} ${f+1}, item ${m+1}: id is required and cannot be empty`),(!d.name||typeof d.name!="string"||d.name.trim()==="")&&a.push(`${c} ${f+1}, item ${m+1}: name is required and cannot be empty`),(!d.layersIds||!Array.isArray(d.layersIds)||d.layersIds.length===0)&&a.push(`${c} ${f+1}, item ${m+1}: layersIds is required and must be a non-empty array`)})}),t.layers&&Array.isArray(t.layers)&&t.layers.forEach((o,u)=>{(!o.id||typeof o.id!="string"||o.id.trim()==="")&&a.push(`layer ${u+1}: id is required and cannot be empty`),!o.layers||!Array.isArray(o.layers)||o.layers.length===0?a.push(`layer ${u+1}: layers field is required and must be a non-empty array`):o.layers.forEach((c,f)=>{(!c.type||typeof c.type!="string")&&a.push(`layer ${u+1}, sublayer ${f+1}: type is required`),(!c.source||typeof c.source!="string"||c.source.trim()==="")&&a.push(`layer ${u+1}, sublayer ${f+1}: source is required and cannot be empty`)})});try{const o=Et(t),u=new Set((t.layers||[]).map(f=>f.id).filter(Boolean)),c=[...o].filter(f=>!u.has(f));c.length>0&&l.push(`Missing layer definitions: ${c.join(", ")}`)}catch{l.push("Could not validate layer references")}return{valid:a.length===0,errors:a,warnings:l}},Rn=e=>{try{const t=Et(e),n=new Set((e.layers||[]).map(f=>f.id)),a=ne.value.customLogicLayers,l=new Set([...t,...a]),s=[...t].filter(f=>!n.has(f)),i=[...n].filter(f=>!l.has(f)),o=Xe(e),u=Object.keys(e.intl||{}),c={};for(const f of u){const d=e.intl[f]||{};c[f]=[...o].filter(m=>!(m in d))}return{missingLayers:s,unusedLayers:i,missingIntl:c,weatherFeatureCount:e.weatherFeatures?.length||0,featureCount:e.features?.length||0,layerCount:e.layers?.length||0,languageCount:u.length}}catch(t){return console.warn("Error computing stats:",t),{missingLayers:[],unusedLayers:[],missingIntl:{},weatherFeatureCount:0,featureCount:0,layerCount:0,languageCount:0}}},Mr=e=>{const t=Rn(e);return`WF: ${t.weatherFeatureCount} • F: ${t.featureCount} • Layers: ${t.layerCount} • Langs: ${t.languageCount}`},T=["en","da","nb","sv"],jr=(e,t)=>{const n={...e};n.intl||(n.intl={en:{},da:{},nb:{},sv:{}});const a=[];return t.id?.trim()&&a.push({key:t.id,defaultValue:t.name?.trim()||t.id}),(t.items||[]).forEach(l=>{l.id?.trim()&&a.push({key:l.id,defaultValue:l.name?.trim()||l.id}),l.legendDescription?.trim()&&a.push({key:l.legendDescription,defaultValue:l.legendDescription})}),T.forEach(l=>{n.intl[l]||(n.intl[l]={}),a.forEach(({key:s,defaultValue:i})=>{n.intl[l][s]||(l==="en"?n.intl[l][s]=i:n.intl[l][s]=n.intl.en[s]||i)})}),n},Ar=e=>{const t={...e},n=t.intl?.en||{},a={},l=(o,u)=>{!a[o]&&u&&(a[o]=u)},s=o=>{for(const u of o||[]){u.id&&u.name&&l(u.id,u.name);for(const c of u.items||[])c.id&&c.name&&l(c.id,c.name),c.legendDescription&&l(c.legendDescription,n[c.legendDescription]||c.legendDescription)}};s(t.weatherFeatures),s(t.features);const i=new Set([...Xe(t)]);return t.intl||(t.intl={en:{},da:{},nb:{},sv:{}}),T.forEach(o=>{const u=t.intl[o]||{},c={};i.forEach(f=>{u[f]?c[f]=u[f]:o==="en"&&a[f]?c[f]=a[f]:n[f]?c[f]=n[f]:c[f]=f}),t.intl[o]=c}),t},Pr=["wms","tiled","mapImage","portalItem","vectorTiled","feature"],Ur=e=>{const t={type:e,source:"",zIndex:0,options:{opacity:1}};switch(e){case"wms":return{...t,source:"https://example.com/wms",options:{layerNames:["layer1"],opacity:1}};case"tiled":return{...t,source:"https://example.com/tiles/{z}/{y}/{x}.png"};case"vectorTiled":return{...t,source:"https://example.com/vectortiles/{z}/{y}/{x}.pbf"};case"mapImage":return{...t,source:"https://example.com/arcgis/rest/services/MapServer"};case"feature":return{...t,source:"https://example.com/arcgis/rest/services/FeatureServer/0"};case"portalItem":return{...t,source:"portal-item-id",options:{layerId:0,opacity:1}};default:return t}},Jr=(e,t)=>{const n={...e},a=n.layers.findIndex(l=>l.id===t.id);return a>=0?(n.layers=[...n.layers],n.layers[a]=t):n.layers=[...n.layers,t],n},E=Q(kt()),Le=Q(!1),Z=Q({type:null,index:-1}),le=Q({index:-1}),H=Q({}),pe=Q({weatherFeatures:{},features:{}}),de=Q("features"),Wn=Q("json");Q("en");ue(()=>JSON.stringify(E.value,null,2));const Rr=ue(()=>Rn(E.value)),Wr=ue(()=>Mr(E.value)),Vr=ue(()=>{const e=Z.value;return e.type===null||e.index<0?null:E.value[e.type][e.index]||null}),zr=ue(()=>{const e=le.value;return e.index<0?null:E.value.layers[e.index]||null}),z=e=>{E.value=e,Le.value=!0;try{localStorage.setItem("hemswx-last-json-data",JSON.stringify(e))}catch(a){console.warn("Failed to save JSON data to localStorage:",a)}const t=Z.value;if(t.type&&t.index>=0){const a=e[t.type];t.index>=a.length&&(Z.value={type:null,index:-1})}const n=le.value;n.index>=0&&n.index>=e.layers.length&&(le.value={index:-1})},Hr=()=>{try{const e=localStorage.getItem("hemswx-last-json-data");if(e){const t=JSON.parse(e);return z(t),te("✅ Last session data loaded"),!0}}catch(e){console.warn("Failed to load JSON data from localStorage:",e)}return!1},te=e=>{},Vn=(e,t)=>{Z.value={type:e,index:t},Wn.value="feature"},He=e=>{le.value={index:e},Wn.value="layer"},qr=e=>H.value[e],re=(e,t)=>{H.value={...H.value,[e]:t}},Re=e=>{const t={...H.value};delete t[e],H.value=t},Kr=(e,t)=>pe.value[e][t],ot=(e,t,n)=>{pe.value={...pe.value,[e]:{...pe.value[e],[t]:n}}},Kt=(e,t)=>{const n={...pe.value[e]};delete n[t],pe.value={...pe.value,[e]:n}},zn=()=>{const e=Ar(E.value);z(e)},Br=(e,t)=>{const n={...E.value};n[e]=n[e].filter((l,s)=>s!==t),z(n);const a=Z.value;a.type===e&&a.index===t?Z.value={type:null,index:-1}:a.type===e&&a.index>t&&(Z.value={...a,index:a.index-1})},Gr=(e,t,n)=>{if(e===n)return;const a=JSON.parse(JSON.stringify(E.value)),[l]=a[e].splice(t,1);a[n].push(l),z(a);const s=a[n].length-1;Z.value={type:n,index:s}},qe=(e,t,n,a)=>{const l=[...E.value[e]],s=e===n?l:[...E.value[n]];if(t<0||t>=l.length||a<0||a>s.length)return;const[i]=l.splice(t,1),o=e===n&&t<a?a-1:a;s.splice(o,0,i);const u={...E.value,[e]:e===n?s:l,[n]:s};z(u),Z.value={type:n,index:o}},Hn=e=>{const t={...E.value};t.layers=t.layers.filter((a,l)=>l!==e),z(t);const n=le.value;n.index===e?le.value={index:-1}:n.index>e&&(le.value={index:n.index-1})};function Yr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Bt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function Gt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Bt(Object(n),!0).forEach(function(a){Yr(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Bt(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function Zr(e,t){if(e==null)return{};var n={},a=Object.keys(e),l,s;for(s=0;s<a.length;s++)l=a[s],!(t.indexOf(l)>=0)&&(n[l]=e[l]);return n}function Qr(e,t){if(e==null)return{};var n=Zr(e,t),a,l;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(l=0;l<s.length;l++)a=s[l],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function Xr(e,t){return ea(e)||ta(e,t)||na(e,t)||ra()}function ea(e){if(Array.isArray(e))return e}function ta(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var n=[],a=!0,l=!1,s=void 0;try{for(var i=e[Symbol.iterator](),o;!(a=(o=i.next()).done)&&(n.push(o.value),!(t&&n.length===t));a=!0);}catch(u){l=!0,s=u}finally{try{!a&&i.return!=null&&i.return()}finally{if(l)throw s}}return n}}function na(e,t){if(e){if(typeof e=="string")return Yt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Yt(e,t)}}function Yt(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function ra(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aa(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Zt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function Qt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Zt(Object(n),!0).forEach(function(a){aa(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Zt(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function la(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(a){return t.reduceRight(function(l,s){return s(l)},a)}}function Oe(e){return function t(){for(var n=this,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return l.length>=e.length?e.apply(this,l):function(){for(var i=arguments.length,o=new Array(i),u=0;u<i;u++)o[u]=arguments[u];return t.apply(n,[].concat(l,o))}}}function Ze(e){return{}.toString.call(e).includes("Object")}function sa(e){return!Object.keys(e).length}function Me(e){return typeof e=="function"}function ia(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function oa(e,t){return Ze(t)||oe("changeType"),Object.keys(t).some(function(n){return!ia(e,n)})&&oe("changeField"),t}function ca(e){Me(e)||oe("selectorType")}function ua(e){Me(e)||Ze(e)||oe("handlerType"),Ze(e)&&Object.values(e).some(function(t){return!Me(t)})&&oe("handlersType")}function da(e){e||oe("initialIsRequired"),Ze(e)||oe("initialType"),sa(e)&&oe("initialContent")}function fa(e,t){throw new Error(e[t]||e.default)}var pa={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},oe=Oe(fa)(pa),We={changes:oa,selector:ca,handler:ua,initial:da};function ha(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};We.initial(e),We.handler(t);var n={current:e},a=Oe(ga)(n,t),l=Oe(va)(n),s=Oe(We.changes)(e),i=Oe(ma)(n);function o(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(f){return f};return We.selector(c),c(n.current)}function u(c){la(a,l,s,i)(c)}return[o,u]}function ma(e,t){return Me(t)?t(e.current):t}function va(e,t){return e.current=Qt(Qt({},e.current),t),t}function ga(e,t,n){return Me(t)?t(e.current):Object.keys(n).forEach(function(a){var l;return(l=t[a])===null||l===void 0?void 0:l.call(t,e.current[a])}),n}var _a={create:ha},ya={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.52.2/min/vs"}};function ba(e){return function t(){for(var n=this,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return l.length>=e.length?e.apply(this,l):function(){for(var i=arguments.length,o=new Array(i),u=0;u<i;u++)o[u]=arguments[u];return t.apply(n,[].concat(l,o))}}}function xa(e){return{}.toString.call(e).includes("Object")}function Na(e){return e||Xt("configIsRequired"),xa(e)||Xt("configType"),e.urls?(wa(),{paths:{vs:e.urls.monacoBase}}):e}function wa(){console.warn(qn.deprecation)}function Sa(e,t){throw new Error(e[t]||e.default)}var qn={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},Xt=ba(Sa)(qn),Ca={config:Na},$a=function(){for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return function(l){return n.reduceRight(function(s,i){return i(s)},l)}};function Kn(e,t){return Object.keys(t).forEach(function(n){t[n]instanceof Object&&e[n]&&Object.assign(t[n],Kn(e[n],t[n]))}),Gt(Gt({},e),t)}var La={type:"cancelation",msg:"operation is manually canceled"};function ct(e){var t=!1,n=new Promise(function(a,l){e.then(function(s){return t?l(La):a(s)}),e.catch(l)});return n.cancel=function(){return t=!0},n}var Oa=_a.create({config:ya,isInitialized:!1,resolve:null,reject:null,monaco:null}),Bn=Xr(Oa,2),Ue=Bn[0],et=Bn[1];function Ia(e){var t=Ca.config(e),n=t.monaco,a=Qr(t,["monaco"]);et(function(l){return{config:Kn(l.config,a),monaco:n}})}function Da(){var e=Ue(function(t){var n=t.monaco,a=t.isInitialized,l=t.resolve;return{monaco:n,isInitialized:a,resolve:l}});if(!e.isInitialized){if(et({isInitialized:!0}),e.monaco)return e.resolve(e.monaco),ct(ut);if(window.monaco&&window.monaco.editor)return Gn(window.monaco),e.resolve(window.monaco),ct(ut);$a(Ea,Fa)(Ta)}return ct(ut)}function Ea(e){return document.body.appendChild(e)}function ka(e){var t=document.createElement("script");return e&&(t.src=e),t}function Fa(e){var t=Ue(function(a){var l=a.config,s=a.reject;return{config:l,reject:s}}),n=ka("".concat(t.config.paths.vs,"/loader.js"));return n.onload=function(){return e()},n.onerror=t.reject,n}function Ta(){var e=Ue(function(n){var a=n.config,l=n.resolve,s=n.reject;return{config:a,resolve:l,reject:s}}),t=window.require;t.config(e.config),t(["vs/editor/editor.main"],function(n){Gn(n),e.resolve(n)},function(n){e.reject(n)})}function Gn(e){Ue().monaco||et({monaco:e})}function Ma(){return Ue(function(e){var t=e.monaco;return t})}var ut=new Promise(function(e,t){return et({resolve:e,reject:t})}),Yn={config:Ia,init:Da,__getMonacoInstance:Ma};function Zn(e,t){for(var n in t)e[n]=t[n];return e}function bt(e,t){for(var n in e)if(n!=="__source"&&!(n in t))return!0;for(var a in t)if(a!=="__source"&&e[a]!==t[a])return!0;return!1}function Qn(e,t){var n=t(),a=he({t:{__:n,u:t}}),l=a[0].t,s=a[1];return Pe(function(){l.__=n,l.u=t,dt(l)&&s({t:l})},[e,n,t]),Y(function(){return dt(l)&&s({t:l}),e(function(){dt(l)&&s({t:l})})},[e]),n}function dt(e){var t,n,a=e.u,l=e.__;try{var s=a();return!((t=l)===(n=s)&&(t!==0||1/t==1/n)||t!=t&&n!=n)}catch{return!0}}function Xn(e){e()}function er(e){return e}function tr(){return[!1,Xn]}var nr=Pe;function xt(e,t){this.props=e,this.context=t}function tt(e,t){function n(l){var s=this.props.ref,i=s==l.ref;return!i&&s&&(s.call?s(null):s.current=null),t?!t(this.props,l)||!i:bt(this.props,l)}function a(l){return this.shouldComponentUpdate=n,se(e,l)}return a.displayName="Memo("+(e.displayName||e.name)+")",a.prototype.isReactComponent=!0,a.__f=!0,a}(xt.prototype=new X).isPureReactComponent=!0,xt.prototype.shouldComponentUpdate=function(e,t){return bt(this.props,e)||bt(this.state,t)};var en=k.__b;k.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),en&&en(e)};var ja=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function Aa(e){function t(n){var a=Zn({},n);return delete a.ref,e(a,n.ref||null)}return t.$$typeof=ja,t.render=t,t.prototype.isReactComponent=t.__f=!0,t.displayName="ForwardRef("+(e.displayName||e.name)+")",t}var tn=function(e,t){return e==null?null:ae(ae(e).map(t))},Pa={map:tn,forEach:tn,count:function(e){return e?ae(e).length:0},only:function(e){var t=ae(e);if(t.length!==1)throw"Children.only";return t[0]},toArray:ae},Ua=k.__e;k.__e=function(e,t,n,a){if(e.then){for(var l,s=t;s=s.__;)if((l=s.__c)&&l.__c)return t.__e==null&&(t.__e=n.__e,t.__k=n.__k),l.__c(e,t)}Ua(e,t,n,a)};var nn=k.unmount;function rr(e,t,n){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach(function(a){typeof a.__c=="function"&&a.__c()}),e.__c.__H=null),(e=Zn({},e)).__c!=null&&(e.__c.__P===n&&(e.__c.__P=t),e.__c.__e=!0,e.__c=null),e.__k=e.__k&&e.__k.map(function(a){return rr(a,t,n)})),e}function ar(e,t,n){return e&&n&&(e.__v=null,e.__k=e.__k&&e.__k.map(function(a){return ar(a,t,n)}),e.__c&&e.__c.__P===t&&(e.__e&&n.appendChild(e.__e),e.__c.__e=!0,e.__c.__P=n)),e}function Ke(){this.__u=0,this.o=null,this.__b=null}function lr(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function Ja(e){var t,n,a;function l(s){if(t||(t=e()).then(function(i){n=i.default||i},function(i){a=i}),a)throw a;if(!n)throw t;return se(n,s)}return l.displayName="Lazy",l.__f=!0,l}function Ie(){this.i=null,this.l=null}k.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&32&e.__u&&(e.type=null),nn&&nn(e)},(Ke.prototype=new X).__c=function(e,t){var n=t.__c,a=this;a.o==null&&(a.o=[]),a.o.push(n);var l=lr(a.__v),s=!1,i=function(){s||(s=!0,n.__R=null,l?l(o):o())};n.__R=i;var o=function(){if(!--a.__u){if(a.state.__a){var u=a.state.__a;a.__v.__k[0]=ar(u,u.__c.__P,u.__c.__O)}var c;for(a.setState({__a:a.__b=null});c=a.o.pop();)c.forceUpdate()}};a.__u++||32&t.__u||a.setState({__a:a.__b=a.__v.__k[0]}),e.then(i,i)},Ke.prototype.componentWillUnmount=function(){this.o=[]},Ke.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),a=this.__v.__k[0].__c;this.__v.__k[0]=rr(this.__b,n,a.__O=a.__P)}this.__b=null}var l=t.__a&&se(V,null,e.fallback);return l&&(l.__u&=-33),[se(V,null,t.__a?null:e.children),l]};var rn=function(e,t,n){if(++n[1]===n[0]&&e.l.delete(t),e.props.revealOrder&&(e.props.revealOrder[0]!=="t"||!e.l.size))for(n=e.i;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.i=n=n[2]}};function Ra(e){return this.getChildContext=function(){return e.context},e.children}function Wa(e){var t=this,n=e.h;if(t.componentWillUnmount=function(){xe(null,t.v),t.v=null,t.h=null},t.h&&t.h!==n&&t.componentWillUnmount(),!t.v){for(var a=t.__v;a!==null&&!a.__m&&a.__!==null;)a=a.__;t.h=n,t.v={nodeType:1,parentNode:n,childNodes:[],__k:{__m:a.__m},contains:function(){return!0},insertBefore:function(l,s){this.childNodes.push(l),t.h.insertBefore(l,s)},removeChild:function(l){this.childNodes.splice(this.childNodes.indexOf(l)>>>1,1),t.h.removeChild(l)}}}xe(se(Ra,{context:t.context},e.__v),t.v)}function Va(e,t){var n=se(Wa,{__v:e,h:t});return n.containerInfo=t,n}(Ie.prototype=new X).__a=function(e){var t=this,n=lr(t.__v),a=t.l.get(e);return a[0]++,function(l){var s=function(){t.props.revealOrder?(a.push(l),rn(t,e,a)):l()};n?n(s):s()}},Ie.prototype.render=function(e){this.i=null,this.l=new Map;var t=ae(e.children);e.revealOrder&&e.revealOrder[0]==="b"&&t.reverse();for(var n=t.length;n--;)this.l.set(t[n],this.i=[1,0,this.i]);return e.children},Ie.prototype.componentDidUpdate=Ie.prototype.componentDidMount=function(){var e=this;this.l.forEach(function(t,n){rn(e,n,t)})};var sr=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,za=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,Ha=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,qa=/[A-Z0-9]/g,Ka=typeof document<"u",Ba=function(e){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/:/fil|che|ra/).test(e)};function Ga(e,t,n){return t.__k==null&&(t.textContent=""),xe(e,t),typeof n=="function"&&n(),e?e.__c:null}function Ya(e,t,n){return Cn(e,t),typeof n=="function"&&n(),e?e.__c:null}X.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(e){Object.defineProperty(X.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})});var an=k.event;function Za(){}function Qa(){return this.cancelBubble}function Xa(){return this.defaultPrevented}k.event=function(e){return an&&(e=an(e)),e.persist=Za,e.isPropagationStopped=Qa,e.isDefaultPrevented=Xa,e.nativeEvent=e};var Ft,el={enumerable:!1,configurable:!0,get:function(){return this.class}},ln=k.vnode;k.vnode=function(e){typeof e.type=="string"&&function(t){var n=t.props,a=t.type,l={},s=a.indexOf("-")===-1;for(var i in n){var o=n[i];if(!(i==="value"&&"defaultValue"in n&&o==null||Ka&&i==="children"&&a==="noscript"||i==="class"||i==="className")){var u=i.toLowerCase();i==="defaultValue"&&"value"in n&&n.value==null?i="value":i==="download"&&o===!0?o="":u==="translate"&&o==="no"?o=!1:u[0]==="o"&&u[1]==="n"?u==="ondoubleclick"?i="ondblclick":u!=="onchange"||a!=="input"&&a!=="textarea"||Ba(n.type)?u==="onfocus"?i="onfocusin":u==="onblur"?i="onfocusout":Ha.test(i)&&(i=u):u=i="oninput":s&&za.test(i)?i=i.replace(qa,"-$&").toLowerCase():o===null&&(o=void 0),u==="oninput"&&l[i=u]&&(i="oninputCapture"),l[i]=o}}a=="select"&&l.multiple&&Array.isArray(l.value)&&(l.value=ae(n.children).forEach(function(c){c.props.selected=l.value.indexOf(c.props.value)!=-1})),a=="select"&&l.defaultValue!=null&&(l.value=ae(n.children).forEach(function(c){c.props.selected=l.multiple?l.defaultValue.indexOf(c.props.value)!=-1:l.defaultValue==c.props.value})),n.class&&!n.className?(l.class=n.class,Object.defineProperty(l,"className",el)):(n.className&&!n.class||n.class&&n.className)&&(l.class=l.className=n.className),t.props=l}(e),e.$$typeof=sr,ln&&ln(e)};var sn=k.__r;k.__r=function(e){sn&&sn(e),Ft=e.__c};var on=k.diffed;k.diffed=function(e){on&&on(e);var t=e.props,n=e.__e;n!=null&&e.type==="textarea"&&"value"in t&&t.value!==n.value&&(n.value=t.value==null?"":t.value),Ft=null};var tl={ReactCurrentDispatcher:{current:{readContext:function(e){return Ft.__n[e.__c].props.value},useCallback:Te,useContext:On,useDebugValue:In,useDeferredValue:er,useEffect:Y,useId:Dn,useImperativeHandle:Ln,useInsertionEffect:nr,useLayoutEffect:Pe,useMemo:K,useReducer:$t,useRef:R,useState:he,useSyncExternalStore:Qn,useTransition:tr}}};function nl(e){return se.bind(null,e)}function nt(e){return!!e&&e.$$typeof===sr}function rl(e){return nt(e)&&e.type===V}function al(e){return!!e&&!!e.displayName&&(typeof e.displayName=="string"||e.displayName instanceof String)&&e.displayName.startsWith("Memo(")}function ll(e){return nt(e)?_r.apply(null,arguments):e}function sl(e){return!!e.__k&&(xe(null,e),!0)}function il(e){return e&&(e.base||e.nodeType===1&&e)||null}var ol=function(e,t){return e(t)},cl=function(e,t){return e(t)},ul=V,dl=nt,ye={useState:he,useId:Dn,useReducer:$t,useEffect:Y,useLayoutEffect:Pe,useInsertionEffect:nr,useTransition:tr,useDeferredValue:er,useSyncExternalStore:Qn,startTransition:Xn,useRef:R,useImperativeHandle:Ln,useMemo:K,useCallback:Te,useContext:On,useDebugValue:In,version:"18.3.1",Children:Pa,render:Ga,hydrate:Ya,unmountComponentAtNode:sl,createPortal:Va,createElement:se,createContext:yr,createFactory:nl,cloneElement:ll,createRef:pr,Fragment:V,isValidElement:nt,isElement:dl,isFragment:rl,isMemo:al,findDOMNode:il,Component:X,PureComponent:xt,memo:tt,forwardRef:Aa,flushSync:cl,unstable_batchedUpdates:ol,StrictMode:ul,Suspense:Ke,SuspenseList:Ie,lazy:Ja,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:tl},fl={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},ft=fl,pl={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},hl=pl;function ml({children:e}){return ye.createElement("div",{style:hl.container},e)}var vl=ml,gl=vl;function _l({width:e,height:t,isEditorReady:n,loading:a,_ref:l,className:s,wrapperProps:i}){return ye.createElement("section",{style:{...ft.wrapper,width:e,height:t},...i},!n&&ye.createElement(gl,null,a),ye.createElement("div",{ref:l,style:{...ft.fullWidth,...!n&&ft.hide},className:s}))}var yl=_l,ir=tt(yl);function bl(e){Y(e,[])}var or=bl;function xl(e,t,n=!0){let a=R(!0);Y(a.current||!n?()=>{a.current=!1}:e,t)}var G=xl;function ke(){}function ge(e,t,n,a){return Nl(e,a)||wl(e,t,n,a)}function Nl(e,t){return e.editor.getModel(cr(e,t))}function wl(e,t,n,a){return e.editor.createModel(t,n,a?cr(e,a):void 0)}function cr(e,t){return e.Uri.parse(t)}function Sl({original:e,modified:t,language:n,originalLanguage:a,modifiedLanguage:l,originalModelPath:s,modifiedModelPath:i,keepCurrentOriginalModel:o=!1,keepCurrentModifiedModel:u=!1,theme:c="light",loading:f="Loading...",options:d={},height:m="100%",width:g="100%",className:C,wrapperProps:j={},beforeMount:O=ke,onMount:$=ke}){let[b,A]=he(!1),[p,_]=he(!0),N=R(null),w=R(null),h=R(null),y=R($),v=R(O),x=R(!1);or(()=>{let S=Yn.init();return S.then(P=>(w.current=P)&&_(!1)).catch(P=>P?.type!=="cancelation"&&console.error("Monaco initialization: error:",P)),()=>N.current?F():S.cancel()}),G(()=>{if(N.current&&w.current){let S=N.current.getOriginalEditor(),P=ge(w.current,e||"",a||n||"text",s||"");P!==S.getModel()&&S.setModel(P)}},[s],b),G(()=>{if(N.current&&w.current){let S=N.current.getModifiedEditor(),P=ge(w.current,t||"",l||n||"text",i||"");P!==S.getModel()&&S.setModel(P)}},[i],b),G(()=>{let S=N.current.getModifiedEditor();S.getOption(w.current.editor.EditorOption.readOnly)?S.setValue(t||""):t!==S.getValue()&&(S.executeEdits("",[{range:S.getModel().getFullModelRange(),text:t||"",forceMoveMarkers:!0}]),S.pushUndoStop())},[t],b),G(()=>{N.current?.getModel()?.original.setValue(e||"")},[e],b),G(()=>{let{original:S,modified:P}=N.current.getModel();w.current.editor.setModelLanguage(S,a||n||"text"),w.current.editor.setModelLanguage(P,l||n||"text")},[n,a,l],b),G(()=>{w.current?.editor.setTheme(c)},[c],b),G(()=>{N.current?.updateOptions(d)},[d],b);let L=Te(()=>{if(!w.current)return;v.current(w.current);let S=ge(w.current,e||"",a||n||"text",s||""),P=ge(w.current,t||"",l||n||"text",i||"");N.current?.setModel({original:S,modified:P})},[n,t,l,e,a,s,i]),I=Te(()=>{!x.current&&h.current&&(N.current=w.current.editor.createDiffEditor(h.current,{automaticLayout:!0,...d}),L(),w.current?.editor.setTheme(c),A(!0),x.current=!0)},[d,c,L]);Y(()=>{b&&y.current(N.current,w.current)},[b]),Y(()=>{!p&&!b&&I()},[p,b,I]);function F(){let S=N.current?.getModel();o||S?.original?.dispose(),u||S?.modified?.dispose(),N.current?.dispose()}return ye.createElement(ir,{width:g,height:m,isEditorReady:b,loading:f,_ref:h,className:C,wrapperProps:j})}var Cl=Sl;tt(Cl);function $l(e){let t=R();return Y(()=>{t.current=e},[e]),t.current}var Ll=$l,Ve=new Map;function Ol({defaultValue:e,defaultLanguage:t,defaultPath:n,value:a,language:l,path:s,theme:i="light",line:o,loading:u="Loading...",options:c={},overrideServices:f={},saveViewState:d=!0,keepCurrentModel:m=!1,width:g="100%",height:C="100%",className:j,wrapperProps:O={},beforeMount:$=ke,onMount:b=ke,onChange:A,onValidate:p=ke}){let[_,N]=he(!1),[w,h]=he(!0),y=R(null),v=R(null),x=R(null),L=R(b),I=R($),F=R(),S=R(a),P=Ll(s),ve=R(!1),rt=R(!1);or(()=>{let B=Yn.init();return B.then(ie=>(y.current=ie)&&h(!1)).catch(ie=>ie?.type!=="cancelation"&&console.error("Monaco initialization: error:",ie)),()=>v.current?dr():B.cancel()}),G(()=>{let B=ge(y.current,e||a||"",t||l||"",s||n||"");B!==v.current?.getModel()&&(d&&Ve.set(P,v.current?.saveViewState()),v.current?.setModel(B),d&&v.current?.restoreViewState(Ve.get(s)))},[s],_),G(()=>{v.current?.updateOptions(c)},[c],_),G(()=>{!v.current||a===void 0||(v.current.getOption(y.current.editor.EditorOption.readOnly)?v.current.setValue(a):a!==v.current.getValue()&&(rt.current=!0,v.current.executeEdits("",[{range:v.current.getModel().getFullModelRange(),text:a,forceMoveMarkers:!0}]),v.current.pushUndoStop(),rt.current=!1))},[a],_),G(()=>{let B=v.current?.getModel();B&&l&&y.current?.editor.setModelLanguage(B,l)},[l],_),G(()=>{o!==void 0&&v.current?.revealLine(o)},[o],_),G(()=>{y.current?.editor.setTheme(i)},[i],_);let Mt=Te(()=>{if(!(!x.current||!y.current)&&!ve.current){I.current(y.current);let B=s||n,ie=ge(y.current,a||e||"",t||l||"",B||"");v.current=y.current?.editor.create(x.current,{model:ie,automaticLayout:!0,...c},f),d&&v.current.restoreViewState(Ve.get(B)),y.current.editor.setTheme(i),o!==void 0&&v.current.revealLine(o),N(!0),ve.current=!0}},[e,t,n,a,l,s,c,f,d,i,o]);Y(()=>{_&&L.current(v.current,y.current)},[_]),Y(()=>{!w&&!_&&Mt()},[w,_,Mt]),S.current=a,Y(()=>{_&&A&&(F.current?.dispose(),F.current=v.current?.onDidChangeModelContent(B=>{rt.current||A(v.current.getValue(),B)}))},[_,A]),Y(()=>{if(_){let B=y.current.editor.onDidChangeMarkers(ie=>{let at=v.current.getModel()?.uri;if(at&&ie.find(lt=>lt.path===at.path)){let lt=y.current.editor.getModelMarkers({resource:at});p?.(lt)}});return()=>{B?.dispose()}}return()=>{}},[_,p]);function dr(){F.current?.dispose(),m?d&&Ve.set(s,v.current.saveViewState()):v.current.getModel()?.dispose(),v.current.dispose()}return ye.createElement(ir,{width:g,height:C,isEditorReady:_,loading:u,_ref:x,className:j,wrapperProps:O})}var Il=Ol,Dl=tt(Il),El=Dl;function Tt({title:e="JSON Editor",value:t,onChange:n,placeholder:a="{}",readOnly:l=!1,height:s="400px"}){const i=R(null),o=R(null),u=W(!0),c=W(""),f=W(!1),d=D(()=>typeof navigator<"u"&&navigator.platform.toUpperCase().indexOf("MAC")>=0),m=D(()=>d.value?"Cmd":"Ctrl"),g=(p,_)=>p==="opacity"&&typeof _=="number"?parseFloat(_.toFixed(1)):_,C=D(()=>{try{return t==null?"":JSON.stringify(t,g,2).replace(/"opacity":\s*(\d+)(?!\.)/g,'"opacity": $1.0')}catch{return""}}),j=(p,_)=>{i.current=p,o.current=_,_.languages.json.jsonDefaults.setDiagnosticsOptions({validate:!0,allowComments:!1,schemas:[],enableSchemaRequest:!1}),p.updateOptions({minimap:{enabled:!1},fontSize:12,tabSize:2,insertSpaces:!0,wordWrap:"on",lineNumbers:"on",folding:!0,bracketPairColorization:{enabled:!0},autoIndent:"full",formatOnPaste:!0,formatOnType:!0}),p.addCommand(_.KeyMod.CtrlCmd|_.KeyCode.KeyS,()=>{$()}),p.addCommand(_.KeyMod.CtrlCmd|_.KeyMod.Shift|_.KeyCode.KeyF,()=>{b()})},O=p=>{if(!(l||!p))try{const _=JSON.parse(p);u.value=!0,c.value="",n(_)}catch(_){u.value=!1,c.value=_ instanceof Error?_.message:"Invalid JSON"}},$=()=>{if(!i.current||l)return;const p=i.current.getValue();O(p)},b=async()=>{if(!(!i.current||!o.current||l)){f.value=!0;try{const p=i.current.getValue(),_=JSON.parse(p),w=JSON.stringify(_,g,2).replace(/"opacity":\s*(\d+)(?!\.)/g,'"opacity": $1.0');i.current.setValue(w),n(_),u.value=!0,c.value=""}catch{await i.current.getAction("editor.action.formatDocument")?.run()}finally{f.value=!1}}};return r("div",{className:"flex flex-col h-full min-h-0",children:[r("div",{className:"flex flex-wrap gap-2 mb-3 items-center flex-shrink-0",children:[r("span",{className:"text-slate-500",children:e}),r("div",{className:"ml-auto flex gap-2",children:!l&&r(V,{children:[r("button",{className:"btn small",onClick:()=>{if(!i.current)return;const p=i.current.getValue();try{return JSON.parse(p),u.value=!0,c.value="",!0}catch(_){return u.value=!1,c.value=_ instanceof Error?_.message:"Invalid JSON",!1}},title:"Validate JSON",children:"Validate"}),r("button",{className:"btn small",onClick:b,disabled:f.value,title:`Format JSON (${m.value}+Shift+F)`,children:f.value?"Formatting...":"Format"})]})})]}),!u.value&&c.value&&r("div",{className:"bg-red-900/30 border border-red-500/50 rounded p-2 mb-2 flex-shrink-0",children:r("div",{className:"text-red-300 text-xs",children:[r("span",{className:"font-medium",children:"JSON Error:"})," ",c.value]})}),u.value&&!l&&r("div",{className:"bg-green-900/30 border border-green-500/50 rounded p-2 mb-2 flex-shrink-0",children:r("div",{className:"text-green-300 text-xs",children:["✓ Valid JSON - Press ",m.value,"+S to save changes"]})}),r("div",{className:"flex-1 min-h-0 border border-slate-600 rounded overflow-hidden",children:r(El,{height:s,language:"json",theme:"vs-dark",value:C.value||a,onChange:O,onMount:j,options:{readOnly:l,contextmenu:!0,automaticLayout:!0},loading:r("div",{className:"flex items-center justify-center h-full text-slate-400",children:"Loading JSON Editor..."})})}),r("div",{className:"text-xs text-slate-500 mt-2 flex-shrink-0",children:l?"Read-only JSON view":r(V,{children:[r("span",{className:"font-medium",children:"Shortcuts:"})," ",m.value,"+S to save • ",m.value,"+Shift+F to format • Auto-validation enabled"]})})]})}function kl({feature:e,type:t,index:n,rearrange:a}){const l=D(()=>Z.value.type===t&&Z.value.index===n),s=D(()=>t==="weatherFeatures"?(E.value.weatherFeatures||[]).length:(E.value.features||[]).length),i=W(!1),o=W(null),u=D(()=>{const b=[];e.id?.trim()&&b.push(e.id),(e.items||[]).forEach(h=>{h.id?.trim()&&b.push(h.id),h.legendDescription?.trim()&&b.push(h.legendDescription)});const A=[...new Set(b)];if(A.length===0)return{percentage:100,missingCount:0,totalKeys:0};let p=0,_=0;A.forEach(h=>{T.forEach(y=>{p++;const v=E.value.intl?.[y]?.[h];v&&v.trim()&&_++})});const N=p>0?Math.round(_/p*100):100,w=p-_;return{percentage:N,missingCount:w,totalKeys:A.length}}),c=()=>{Vn(t,n)},f=b=>{b.stopPropagation(),confirm("Are you sure you want to delete this feature?")&&Br(t,n)},d=b=>{b.stopPropagation(),!(n<=0)&&qe(t,n,t,n-1)},m=b=>{b.stopPropagation();const A=(t==="weatherFeatures"?E.value.weatherFeatures:E.value.features).length;n>=A-1||qe(t,n,t,n+1)},g=b=>{b.stopPropagation(),Gr(t,n,t==="weatherFeatures"?"features":"weatherFeatures")},C=(e.items||[]).length,j=e.presentation||"single",O=e.name||j==="single"&&e.items?.[0]?.name||e.id||"Unnamed Feature",$=e.mutuallyExclusive?" • Exclusive":"";return r("div",{className:`feature-list-item relative ${l.value?"selected":""} ${i.value?"ring-1 ring-blue-500":""}`,onClick:c,draggable:a,onDragStart:b=>{if(!a)return;const A=JSON.stringify({kind:"feature",type:t,index:n});b.dataTransfer.setData("application/x-feature",A),b.dataTransfer.setData("text/plain",A),b.dataTransfer.effectAllowed="move"},onDragOver:b=>{if(!a||!Array.from(b.dataTransfer?.types||[]).includes("application/x-feature"))return;b.preventDefault(),b.dataTransfer.dropEffect="move",i.value=!0;const p=b.currentTarget.getBoundingClientRect(),_=b.clientY<p.top+p.height/2;o.value=_?"before":"after"},onDragLeave:()=>{i.value=!1,o.value=null},onDrop:b=>{if(!a)return;b.preventDefault(),i.value=!1;const A=o.value;o.value=null;const p=b.dataTransfer.getData("application/x-feature")||b.dataTransfer.getData("text/plain");if(p)try{const _=JSON.parse(p);if(_.kind!=="feature")return;const N=A==="after"?n+1:n;qe(_.type,_.index,t,N)}catch{}},children:[i.value&&o.value==="before"&&r("div",{className:"absolute -top-[1px] left-0 right-0 h-0.5 bg-blue-500 rounded-full"}),r("div",{className:"feature-info",children:[r("div",{className:"feature-name",children:O}),r("div",{className:"feature-details",children:[C," item(s) • ",j,$]}),u.value.totalKeys>0&&r("div",{className:"flex items-center gap-1 mt-1",children:[r("span",{className:"text-xs text-slate-400",children:"i18n:"}),r("span",{className:`text-xs px-1.5 py-0.5 rounded-full ${u.value.percentage===100?"bg-green-600 text-white":u.value.percentage>50?"bg-yellow-600 text-white":"bg-red-600 text-white"}`,children:[u.value.percentage,"%"]}),u.value.missingCount>0&&r("span",{className:"text-xs text-orange-400",children:["(",u.value.missingCount," missing)"]})]})]}),r("div",{className:"feature-actions flex gap-1",children:[a&&r(V,{children:[r("button",{className:"btn small",onClick:d,disabled:n===0,title:"Move up",children:"↑"}),r("button",{className:"btn small",onClick:m,disabled:n>=s.value-1,title:"Move down",children:"↓"}),r("button",{className:"btn ghost small",onClick:g,title:t==="weatherFeatures"?"Move to General":"Move to Weather",children:t==="weatherFeatures"?"To General":"To Weather"})]}),r("button",{className:"btn danger small",onClick:f,children:"Delete"})]}),i.value&&o.value==="after"&&r("div",{className:"absolute -bottom-[1px] left-0 right-0 h-0.5 bg-blue-500 rounded-full"})]})}function cn({title:e,type:t,features:n,rearrange:a}){const l=W(!1);return r("details",{open:!0,className:`feature-category ${l.value?"ring-1 ring-blue-700 rounded":""}`,onDragOver:s=>{!a||!Array.from(s.dataTransfer?.types||[]).includes("application/x-feature")||(s.preventDefault(),l.value=!0)},onDragLeave:()=>{l.value=!1},onDrop:s=>{if(!a)return;s.preventDefault(),l.value=!1;const i=s.dataTransfer.getData("application/x-feature")||s.dataTransfer.getData("text/plain");if(i)try{const o=JSON.parse(i);if(o.kind!=="feature")return;const u=(t==="weatherFeatures"?E.value.weatherFeatures:E.value.features).length;qe(o.type,o.index,t,u)}catch{}},children:[r("summary",{className:"feature-category-header",children:e}),r("div",{className:"feature-category-content",children:n.length===0?r("div",{className:"p-3 text-slate-500 text-center",children:["No ",e.toLowerCase()," found"]}):n.map((s,i)=>r(kl,{feature:s,type:t,index:i,rearrange:a},i))})]})}function Fl(){const e=D(()=>E.value.weatherFeatures||[]),t=D(()=>E.value.features||[]),n=W(!1);return r("div",{className:"flex flex-col h-full",children:[r("div",{className:"flex items-center justify-between mb-2",children:[r("div",{className:"text-sm text-slate-400",children:"Features"}),r("button",{className:`btn tiny ${n.value?"success":"ghost"}`,onClick:()=>n.value=!n.value,title:"Toggle rearrange mode",children:n.value?"Done":"Rearrange"})]}),r("div",{className:"feature-browser flex-1 overflow-auto",children:[r(cn,{title:"Weather Features",type:"weatherFeatures",features:e.value,rearrange:n.value}),r(cn,{title:"General Features",type:"features",features:t.value,rearrange:n.value})]})]})}function Tl({layer:e,index:t,isUsed:n}){const a=D(()=>le.value.index===t),l=we(e.id),s=()=>{He(t)},i=o=>{o.stopPropagation(),confirm(`Are you sure you want to delete layer "${e.id}"?`)&&Hn(t)};return r("div",{className:`feature-list-item ${a.value?"selected":""}`,onClick:s,children:[r("div",{className:"feature-info",children:[r("div",{className:"feature-name",children:e.id||"(no id)"}),r("div",{className:"feature-details",children:[r("span",{className:`pill ${n?"ok":"warn"}`,children:n?"used":"unused"}),l&&r("span",{className:"ml-2 text-xs bg-blue-600 text-white px-1.5 py-0.5 rounded",children:"referenced"}),r("span",{className:"ml-2 text-xs",children:[e.layers?.length||0," sublayer",(e.layers?.length||0)===1?"":"s"]})]})]}),r("div",{className:"feature-actions",children:r("button",{className:"btn danger small",onClick:i,children:"Delete"})})]})}function Ml(){const e=D(()=>E.value.layers||[]),t=D(()=>Et(E.value));return r("div",{className:"flex flex-col h-full",children:r("div",{className:"feature-browser flex-1 overflow-auto",children:r("div",{className:"feature-category",children:[r("div",{className:"feature-category-header",children:"Layers"}),r("div",{className:"feature-category-content",children:e.value.length===0?r("div",{className:"p-3 text-slate-500 text-center",children:"No layers found"}):e.value.map((n,a)=>r(Tl,{layer:n,index:a,isUsed:t.value.has(n.id)},n.id||a))})]})})})}const jl=e=>{const t=[],n=[];return e.presentation?["single","multiple"].includes(e.presentation)||t.push('presentation must be "single" or "multiple"'):t.push("presentation field is required"),e.items?Array.isArray(e.items)?e.items.length===0?n.push("items array is empty - feature will not be functional"):e.items.forEach((a,l)=>{const s=Al(a);t.push(...s.errors.map(i=>`Item ${l+1}: ${i}`)),n.push(...s.warnings.map(i=>`Item ${l+1}: ${i}`))}):t.push("items must be an array"):t.push("items field is required"),{valid:t.length===0,errors:t,warnings:n}},Al=e=>{const t=[],n=[];return e.id?typeof e.id!="string"?t.push("id must be a string"):e.id.trim()===""&&t.push("id cannot be empty or whitespace only"):t.push("id is required"),e.name?typeof e.name!="string"?t.push("name must be a string"):e.name.trim()===""&&t.push("name cannot be empty or whitespace only"):t.push("name is required"),e.layersIds?Array.isArray(e.layersIds)?e.layersIds.length===0?t.push("layersIds must contain at least one layer ID"):e.layersIds.forEach((a,l)=>{(!a||typeof a!="string"||a.trim()==="")&&t.push(`layersIds[${l}] must be a non-empty string`)}):t.push("layersIds must be an array"):t.push("layersIds is required"),e.showLegend!==void 0&&typeof e.showLegend!="boolean"&&t.push("showLegend must be a boolean"),e.legendUrl!==void 0&&(typeof e.legendUrl!="string"?t.push("legendUrl must be a string"):e.legendUrl.trim()===""&&n.push("legendUrl is empty - consider removing it")),e.legendDescription!==void 0&&(typeof e.legendDescription!="string"?t.push("legendDescription must be a string"):e.legendDescription.trim()===""&&n.push("legendDescription is empty - consider removing it")),{valid:t.length===0,errors:t,warnings:n}},Pl=e=>{const t=[],n=[];return e.type?["wms","tiled","mapImage","portalItem","vectorTiled","feature"].includes(e.type)||t.push("type must be one of: wms, tiled, mapImage, portalItem, vectorTiled, feature"):t.push("type is required"),e.source?typeof e.source!="string"?t.push("source must be a string"):e.source.trim()===""&&t.push("source cannot be empty"):t.push("source is required"),e.zIndex!==void 0&&(typeof e.zIndex!="number"?t.push("zIndex must be a number"):Number.isInteger(e.zIndex)||t.push("zIndex must be an integer")),e.refreshInterval!==void 0&&(typeof e.refreshInterval!="number"?t.push("refreshInterval must be a number"):e.refreshInterval<0?t.push("refreshInterval must be non-negative"):Number.isInteger(e.refreshInterval)||t.push("refreshInterval must be an integer (milliseconds)")),e.options?.opacity!==void 0&&(typeof e.options.opacity!="number"?t.push("opacity (in options) must be a number"):(e.options.opacity<0||e.options.opacity>1)&&t.push("opacity must be between 0.0 and 1.0")),{valid:t.length===0,errors:t,warnings:n}},un=e=>{const t=[],n=[];return e.id?typeof e.id!="string"?t.push("id must be a string"):e.id.trim()===""&&t.push("id cannot be empty"):t.push("id is required"),e.layers?Array.isArray(e.layers)?e.layers.length===0?t.push("layers array cannot be empty"):e.layers.forEach((a,l)=>{const s=Pl(a);t.push(...s.errors.map(i=>`Layer ${l+1}: ${i}`)),n.push(...s.warnings.map(i=>`Layer ${l+1}: ${i}`))}):t.push("layers must be an array"):t.push("layers field is required"),{valid:t.length===0,errors:t,warnings:n}};function ur({validation:e,className:t=""}){return!e||e.errors.length===0&&e.warnings.length===0?null:r("div",{className:`space-y-2 ${t}`,children:[e.errors.length>0&&r("div",{className:"bg-red-900/20 border border-red-700/30 rounded p-2",children:[r("div",{className:"flex items-center gap-2 text-red-400 text-sm font-medium mb-1",children:[r("span",{children:"❌"}),r("span",{children:["Errors (",e.errors.length,")"]})]}),r("div",{className:"space-y-1",children:e.errors.map((n,a)=>r("div",{className:"text-red-300 text-xs",children:["• ",n]},a))})]}),e.warnings.length>0&&r("div",{className:"bg-yellow-900/20 border border-yellow-700/30 rounded p-2",children:[r("div",{className:"flex items-center gap-2 text-yellow-400 text-sm font-medium mb-1",children:[r("span",{children:"⚠️"}),r("span",{children:["Warnings (",e.warnings.length,")"]})]}),r("div",{className:"space-y-1",children:e.warnings.map((n,a)=>r("div",{className:"text-yellow-300 text-xs",children:["• ",n]},a))})]})]})}const Ul=[{id:"details",label:"Details"},{id:"json",label:"JSON"}];function Jl(){const e=D(()=>le.value.index),t=zr,n=W("details"),a=W([]),l=D(()=>e.value>=0?e.value:null),s=D(()=>l.value===null?null:qr(l.value)||null),i=D(()=>!!H.value.new),o=D(()=>i.value||s.value!=null),u=D(()=>{const h=H.value.new;return h||(s.value?s.value:t.value||null)}),c=D(()=>{const h=u.value;return h?un(h):null}),f=()=>{re("new",{id:"",layers:[]}),He(-1)},d=()=>{e.value<0||!t.value||re(e.value,{...t.value})},m=()=>{const h=i.value,y=h?"new":l.value,v=h?H.value.new:H.value[y];if(!v)return;const x=un(v);if(!x.valid){a.value=x.errors,te(`❌ Layer validation failed: ${x.errors[0]}`);return}const L=Jr(E.value,v);z(L);const I=L.layers.findIndex(F=>F.id===v.id);I>=0&&He(I),Re("new"),!h&&typeof y=="number"&&Re(y)},g=()=>{Re("new"),typeof l.value=="number"&&Re(l.value)},C=()=>{if(e.value<0||!t.value)return;const h=t.value.id||`Layer ${e.value+1}`;confirm(`Are you sure you want to delete layer "${h}"? This action cannot be undone.`)&&Hn(e.value)},j=()=>{if(e.value<0||!t.value)return;const h=t.value,y={id:`${h.id}_copy`,layers:JSON.parse(JSON.stringify(h.layers||[]))};re("new",y),He(-1)},O=h=>{const y=i.value||l.value===null,v=y?"new":l.value,L={...y?H.value.new:H.value[v],...h};re(v,L)},$=(h,y)=>{const v=i.value||l.value===null,x=v?"new":l.value,L=v?H.value.new:H.value[x],I=[...L.layers||[]];I[h]={...I[h],...y},re(x,{...L,layers:I})},b=h=>{const y=i.value||l.value===null,v=y?"new":l.value,x=y?H.value.new:H.value[v],L=[...x.layers||[]];L.splice(h,1),re(v,{...x,layers:L})},A=(h="wms")=>{const y=i.value||l.value===null,v=y?"new":l.value,x=y?H.value.new:H.value[v],L={type:h,source:"",zIndex:0,options:{opacity:1}},I=[...x.layers||[],L];re(v,{...x,layers:I})},p=h=>{t.value&&l.value===e.value&&!s.value&&!i.value&&re(e.value,{...t.value});const v=i.value||l.value===null?"new":l.value;re(v,h)},_=D(()=>e.value>=0&&!!t.value),N=D(()=>t.value?.id?Lr(E.value,t.value.id):[]),w=D(()=>t.value?.id?we(t.value.id):!1);return r("div",{className:"flex flex-col h-full",children:[r("div",{className:"flex flex-wrap gap-2 mb-3 items-center flex-shrink-0",children:[r("div",{children:[r("span",{className:"text-slate-500",children:o.value?e.value>=0?"Edit Layer":"New Layer":"Layer Details"}),u.value&&r("div",{className:"text-xs text-slate-400 mt-0.5",children:[u.value.id,w.value&&!o.value&&r("span",{className:"ml-2 text-xs bg-blue-600 text-white px-2 py-0.5 rounded",children:"Referenced"})]})]}),r("div",{className:"ml-auto flex gap-2",children:[!o.value&&_.value&&r(V,{children:[r("button",{className:"btn small",onClick:d,children:"Edit"}),r("button",{className:"btn ghost small",onClick:j,children:"Duplicate"}),r("button",{className:"btn danger small",onClick:C,children:"Delete"})]}),r("button",{className:"btn primary small",onClick:f,children:"New Layer"}),o.value&&r(V,{children:[r("button",{className:"btn success small",onClick:m,children:"Save"}),r("button",{className:"btn ghost small",onClick:g,children:"Cancel"})]})]})]}),u.value?r(V,{children:[r("div",{className:"flex gap-1 mb-3 border-b border-slate-700 pb-2 flex-shrink-0",children:Ul.map(h=>r("button",{className:`px-3 py-1.5 rounded-t-md text-xs transition-all duration-150 ${n.value===h.id?"bg-blue-500 text-white":"bg-slate-950 text-slate-500 border border-slate-700 hover:border-slate-600 hover:text-slate-200"}`,onClick:()=>n.value=h.id,children:h.label},h.id))}),r("div",{className:"flex-1 overflow-hidden",children:[n.value==="details"&&r("div",{className:"h-full overflow-auto",children:[r(ur,{validation:c.value,className:"mb-4"}),r("div",{className:"layer-section",children:r("div",{className:"form-group",children:[r("label",{className:"form-label",children:"Layer ID"}),r("input",{type:"text",className:"form-input",value:u.value.id,onChange:h=>O({id:h.target.value}),onBlur:h=>{const y=h.target.value.trim();if(!y)return;const v=E.value.layers||[];if(v.some((L,I)=>L.id===y&&I!==e.value)){let L=1,I=`${y}_${L}`;for(;v.some(F=>F.id===I);)L++,I=`${y}_${L}`;O({id:I}),h.target.value=I}},placeholder:"unique_layer_id",disabled:!o.value})]})}),r("div",{className:"layer-section",children:[r("div",{className:"flex items-center justify-between mb-2",children:[r("label",{className:"form-label",children:"Sublayers"}),o.value&&r("button",{className:"btn small",onClick:()=>A("wms"),children:"+ Add Sublayer"})]}),u.value.layers.length===0&&r("div",{className:"text-slate-500 text-sm",children:"No sublayers. Add one to get started."}),r("div",{className:"space-y-2",children:u.value.layers.map((h,y)=>r("div",{className:"border border-slate-600 rounded p-3 bg-slate-900",draggable:o.value&&u.value.layers.length>1,onDragStart:v=>{o.value&&(v.dataTransfer.setData("text/plain",y.toString()),v.dataTransfer.effectAllowed="move")},onDragOver:v=>{o.value&&(v.preventDefault(),v.dataTransfer.dropEffect="move")},onDrop:v=>{if(!o.value)return;v.preventDefault();const x=parseInt(v.dataTransfer.getData("text/plain"));if(x!==y){const I=[...u.value.layers||[]],F=I[x];I.splice(x,1),I.splice(y,0,F),O({layers:I})}},style:{cursor:o.value&&u.value.layers.length>1?"grab":"default"},children:[r("div",{className:"mb-2",children:[r("div",{className:"flex items-center gap-2 mb-1",children:[o.value&&u.value.layers.length>1&&r("div",{className:"cursor-move text-slate-400 hover:text-slate-300 px-1 select-none",title:"Drag to reorder",children:"⋮⋮"}),r("span",{className:"text-xs text-slate-400 font-mono",children:["#",y+1]}),r("div",{className:"flex-1 text-sm font-medium",children:h.type.toUpperCase()}),o.value&&r("button",{className:"btn tiny danger",onClick:()=>b(y),children:"×"})]}),r("div",{className:"text-xs text-slate-400 break-all pl-6",children:h.source||"No source"}),!o.value&&r("div",{className:"text-xs text-slate-500 pl-6 mt-1 space-y-0.5",children:[h.options?.opacity!==void 0&&h.options.opacity!==1&&r("div",{children:["Opacity: ",h.options.opacity]}),h.zIndex!==void 0&&h.zIndex!==0&&r("div",{children:["Z-Index: ",h.zIndex]}),h.refreshInterval&&r("div",{children:["Refresh: ",h.refreshInterval,"ms (",(h.refreshInterval/1e3).toFixed(1),"s)"]})]})]}),o.value&&r("div",{className:"space-y-2 text-xs",children:[r("div",{className:"grid grid-cols-2 gap-2",children:[r("div",{children:[r("label",{className:"block text-slate-400 mb-1",children:"Type"}),r("select",{className:"w-full px-2 py-1 text-xs bg-slate-800 border border-slate-600 rounded",value:h.type,onChange:v=>{const x=v.target.value,L=Ur(x),I=h.options||{},F={};I.opacity!==void 0&&(F.opacity=I.opacity),x==="wms"&&L.options?.layerNames?F.layerNames=L.options.layerNames:x==="portalItem"&&L.options?.layerId!==void 0&&(F.layerId=L.options.layerId),Object.entries(I).forEach(([S,P])=>{S!=="layerNames"&&S!=="layerId"&&S!=="opacity"&&(F[S]=P)}),$(y,{type:x,source:h.source,options:F})},children:Pr.map(v=>r("option",{value:v,children:v.toUpperCase()},v))})]}),r("div",{children:[r("label",{className:"block text-slate-400 mb-1",children:"Opacity"}),r("input",{type:"number",className:"w-full px-2 py-1 text-xs bg-slate-800 border border-slate-600 rounded",placeholder:"0.0 - 1.0",min:"0",max:"1",step:"0.1",value:h.options?.opacity??1,onChange:v=>{let x=parseFloat(v.target.value);isNaN(x)&&(x=1),x<0&&(x=0),x>1&&(x=1),$(y,{options:{...h.options,opacity:x}})}})]})]}),r("div",{className:"grid grid-cols-2 gap-2",children:[r("div",{children:[r("label",{className:"block text-slate-400 mb-1",children:"Z-Index"}),r("input",{type:"number",className:"w-full px-2 py-1 text-xs bg-slate-800 border border-slate-600 rounded",value:h.zIndex??0,onChange:v=>$(y,{zIndex:parseInt(v.target.value)})})]}),r("div",{children:[r("label",{className:"block text-slate-400 mb-1",children:"Refresh Interval (ms)"}),r("input",{type:"number",className:"w-full px-2 py-1 text-xs bg-slate-800 border border-slate-600 rounded",value:h.refreshInterval||"",onChange:v=>{const x=v.target.value;$(y,{refreshInterval:x?parseInt(x):void 0})},placeholder:"60000",min:"0",step:"1000"})]})]}),r("div",{children:[r("label",{className:"block text-slate-400 mb-1",children:"Source URL/ID"}),r("input",{type:"text",className:"w-full px-2 py-1 text-xs bg-slate-800 border border-slate-600 rounded",value:h.source||"",onChange:v=>$(y,{source:v.target.value}),placeholder:h.type==="portalItem"?"e.g. abc123def456":h.type==="wms"?"https://example.com/wms":h.type==="tiled"?"https://example.com/tiles/{z}/{y}/{x}.png":h.type==="vectorTiled"?"https://example.com/vectortiles/{z}/{y}/{x}.pbf":h.type==="feature"?"https://example.com/arcgis/rest/services/FeatureServer/0":"https://example.com/arcgis/rest/services/MapServer"}),r("div",{className:"text-[10px] text-slate-500 mt-1",children:[h.type==="portalItem"&&"ArcGIS Online portal item ID",h.type==="wms"&&"WMS service endpoint URL",h.type==="tiled"&&"Tile template URL with {z}/{y}/{x}",h.type==="vectorTiled"&&"Vector tile template URL with {z}/{y}/{x}",h.type==="mapImage"&&"ArcGIS REST MapServer endpoint",h.type==="feature"&&"ArcGIS REST FeatureServer endpoint"]})]}),h.type==="portalItem"&&r("div",{children:[r("label",{className:"block text-slate-400 mb-1",children:"Portal Layer ID"}),r("input",{type:"number",className:"w-full px-2 py-1 text-xs bg-slate-800 border border-slate-600 rounded",value:h.options?.layerId||0,onChange:v=>$(y,{options:{...h.options||{},layerId:parseInt(v.target.value)||0}}),placeholder:"0"})]}),h.type==="wms"&&r("div",{children:[r("label",{className:"block text-slate-400 mb-1",children:["WMS Layer Names ",r("span",{className:"text-red-400",children:"*required"})]}),r("div",{className:"space-y-2",children:[(h.options?.layerNames||[]).length===0&&r("div",{className:"text-xs text-red-400 mb-2",children:"⚠️ WMS layers require at least one layer name"}),(h.options?.layerNames||["layer1"]).map((v,x)=>r("div",{className:"flex gap-2",children:[r("input",{type:"text",className:"w-full px-2 py-1 text-xs bg-slate-800 border border-slate-600 rounded",value:v,onChange:L=>{const I=[...h.options?.layerNames||[]];I[x]=L.target.value,$(y,{options:{...h.options||{},layerNames:I}})},onBlur:L=>{if(!L.target.value.trim()){const F=[...h.options?.layerNames||[]];F.length>1?(F.splice(x,1),$(y,{options:{...h.options||{},layerNames:F}})):(L.target.value=`layer${x+1}`,F[x]=`layer${x+1}`,$(y,{options:{...h.options||{},layerNames:F}}))}},placeholder:`layer${x+1}`}),(h.options?.layerNames||[]).length>1&&r("button",{type:"button",className:"btn tiny danger",onClick:()=>{const L=[...h.options?.layerNames||[]];L.splice(x,1),$(y,{options:{...h.options||{},layerNames:L}})},children:"×"})]},x)),r("button",{type:"button",className:"btn tiny",onClick:()=>{const v=[...h.options?.layerNames||[],""];$(y,{options:{...h.options||{},layerNames:v}})},children:"+ Add Layer Name"})]})]}),r("div",{children:[r("label",{className:"block text-slate-400 mb-1",children:"Custom Options"}),r("div",{className:"space-y-2",children:[Object.entries(h.options||{}).map(([v,x],L)=>v==="layerNames"||v==="layerId"||v==="opacity"?null:r("div",{className:"flex gap-2 items-center",children:[r("input",{type:"text",className:"w-1/3 px-2 py-1 text-xs bg-slate-800 border border-slate-600 rounded",value:v,onChange:I=>{const F=I.target.value,S={...h.options||{}};F!==v&&(delete S[v],F.trim()&&(S[F]=x),$(y,{options:S}))},placeholder:"key"}),r("span",{className:"text-slate-500",children:":"}),r("input",{type:"text",className:"flex-1 px-2 py-1 text-xs bg-slate-800 border border-slate-600 rounded",value:typeof x=="string"?x:JSON.stringify(x),onChange:I=>{let F=I.target.value;F==="true"?F=!0:F==="false"?F=!1:!isNaN(Number(F))&&F.trim()!==""&&(F=Number(F));const S={...h.options||{}};S[v]=F,$(y,{options:S})},placeholder:"value"}),r("button",{type:"button",className:"btn tiny danger",onClick:()=>{const I={...h.options||{}};delete I[v],$(y,{options:I})},title:"Remove option",children:"×"})]},`option-${L}`)),r("button",{type:"button",className:"btn tiny",onClick:()=>{const v={...h.options||{}};v.newOption="",$(y,{options:v})},children:"+ Add Custom Option"})]}),r("div",{className:"text-[10px] text-slate-500 mt-1",children:"Add custom properties. Values are auto-parsed (numbers, booleans, or strings)."})]})]})]},y))}),!o.value&&N.value.length>0&&r("div",{className:"form-group mt-3",children:[r("label",{className:"form-label",children:"Layer Usage"}),r("div",{className:"bg-slate-700 rounded p-3 text-sm",children:[r("div",{className:"text-slate-300 mb-2",children:["This layer is referenced by ",N.value.length," item(s):"]}),r("div",{className:"space-y-1 max-h-32 overflow-y-auto",children:N.value.map((h,y)=>r("div",{className:"text-slate-400 text-xs flex items-center gap-2",children:[r("span",{className:"bg-slate-600 px-2 py-0.5 rounded text-xs",children:h.featureType==="weatherFeatures"?"Weather":"Feature"}),r("span",{children:h.featureName}),r("span",{className:"text-slate-500",children:"→"}),r("span",{children:h.itemName})]},y))})]})]}),!o.value&&N.value.length===0&&t.value&&r("div",{className:"form-group mt-3",children:[r("label",{className:"form-label",children:"Layer Usage"}),r("div",{className:"bg-slate-700 rounded p-3 text-sm text-slate-400",children:["This layer is not currently referenced by any features or items.",r("br",{}),r("span",{className:"text-xs text-slate-500",children:"Consider deleting if no longer needed."})]})]})]})]}),n.value==="json"&&r("div",{className:"h-full min-h-0",children:r(Tt,{title:"Selected Layer JSON",value:u.value,onChange:p,readOnly:!o.value,height:"100%"},`${l.value??"new"}:${o.value?"edit":"view"}`)})]})]}):r("div",{className:"text-center p-5 text-slate-500 flex-1 flex items-center justify-center",children:r("div",{children:[r("p",{children:"Select a layer to view/edit or create a new one"}),r("button",{className:"btn primary",onClick:f,children:"New Layer"})]})})]})}function Rl({feature:e,isEditing:t}){const n=D(()=>E.value),a=D(()=>{const f=[];return e.id?.trim()&&f.push(e.id),(e.items||[]).forEach(d=>{d.id?.trim()&&f.push(d.id),d.legendDescription?.trim()&&f.push(d.legendDescription)}),[...new Set(f)]}),l=D(()=>a.value.map(f=>{const d={};let m=0;return T.forEach(g=>{const C=n.value.intl?.[g]?.[f]||"";d[g]=C,C.trim()||m++}),{key:f,translations:d,missingCount:m,isComplete:m===0,completionPercentage:Math.round((T.length-m)/T.length*100)}})),s=D(()=>{if(l.value.length===0)return 100;const f=l.value.length*T.length,d=l.value.reduce((m,g)=>m+(T.length-g.missingCount),0);return Math.round(d/f*100)}),i=(f,d,m)=>{const g={...n.value,intl:{...n.value.intl}};g.intl[d]||(g.intl[d]={}),g.intl[d]={...g.intl[d],[f]:m},z(g)},o=f=>{const d=l.value.find(C=>C.key===f);if(!d)return;const m=d.translations.en;if(!m.trim())return;const g={...n.value,intl:{...n.value.intl}};T.forEach(C=>{C!=="en"&&!d.translations[C].trim()&&(g.intl[C]||(g.intl[C]={}),g.intl[C][f]=m)}),z(g)},u=f=>{if(!confirm(`Clear all translations for "${f}"?`))return;const d={...n.value,intl:{...n.value.intl}};T.forEach(m=>{d.intl[m]&&d.intl[m][f]&&delete d.intl[m][f]}),z(d)},c=f=>{if(f===e.id)return"Feature ID";const d=(e.items||[]).find(m=>m.id===f||m.legendDescription===f);if(d){if(d.id===f)return`Item ID (${d.name||"Unnamed"})`;if(d.legendDescription===f)return`Legend Description (${d.name||d.id||"Unnamed"})`}return"Unknown"};return a.value.length===0?r("div",{className:"h-full flex items-center justify-center",children:r("div",{className:"text-center text-slate-500",children:[r("div",{className:"text-4xl mb-3",children:"🌐"}),r("div",{className:"text-sm font-medium mb-1",children:"No Translation Keys"}),r("div",{className:"text-xs",children:"Add feature and item IDs to enable translations"})]})}):r("div",{className:"h-full flex flex-col",children:[r("div",{className:"mb-4 pb-3 border-b border-slate-700",children:[r("div",{className:"flex items-center justify-between mb-2",children:[r("h3",{className:"text-lg font-medium text-slate-200",children:"Translations"}),r("div",{className:"flex items-center gap-2",children:[r("span",{className:"text-xs text-slate-400",children:[a.value.length," key",a.value.length!==1?"s":""]}),r("div",{className:`pill ${s.value===100?"ok":s.value>50?"warn":"error"}`,children:[s.value,"% complete"]})]})]}),r("div",{className:"text-xs text-slate-500",children:"Manage translations for all feature and item IDs. Missing translations will fall back to English or the ID itself."})]}),r("div",{className:"flex-1 overflow-y-auto space-y-4",children:l.value.map(f=>r("div",{className:"border border-slate-600 rounded-lg p-4 bg-slate-900/50",children:[r("div",{className:"flex items-start justify-between mb-3",children:[r("div",{className:"flex-1 min-w-0",children:[r("div",{className:"flex items-center gap-2 mb-1",children:[r("code",{className:"text-sm text-slate-300 font-mono",children:f.key}),r("span",{className:"text-xs text-slate-500",children:["(",c(f.key),")"]})]}),r("div",{className:"flex items-center gap-2",children:[r("div",{className:`pill tiny ${f.isComplete?"ok":f.completionPercentage>50?"warn":"error"}`,children:[f.completionPercentage,"%"]}),f.missingCount>0&&r("span",{className:"text-xs text-orange-400",children:[f.missingCount," missing"]})]})]}),r("div",{className:"flex gap-1",children:[f.missingCount>0&&f.translations.en.trim()&&r("button",{className:"btn tiny",onClick:()=>o(f.key),disabled:!t,title:"Fill missing translations with English text",children:"Fill EN"}),r("button",{className:"btn danger tiny",onClick:()=>u(f.key),disabled:!t,title:"Clear all translations for this key",children:"Clear"})]})]}),r("div",{className:"grid gap-3",children:T.map(d=>r("div",{className:"grid grid-cols-4 gap-2 items-start",children:[r("div",{className:"flex items-center gap-2",children:[r("span",{className:"font-mono text-xs bg-slate-700 px-2 py-1 rounded text-center min-w-[2.5rem]",children:d.toUpperCase()}),d==="en"&&r("span",{className:"text-slate-500 text-xs",children:"Default"}),!f.translations[d].trim()&&r("span",{className:"text-orange-400 text-xs",children:"•"})]}),r("div",{className:"col-span-3",children:r("textarea",{className:"form-textarea text-xs",rows:2,value:f.translations[d],onInput:m=>i(f.key,d,m.target.value),placeholder:d==="en"?`Enter ${d.toUpperCase()} text`:`Translate to ${d.toUpperCase()}`,disabled:!t})})]},d))})]},f.key))}),r("div",{className:"mt-4 pt-3 border-t border-slate-700",children:r("div",{className:"text-xs text-slate-500",children:[r("div",{className:"mb-1",children:[r("strong",{children:"Translation Coverage:"})," ",T.length*a.value.length-l.value.reduce((f,d)=>f+d.missingCount,0),"/",T.length*a.value.length," entries complete"]}),!t&&r("div",{className:"text-slate-400",children:r("em",{children:"Enable editing mode to modify translations"})})]})})]})}function Wl({isOpen:e,selectedLayerIds:t,onClose:n,onSave:a}){const l=W(t),s=W([]);JSON.stringify(s.value)!==JSON.stringify(t)&&(l.value=[...t],s.value=[...t]);const i=D(()=>E.value.layers||[]),o=D(()=>{const m=new Set;return[...E.value.weatherFeatures||[],...E.value.features||[]].forEach(g=>{(g.items||[]).forEach(C=>{(C.layersIds||[]).forEach(j=>{t.includes(j)||m.add(j)})})}),m}),u=D(()=>i.value.map(g=>({id:g.id,title:g.id||"Unnamed Layer",isAssigned:o.value.has(g.id)})).sort((g,C)=>g.isAssigned!==C.isAssigned?g.isAssigned?1:-1:g.title.localeCompare(C.title))),c=m=>{const g=l.value||[];l.value=g.includes(m)?g.filter(C=>C!==m):[...g,m]},f=()=>{a(l.value),n()},d=()=>{l.value=t,n()};return e?r("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:d,children:r("div",{className:"bg-slate-800 border border-slate-600 rounded-lg w-96 max-h-[80vh] flex flex-col",onClick:m=>m.stopPropagation(),children:[r("div",{className:"p-4 border-b border-slate-700",children:[r("h3",{className:"text-lg font-medium text-white",children:"Select Layers"}),r("p",{className:"text-sm text-slate-400 mt-1",children:["Choose one or more layers for this item (",l.value.length," selected)"]})]}),r("div",{className:"flex-1 overflow-y-auto p-2 max-h-96",children:u.value.length===0?r("div",{className:"p-4 text-center text-slate-500",children:"No layers available"}):r("div",{className:"space-y-1",children:u.value.map(m=>{const g=l.value.includes(m.id);return r("label",{className:"flex items-center gap-3 p-2 hover:bg-slate-700 rounded cursor-pointer",children:[r("input",{type:"checkbox",className:"form-checkbox",checked:g,onChange:()=>c(m.id)}),r("div",{className:"flex-1",children:[r("div",{className:`text-sm ${m.isAssigned?"text-slate-200":"text-green-300 font-medium"} flex items-center gap-2`,children:[m.title,we(m.id)&&r("span",{className:"text-xs bg-blue-600 text-white px-1.5 py-0.5 rounded",children:"referenced"})]}),r("div",{className:"text-xs text-slate-500",children:["ID: ",m.id,!m.isAssigned&&r("span",{className:"ml-2 text-green-400",children:"• Available"}),m.isAssigned&&r("span",{className:"ml-2 text-orange-400",children:"• In use"})]})]})]},m.id)})})}),r("div",{className:"p-4 border-t border-slate-700 flex gap-2 justify-end",children:[r("button",{className:"btn ghost small",onClick:d,children:"Cancel"}),r("button",{className:"btn success small",onClick:f,children:["Save Selection (",l.value.length,")"]})]})]})}):null}function Vl({selectedLayerIds:e,onChange:t}){const n=W(!1),a=e.length,l=E.value.layers||[],s=e.map(o=>l.find(c=>c.id===o)?.id||o).slice(0,2),i=a===0?"No layers selected":a<=2?s.join(", "):`${s.join(", ")} +${a-2} more`;return r(V,{children:[r("button",{type:"button",className:"w-full px-2 py-1 text-xs bg-slate-800 border border-slate-600 rounded text-left hover:border-slate-500 focus:border-blue-500 transition-colors",onClick:()=>n.value=!0,children:r("div",{className:"flex items-center justify-between",children:[r("span",{className:a>0?"text-slate-200":"text-slate-500",children:i}),r("span",{className:"text-slate-400 text-xs",children:[a>0&&r("span",{className:"bg-blue-600 text-white px-1.5 py-0.5 rounded-full mr-1",children:a}),"Click to select..."]})]})}),r(Wl,{isOpen:n.value,selectedLayerIds:e,onClose:()=>n.value=!1,onSave:t})]})}const zl=[{id:"details",label:"Details"},{id:"intl",label:"i18n"},{id:"json",label:"JSON"}],Hl=e=>{if(!e)return"";const t=e.id||e.name;return t&&t.length>0?t:(e.items||[])[0]?.id||""},ql=e=>{if(!e)return"";const t=e.name;if(t?.trim())return t;if(e.presentation==="single"){const n=(e.items||[])[0];if(n?.name?.trim())return n.name}return e.id||""},dn=()=>({presentation:"single",items:[{id:"",name:"",showLegend:!1,layersIds:[]}]});function Kl(){const e=Z,t=Vr,n=W("details"),a=W({active:!1,featureType:"weatherFeatures",draft:null}),l=D(()=>a.value.active?a.value.draft:!e.value.type||e.value.index<0?null:Kr(e.value.type,e.value.index)||null),s=D(()=>l.value!=null||a.value.active),i=D(()=>l.value?l.value:a.value.active?a.value.draft:t.value||null),o=D(()=>ql(i.value)||"Unnamed Feature"),u=D(()=>Hl(i.value)||"No ID"),c=D(()=>{const p=i.value;return p?jl(p):null}),f=D(()=>i.value?.presentation==="single"&&(i.value.items||[]).length===1),d=D(()=>{const p=i.value;if(!p||p.presentation!=="single")return!1;const _=p.items||[];if(_.length!==1)return!1;const N=_[0],w=p.id?.trim(),h=p.name?.trim(),y=N?.id?.trim(),v=N?.name?.trim();return!w&&y||!h&&v}),m=D(()=>{if(!i.value)return{percentage:100,missingCount:0,totalKeys:0};const p=i.value,_=[];p.id?.trim()&&_.push(p.id),(p.items||[]).forEach(x=>{x.id?.trim()&&_.push(x.id),x.legendDescription?.trim()&&_.push(x.legendDescription)});const N=[...new Set(_)];if(N.length===0)return{percentage:100,missingCount:0,totalKeys:0};let w=0,h=0;N.forEach(x=>{T.forEach(L=>{w++;const I=E.value.intl?.[L]?.[x];I&&I.trim()&&h++})});const y=w>0?Math.round(h/w*100):100,v=w-h;return{percentage:y,missingCount:v,totalKeys:N.length}}),g=()=>{!e.value.type||e.value.index<0||!t.value||ot(e.value.type,e.value.index,{...t.value})},C=()=>{if(a.value.active)a.value={active:!1,featureType:"weatherFeatures",draft:null};else{if(!e.value.type||e.value.index<0)return;Kt(e.value.type,e.value.index)}},j=()=>{const p=l.value;if(!p)return;const _=a.value.active;if(!_&&(!e.value.type||e.value.index<0)||!p.presentation||!Array.isArray(p.items)||p.items.length===0)return;const N=p.presentation==="single"&&p.items.length===1;if(p.name!==void 0&&p.name!==null&&!p.name.trim()&&!N||p.id!==void 0&&p.id!==null&&!p.id.trim()&&!N||p.items.filter(S=>!S.id?.trim()||!S.name?.trim()).length>0)return;const h=p.items.map(S=>S.id.trim()),y=h.filter((S,P)=>h.indexOf(S)!==P);if(y.length>0){te(`❌ Duplicate item IDs found: ${[...new Set(y)].join(", ")}`);return}if(p.presentation==="multiple"){const S=p.items.filter(ve=>!ve.name?.trim()),P=p.name?.trim();if(S.length>0&&!P)return}if(p.items.filter(S=>!S.layersIds||S.layersIds.length===0).length>0)return;const x=new Set((E.value.layers||[]).map(S=>S.id)),L=new Set;if(p.items.forEach(S=>{(S.layersIds||[]).forEach(P=>{x.has(P)||L.add(P)})}),L.size>0){te(`❌ Invalid layer IDs: ${Array.from(L).join(", ")}`);return}const I=jr(E.value,p),F=JSON.parse(JSON.stringify(I));if(_){const S=a.value.featureType==="weatherFeatures"?F.weatherFeatures:F.features;S.push(JSON.parse(JSON.stringify(p)));const P=a.value.featureType,ve=S.length-1;a.value={active:!1,featureType:"weatherFeatures",draft:null},setTimeout(()=>{Vn(P,ve)},0)}else e.value.type&&(F[e.value.type][e.value.index]=JSON.parse(JSON.stringify(p)),Kt(e.value.type,e.value.index));z(F)},O=p=>{if(a.value.active){const _=a.value.draft||dn();a.value={...a.value,draft:{..._,...p}}}else{if(!e.value.type||e.value.index<0)return;const _=l.value||t.value;ot(e.value.type,e.value.index,{..._,...p})}},$=p=>{if(a.value.active)a.value={...a.value,draft:p};else{if(!e.value.type||e.value.index<0)return;ot(e.value.type,e.value.index,p)}},b=()=>{const p=e.value.type==="features"?"features":"weatherFeatures";a.value={active:!0,featureType:p,draft:dn()}},A=()=>{if(!e.value.type||e.value.index<0||!i.value)return;const p=i.value,_=e.value.type,N={...p,id:p.id?`${p.id}_copy`:"",name:p.name?`${p.name} (Copy)`:"",items:(p.items||[]).map(w=>({...w,id:w.id?`${w.id}_copy`:"",name:w.name?`${w.name} (Copy)`:"",layersIds:[...w.layersIds||[]]}))};a.value={active:!0,featureType:_,draft:N}};return r("div",{className:"flex flex-col h-full",children:[r("div",{className:"flex flex-wrap gap-2 mb-3 items-center flex-shrink-0",children:[r("div",{children:[r("span",{className:"text-slate-500",children:a.value.active?"Create New Feature":s.value?"Edit Feature":"Feature Details"}),i.value&&r("div",{className:"text-xs text-slate-400 mt-0.5",children:a.value.active?`New ${a.value.featureType==="weatherFeatures"?"Weather":"General"} Feature`:`${o.value} ${u.value!==o.value&&`(${u.value})`}`}),a.value.active&&r("div",{className:"flex items-center gap-2 mt-2",children:[r("label",{className:"text-xs text-slate-400",children:"Category"}),r("select",{className:"form-select text-xs py-1 px-2",value:a.value.featureType,onChange:p=>{const _=p.target.value;a.value={...a.value,featureType:_}},children:[r("option",{value:"weatherFeatures",children:"Weather"}),r("option",{value:"features",children:"General"})]})]})]}),r("div",{className:"ml-auto flex gap-2",children:[!s.value&&e.value.type&&e.value.index>=0&&r(V,{children:[r("button",{className:"btn small",onClick:b,children:"New Feature"}),r("button",{className:"btn small",onClick:A,children:"Clone Feature"}),r("button",{className:"btn small",onClick:g,children:"Edit"})]}),!s.value&&(!e.value.type||e.value.index<0)&&r("button",{className:"btn small",onClick:b,children:"New Feature"}),s.value&&r(V,{children:[r("button",{className:"btn success small",onClick:j,children:a.value.active?"Create Feature":"Save"}),r("button",{className:"btn ghost small",onClick:C,children:"Cancel"})]})]})]}),i.value?r(V,{children:[r("div",{className:"flex gap-1 mb-3 border-b border-slate-700 pb-2 flex-shrink-0",children:zl.map(p=>r("button",{className:`px-3 py-1.5 rounded-t-md text-xs transition-all duration-150 flex items-center gap-2 ${n.value===p.id?"bg-blue-500 text-white":"bg-slate-950 text-slate-500 border border-slate-700 hover:border-slate-600 hover:text-slate-200"}`,onClick:()=>n.value=p.id,children:[r("span",{children:p.label}),p.id==="intl"&&m.value.totalKeys>0&&r("span",{className:`text-xs px-1.5 py-0.5 rounded-full ${m.value.percentage===100?"bg-green-600 text-white":m.value.percentage>50?"bg-yellow-600 text-white":"bg-red-600 text-white"}`,children:[m.value.percentage,"%"]})]},p.id))}),r("div",{className:"flex-1 overflow-hidden",children:[n.value==="details"&&r("div",{className:"h-full overflow-auto",children:[r(ur,{validation:c.value,className:"mb-4"}),d.value&&s.value&&r("div",{className:"bg-blue-900/30 border border-blue-500/50 rounded p-3 mb-4",children:r("div",{className:"flex items-start gap-2",children:[r("div",{className:"text-blue-400 text-sm",children:"💡"}),r("div",{className:"flex-1",children:[r("div",{className:"text-blue-300 text-sm font-medium mb-1",children:"Single Item Feature Detected"}),r("div",{className:"text-blue-200 text-xs mb-2",children:"For single-item features, you can leave Feature ID and Name empty to inherit from the item."}),r("button",{className:"btn tiny",onClick:()=>{O({id:"",name:""})},children:"Clear Feature Fields"})]})]})}),r("div",{className:"layer-section",children:[r("div",{className:"form-group",children:[r("label",{className:"form-label",children:"Feature ID"}),r("input",{type:"text",className:"form-input",value:i.value.id||"",onChange:p=>O({id:p.target.value}),placeholder:i.value.presentation==="single"?"Leave empty to use first item ID":"e.g. icing_index, radar, wind_60min",disabled:!s.value}),r("div",{className:"text-xs text-slate-500 mt-1",children:i.value.presentation==="single"?"Optional - will inherit from first item if empty":"Optional unique identifier for this feature group"})]}),r("div",{className:"form-group",children:[r("label",{className:"form-label",children:"Feature Name"}),r("input",{type:"text",className:"form-input",value:i.value.name||"",onChange:p=>O({name:p.target.value}),placeholder:i.value.presentation==="single"?"Leave empty to use first item name":"e.g. Weather Layers, Navigation Features",disabled:!s.value}),r("div",{className:"text-xs text-slate-500 mt-1",children:i.value.presentation==="single"?"Optional - will inherit from first item if empty":"Optional display name for this feature group"})]}),r("div",{className:"form-group",children:[r("label",{className:"form-label",children:"Presentation"}),r("select",{className:"form-select",value:i.value.presentation,onChange:p=>O({presentation:p.target.value}),disabled:!s.value,children:[r("option",{value:"single",children:"Single"}),r("option",{value:"multiple",children:"Multiple"})]}),r("div",{className:"text-xs text-slate-500 mt-1",children:i.value.presentation==="single"?r(V,{children:[r("span",{className:"font-medium text-blue-300",children:"Single:"})," Only one item can be selected.",f.value&&r("span",{className:"text-blue-300",children:" Feature can inherit from item."})]}):r(V,{children:[r("span",{className:"font-medium text-green-300",children:"Multiple:"})," Multiple items can be selected. Feature should have its own name."]})})]}),i.value.presentation==="multiple"&&r("div",{className:"form-group",children:[r("label",{className:"form-label",children:"Mutually Exclusive"}),r("div",{children:[r("input",{type:"checkbox",className:"form-checkbox",checked:!!i.value.mutuallyExclusive,onChange:p=>O({mutuallyExclusive:p.target.checked}),disabled:!s.value}),r("span",{className:"text-slate-200 text-sm",children:"Only one item selectable at a time"})]}),r("div",{className:"text-xs text-slate-500 mt-1",children:"When enabled, selecting one item automatically deselects others"})]}),r("div",{className:"form-group",children:[r("label",{className:"form-label",children:["Items",(i.value.items||[]).length===0&&r("span",{className:"text-orange-400 text-xs ml-1",children:"(at least one required)"})]}),(i.value.items||[]).length===0?r("div",{className:"text-center p-4 border border-dashed border-slate-600 rounded bg-slate-900",children:[r("div",{className:"text-slate-400 text-sm mb-2",children:"No items defined"}),s.value&&r("button",{className:"btn small primary",onClick:()=>{O({items:[{id:"",name:"",showLegend:!1,layersIds:[]}]})},children:"Add First Item"})]}):r("div",{className:"space-y-2",children:[i.value&&(i.value.items||[]).map((p,_)=>r("div",{className:"border border-slate-600 rounded p-3 bg-slate-900",draggable:!!(s.value&&i.value&&(i.value.items||[]).length>1),onDragStart:N=>{!s.value||!N.dataTransfer||(N.dataTransfer.setData("text/plain",_.toString()),N.dataTransfer.effectAllowed="move")},onDragOver:N=>{!s.value||!N.dataTransfer||(N.preventDefault(),N.dataTransfer.dropEffect="move")},onDrop:N=>{if(!s.value||!N.dataTransfer||!i.value)return;N.preventDefault();const w=parseInt(N.dataTransfer.getData("text/plain"));if(w!==_){const h=[...i.value.items||[]],y=h[w];h.splice(w,1),h.splice(_,0,y),O({items:h})}},style:{opacity:(s.value&&i.value&&(i.value.items||[]).length>1,"1"),cursor:s.value&&i.value&&(i.value.items||[]).length>1?"grab":"default"},children:[r("div",{className:"flex items-center gap-2 mb-2",children:[s.value&&i.value&&(i.value.items||[]).length>1&&r("div",{className:"cursor-move text-slate-400 hover:text-slate-300 px-1 select-none",title:"Drag to reorder items",onMouseDown:N=>N.stopPropagation(),children:"⋮⋮"}),r("span",{className:"text-xs text-slate-400 font-mono",children:["#",_+1]}),r("div",{className:"flex-1",children:[r("div",{className:"text-sm font-medium",children:p.name||p.id||`Item ${_+1}`}),r("div",{className:"text-xs text-slate-500",children:["ID: ",p.id||"(empty)"," • Layers: ",(p.layersIds||[]).length," • Legend: ",p.showLegend?"Yes":"No"]})]}),s.value&&i.value&&r("button",{className:"btn tiny danger",onClick:()=>{if(!i.value)return;const N=[...i.value.items||[]];N.splice(_,1),O({items:N})},children:"×"})]}),s.value&&r("div",{className:"space-y-2 text-xs",children:[r("div",{className:"grid grid-cols-2 gap-2",children:[r("div",{children:[r("label",{className:"block text-slate-400 mb-1",children:"Item ID"}),r("input",{type:"text",className:"w-full px-2 py-1 text-xs bg-slate-800 border border-slate-600 rounded",value:p.id||"",onChange:N=>{if(!i.value)return;const w=[...i.value.items||[]];w[_]={...p,id:N.target.value},O({items:w})},placeholder:"e.g. icing_index"})]}),r("div",{children:[r("label",{className:"block text-slate-400 mb-1",children:"Item Name"}),r("input",{type:"text",className:"w-full px-2 py-1 text-xs bg-slate-800 border border-slate-600 rounded",value:p.name||"",onChange:N=>{if(!i.value)return;const w=[...i.value.items||[]];w[_]={...p,name:N.target.value},O({items:w})},placeholder:"e.g. Icing Index (60 min)"})]})]}),r("div",{children:[r("label",{className:"block text-slate-400 mb-1",children:"Layer IDs"}),r(Vl,{selectedLayerIds:p.layersIds||[],onChange:N=>{if(!i.value)return;const w=[...i.value.items||[]];w[_]={...p,layersIds:N},O({items:w})}})]}),r("div",{className:"flex items-center gap-2",children:[r("input",{type:"checkbox",className:"form-checkbox",checked:p.showLegend||!1,onChange:N=>{if(!i.value)return;const w=[...i.value.items||[]];w[_]={...p,showLegend:N.target.checked},O({items:w})}}),r("span",{className:"text-slate-400",children:"Show Legend"})]}),p.showLegend&&r("div",{className:"grid grid-cols-2 gap-2 mt-2",children:[r("div",{className:"col-span-2",children:[r("label",{className:"block text-slate-400 mb-1",children:"Legend URL (optional)"}),r("input",{type:"text",className:"w-full px-2 py-1 text-xs bg-slate-800 border border-slate-600 rounded",value:p.legendUrl||"",onChange:N=>{if(!i.value)return;const w=[...i.value.items||[]];w[_]={...p,legendUrl:N.target.value},O({items:w})},placeholder:"https://example.com/legend.png"})]}),r("div",{className:"col-span-2",children:[r("label",{className:"block text-slate-400 mb-1",children:"Legend Description Key (optional)"}),r("input",{type:"text",className:"w-full px-2 py-1 text-xs bg-slate-800 border border-slate-600 rounded",value:p.legendDescription||"",onChange:N=>{if(!i.value)return;const w=[...i.value.items||[]];w[_]={...p,legendDescription:N.target.value},O({items:w})},placeholder:"translation.key.for.legend_description"}),r("div",{className:"text-xs text-slate-500 mt-1",children:"Appears in i18n panel as a translatable key"})]})]})]})]},_)),i.value&&i.value.presentation!=="single"&&r("button",{className:"btn small w-full",onClick:()=>{if(s.value||g(),!i.value)return;const p={id:"",name:"",showLegend:!1,layersIds:[]};O({items:[...i.value.items||[],p]})},children:"+ Add Another Item"})]})]})]})]}),n.value==="intl"&&i.value&&r("div",{className:"h-full",children:r(Rl,{feature:i.value,isEditing:s.value},`${e.value.type??"none"}:${e.value.index}:${s.value?"edit":"view"}`)}),n.value==="json"&&r("div",{className:"h-full min-h-0",children:r(Tt,{title:"Selected Feature JSON",value:i.value,onChange:$,readOnly:!s.value,height:"100%"},`${e.value.type??"none"}:${e.value.index}:${s.value?"edit":"view"}`)})]})]}):r("div",{className:"text-center p-5 text-slate-500 flex-1 flex items-center justify-center",children:a.value.active?"Creating new feature...":"Select a feature on the left to view/edit"})]})}function Bl(){const e=D(()=>Rr.value),t=e.value.missingLayers.length,n=e.value.unusedLayers.length,a=Object.entries(e.value.missingIntl).map(([l,s])=>({lang:l,count:s.length})).filter(l=>l.count>0);return!t&&!n&&a.length===0?null:r("div",{className:"fixed bottom-0 left-0 right-0 bg-slate-800 border-t border-slate-700 p-2 px-3 text-xs flex gap-3 items-center z-10",children:[t>0&&r("span",{className:`pill ${t>0?"bad":"ok"}`,children:["Missing layers: ",t]}),n>0&&r("span",{className:`pill ${n>0?"warn":"ok"}`,children:["Unused layers: ",n]}),a.map(({lang:l,count:s})=>r("span",{className:`pill ${s>0?"warn":"ok"}`,children:[l," missing: ",s]},l)),e.value.missingLayers.length>0&&r("div",{className:"text-slate-500 text-[10px]",children:["Missing: ",e.value.missingLayers.join(", ")]}),e.value.unusedLayers.length>0&&r("div",{className:"text-slate-500 text-[10px]",children:["Unused: ",e.value.unusedLayers.join(", ")]})]})}function Gl(){const e=D(()=>E.value),t=W(""),n=W(!1),a=W("any"),l=K(()=>{try{return[...Xe(e.value)].sort()}catch{return[]}},[e.value]),s=K(()=>{const o=t.value.toLowerCase().trim(),u=a.value,c=(f,d)=>{const m=e.value.intl?.[d]?.[f];return m===void 0||m===""};return l.filter(f=>{if(o){const d=f.toLowerCase().includes(o),m=T.some(g=>(e.value.intl?.[g]?.[f]||"").toLowerCase().includes(o));if(!d&&!m)return!1}if(n.value){if(u==="any"){if(!T.some(d=>c(f,d)))return!1}else if(!c(f,u))return!1}return!0})},[l,t.value,n.value,a.value,e.value]),i=(o,u,c)=>{const f={...e.value,intl:{...e.value.intl}};f.intl[u]={...f.intl[u]||{},[o]:c},z(f)};return l.length===0?r("div",{className:"p-4 text-center text-slate-500",children:"No translation keys found"}):r("div",{children:[r("div",{className:"flex gap-2 items-center mb-3",children:[r("button",{className:"btn small",onClick:zn,children:"Fill missing from EN"}),r("input",{type:"text",className:"form-input",placeholder:"Search keys or translations…",value:t.value,onInput:o=>t.value=o.target.value}),r("label",{className:"flex items-center gap-2 text-xs text-slate-400",children:[r("input",{type:"checkbox",checked:n.value,onChange:o=>n.value=o.target.checked}),"Show missing only"]}),r("select",{className:"form-select text-xs",value:a.value,onChange:o=>a.value=o.target.value,children:[r("option",{value:"any",children:"Any language"}),T.map(o=>r("option",{value:o,children:o.toUpperCase()},o))]})]}),r("div",{className:"overflow-auto",children:r("table",{className:"w-full text-sm border-collapse",children:[r("thead",{children:r("tr",{children:[r("th",{className:"text-left p-2 border-b border-slate-700 sticky top-0 bg-slate-800",children:"Key"}),T.map(o=>r("th",{className:"text-left p-2 border-b border-slate-700 sticky top-0 bg-slate-800",children:o.toUpperCase()},o))]})}),r("tbody",{children:s.map(o=>r("tr",{className:"align-top",children:[r("td",{className:"p-2 border-b border-slate-800 text-slate-300 whitespace-nowrap",children:o}),T.map(u=>r("td",{className:"p-2 border-b border-slate-800 min-w-[220px]",children:r("input",{type:"text",className:"form-input w-full",value:e.value.intl?.[u]?.[o]??"",onInput:c=>i(o,u,c.target.value),placeholder:`[${u}] ${o}`})},u))]},o))})]})})]})}function Yl({translationKey:e,isSelected:t,onSelect:n}){const a=D(()=>E.value),l=K(()=>T.reduce((i,o)=>{const u=a.value.intl?.[o]?.[e];return i+(u===void 0||u===""?1:0)},0),[e,a.value]),s=K(()=>T.some(i=>{const o=a.value.intl?.[i]?.[e];return o!==void 0&&o!==""}),[e,a.value]);return r("div",{className:`feature-list-item ${t?"selected":""}`,onClick:n,children:[r("div",{className:"feature-info",children:[r("div",{className:"feature-name",children:e}),r("div",{className:"feature-details",children:[T.length-l,"/",T.length," languages",l>0&&` • ${l} missing`,!s&&" • No translations"]})]}),r("div",{className:"feature-actions",children:[l>0&&r("span",{className:"pill warn",children:["Missing ",l]}),!s&&r("span",{className:"pill bad",children:"Empty"}),l===0&&s&&r("span",{className:"pill ok",children:"Complete"})]})]})}function Zl({title:e,keys:t,selectedKey:n,onSelectKey:a}){return r("details",{open:!0,className:"feature-category",children:[r("summary",{className:"feature-category-header",children:e}),r("div",{className:"feature-category-content",children:t.length===0?r("div",{className:"p-3 text-slate-500 text-center",children:["No ",e.toLowerCase()," found"]}):t.map(l=>r(Yl,{translationKey:l,isSelected:n===l,onSelect:()=>a(l)},l))})]})}function Ql({selectedKey:e,onSelectKey:t}){const n=D(()=>E.value),a=W(""),l=W(!1),s=W("any"),i=K(()=>{try{return[...Xe(n.value)].sort()}catch{return[]}},[n.value]),o=K(()=>{const c=a.value.toLowerCase().trim(),f=s.value,d=(m,g)=>{const C=n.value.intl?.[g]?.[m];return C===void 0||C===""};return i.filter(m=>{if(c){const g=m.toLowerCase().includes(c),C=T.some(j=>(n.value.intl?.[j]?.[m]||"").toLowerCase().includes(c));if(!g&&!C)return!1}if(l.value){if(f==="any"){if(!T.some(g=>d(m,g)))return!1}else if(!d(m,f))return!1}return!0})},[i,a.value,l.value,s.value,n.value]),u=K(()=>{const c={"Weather Features":[],"General Features":[],Layers:[],Other:[]};return o.forEach(f=>{f.includes("weather")||f.includes("radar")||f.includes("wind")||f.includes("cloud")?c["Weather Features"].push(f):f.includes("layer")||f.includes("overlay")?c.Layers.push(f):f.includes("feature")||f.includes("item")?c["General Features"].push(f):c.Other.push(f)}),c},[o]);return i.length===0?r("div",{children:[r("div",{className:"mb-3",children:r("button",{className:"btn primary",disabled:!0,children:"No Translation Keys Found"})}),r("div",{className:"p-4 text-center text-slate-500",children:"Load a JSON file with translation keys to get started"})]}):r("div",{children:[r("div",{className:"mb-3",children:r("button",{className:"btn primary",onClick:zn,children:"🌐 Fill Missing from EN"})}),r("div",{className:"flex flex-col gap-2 items-stretch mb-3",children:[r("input",{type:"text",className:"form-input",placeholder:"Search keys or translations…",value:a.value,onInput:c=>a.value=c.target.value}),r("div",{className:"flex gap-2 items-center",children:[r("label",{className:"flex items-center gap-2 text-xs text-slate-400",children:[r("input",{type:"checkbox",checked:l.value,onChange:c=>l.value=c.target.checked}),"Show missing only"]}),r("select",{className:"form-select text-xs flex-1",value:s.value,onChange:c=>s.value=c.target.value,children:[r("option",{value:"any",children:"Any language"}),T.map(c=>r("option",{value:c,children:c.toUpperCase()},c))]})]})]}),r("div",{className:"feature-browser",children:Object.entries(u).map(([c,f])=>f.length>0&&r(Zl,{title:c,keys:f,selectedKey:e,onSelectKey:t},c))})]})}function Xl({selectedKey:e}){const t=D(()=>E.value),n=K(()=>{if(!e)return null;const o={};return T.forEach(u=>{o[u]=t.value.intl?.[u]?.[e]??""}),o},[e,t.value]),a=K(()=>n?T.filter(o=>n[o]===void 0||n[o]===""):[],[n]),l=(o,u)=>{if(!e)return;const c={...t.value,intl:{...t.value.intl}};c.intl[o]={...c.intl[o]||{},[e]:u},z(c)},s=()=>{if(!e||!n)return;const o=n.en;if(!o)return;const u={...t.value,intl:{...t.value.intl}};a.forEach(c=>{u.intl[c]||(u.intl[c]={}),u.intl[c][e]=o}),z(u)},i=()=>{if(!e||!confirm("Are you sure you want to clear all translations for this key?"))return;const o={...t.value,intl:{...t.value.intl}};T.forEach(u=>{o.intl[u]&&o.intl[u][e]&&delete o.intl[u][e]}),z(o)};return e?n?r("div",{className:"h-full flex flex-col",children:[r("div",{className:"mb-4",children:[r("h3",{className:"text-lg font-medium text-slate-200 mb-1",children:"Translation Editor"}),r("div",{className:"flex items-center gap-2",children:[r("code",{className:"inline text-slate-400",children:e}),a.length>0&&r("span",{className:"pill warn",children:[a.length," missing"]}),a.length===0&&r("span",{className:"pill ok",children:"Complete"})]})]}),r("div",{className:"flex gap-2 mb-4",children:[a.length>0&&n.en&&r("button",{className:"btn small",onClick:s,children:"Fill missing from EN"}),r("button",{className:"btn danger small",onClick:i,children:"Clear all"})]}),r("div",{className:"flex-1 overflow-y-auto",children:r("div",{className:"space-y-4",children:T.map(o=>r("div",{className:"form-group",children:[r("label",{className:"form-label flex items-center gap-2",children:[r("span",{className:"font-mono text-xs bg-slate-700 px-2 py-1 rounded",children:o.toUpperCase()}),o==="en"&&r("span",{className:"text-slate-500 text-xs",children:"(Default)"}),a.includes(o)&&r("span",{className:"text-yellow-500 text-xs",children:"• Missing"})]}),r("textarea",{className:"form-textarea",rows:3,value:n[o],onInput:u=>l(o,u.target.value),placeholder:`Enter ${o.toUpperCase()} translation for "${e}"`}),o==="en"&&n[o]&&r("div",{className:"form-help",children:"This will be used as fallback for missing translations"})]},o))})}),r("div",{className:"mt-4 pt-4 border-t border-slate-700",children:r("div",{className:"text-xs text-slate-500",children:[r("div",{className:"mb-1",children:[r("strong",{children:"Translation Status:"})," ",T.length-a.length,"/",T.length," languages"]}),a.length>0&&r("div",{children:[r("strong",{children:"Missing:"})," ",a.map(o=>o.toUpperCase()).join(", ")]})]})})]}):r("div",{className:"h-full flex items-center justify-center",children:r("div",{className:"text-center text-slate-500",children:[r("div",{className:"text-6xl mb-4",children:"⚠️"}),r("div",{className:"text-lg font-medium mb-2",children:"Error Loading Translations"}),r("div",{className:"text-sm",children:"Unable to load translation data for this key"})]})}):r("div",{className:"h-full flex flex-col",children:[r("div",{className:"mb-4",children:[r("h3",{className:"text-lg font-medium text-slate-200 mb-2",children:"Translation Editor"}),r("p",{className:"text-slate-500 text-sm",children:"Select a translation key from the left panel to edit its translations."})]}),r("div",{className:"flex-1 flex items-center justify-center",children:r("div",{className:"text-center text-slate-500",children:[r("div",{className:"text-6xl mb-4",children:"🌐"}),r("div",{className:"text-lg font-medium mb-2",children:"No Key Selected"}),r("div",{className:"text-sm",children:"Choose a translation key to start editing"})]})})]})}function es(){const e=D(()=>E.value.layers?.map(n=>n.id).filter(Boolean)||[]),t=D(()=>ne.value.customLogicLayers);return r("div",{className:"max-h-[calc(100vh-180px)] overflow-auto",children:[r("div",{className:"mb-4",children:[r("h3",{className:"text-lg font-semibold mb-2",children:"Application Settings"}),r("p",{className:"text-sm text-slate-400 mb-4",children:"Configure layers with custom logic that are referenced in your application code."})]}),r("div",{className:"space-y-4",children:[r("div",{children:[r("h4",{className:"font-medium mb-3",children:"Referenced Layers"}),r("p",{className:"text-sm text-slate-400 mb-3",children:'Layers marked as "referenced" are used in your application code (Dart) and should be handled differently during validation.'}),r("div",{className:"space-y-3",children:[r("div",{className:"p-3 bg-slate-700 rounded",children:[r("div",{className:"text-sm font-medium mb-2",children:"Current Referenced Layers:"}),t.value.size===0?r("div",{className:"text-slate-400 text-sm italic",children:"None"}):r("div",{className:"font-mono text-sm text-blue-300",children:Array.from(t.value).join(", ")})]}),r("div",{className:"p-3 bg-slate-700 rounded",children:[r("div",{className:"text-sm font-medium mb-2",children:"Available Layers:"}),e.value.length===0?r("div",{className:"text-slate-400 text-sm",children:"No layers found. Add some layers first."}):r("div",{className:"flex flex-wrap gap-2",children:e.value.map(n=>r("button",{onClick:()=>Fr(n),className:`px-2 py-1 rounded text-xs font-mono transition-colors ${we(n)?"bg-blue-600 text-white hover:bg-blue-700":"bg-slate-600 text-slate-300 hover:bg-slate-500"}`,children:[we(n)?"✓ ":"+ ",n]},n))})]})]})]}),r("div",{className:"mt-6 p-3 bg-slate-700 rounded text-sm",children:[r("h5",{className:"font-medium mb-2",children:'What does "Referenced" mean?'}),r("ul",{className:"text-slate-400 space-y-1 text-xs",children:[r("li",{children:"• Layer is referenced/used in your Dart application code"}),r("li",{children:"• Layer should be handled differently during validation"}),r("li",{children:"• Layer appears with visual indicators throughout the UI"}),r("li",{children:"• Settings are saved locally in your browser"})]})]}),t.value.size>0&&r("div",{className:"mt-4 p-3 bg-blue-900/20 border border-blue-700 rounded text-sm",children:[r("h5",{className:"font-medium mb-2 text-blue-300",children:["Referenced Layers (",t.value.size,")"]}),r("div",{className:"flex flex-wrap gap-1",children:Array.from(t.value).map(n=>r("span",{className:"font-mono text-xs bg-blue-600 text-white px-2 py-1 rounded",children:n},n))})]})]})]})}function ts({onOpenClick:e}){return r("div",{className:"flex items-center justify-center min-h-[60vh]",onPaste:s=>{const i=s.clipboardData?.getData("text");if(i)try{const o=JSON.parse(i),u=yt(o);z(u);const c=o.map_layers!==void 0;te(`✅ JSON pasted from clipboard${c?" (extracted from map_layers)":""}`)}catch{}},children:r("div",{className:"w-full max-w-2xl text-center p-8 border border-dashed border-slate-600 rounded-xl bg-slate-900/40",onDrop:s=>{s.preventDefault();const o=Array.from(s.dataTransfer?.files||[]).find(u=>u.type==="application/json"||u.name.endsWith(".json"));if(o){const u=new FileReader;u.onload=c=>{const f=c.target?.result;if(f)try{const d=JSON.parse(f),m=yt(d);z(m);const g=d.map_layers!==void 0;te(`✅ JSON file loaded successfully${g?" (extracted from map_layers)":""}`)}catch{}},u.readAsText(o)}},onDragOver:s=>{s.preventDefault()},children:[r("h2",{className:"text-lg mb-2 text-slate-100",children:"Get Started"}),r("p",{className:"mb-4 text-slate-400",children:"Choose an option to begin"}),r("div",{className:"flex flex-col gap-2 items-center",children:[r("button",{className:"btn primary",onClick:()=>{z(kt())},children:"Start with Empty Structure"}),r("button",{className:"btn",onClick:e,children:"Open Existing JSON…"})]}),r("div",{className:"mt-4 text-xs text-slate-500",children:"Tip: You can also drop JSON files here or paste JSON"})]})})}const ns=[{id:"features",label:"Features"},{id:"layers",label:"Layers"},{id:"internationalization",label:"i18n"},{id:"json",label:"JSON"},{id:"settings",label:"Settings"}];function rs(){const e=R(null),t=W(null),n=W("split");Y(()=>{Le.value||Hr()},[]);const a=()=>{e.current?.click()};return r("div",{className:"app",children:[r("input",{ref:e,type:"file",accept:"application/json,.json",style:{display:"none"},onChange:l=>{const s=l.target.files?.[0];if(s){const i=new FileReader;i.onload=o=>{const u=o.target?.result;if(u)try{const c=JSON.parse(u),f=yt(c);z(f);const d=c.map_layers!==void 0;te(`✅ JSON file loaded successfully${d?" (extracted from map_layers)":""}`)}catch(c){te(`❌ Invalid JSON: ${c instanceof Error?c.message:"Parse error"}`)}},i.readAsText(s)}}}),Le.value&&r("header",{className:"flex gap-3 items-center p-3 border-b border-slate-700 sticky top-0 z-[5]",style:{background:"rgba(15, 17, 21, 0.9)",backdropFilter:"saturate(1.2) blur(6px)"},children:[r("h1",{className:"text-base m-0 mr-2 opacity-95",children:"Map Layers JSON Editor"}),r("button",{className:"btn",onClick:a,children:"Open JSON…"}),r("div",{className:"ml-auto",children:Le.value&&r("span",{className:"text-slate-500",children:Wr.value})})]}),Le.value?r("div",{className:"p-3 min-h-[calc(100vh-80px)]",children:[r("div",{className:"flex gap-1 mb-3 border-b border-slate-700 pb-2",children:ns.map(l=>r("button",{className:`px-4 py-2 rounded-t-md text-xs transition-all duration-150 text-decoration-none ${de.value===l.id?"bg-blue-500 text-white border-blue-500":"bg-slate-950 text-slate-500 border border-slate-700 hover:border-slate-600 hover:text-slate-200"}`,onClick:()=>de.value=l.id,children:l.label},l.id))}),de.value==="features"&&r("div",{className:"flex gap-3 h-[calc(100vh-200px)] overflow-hidden",children:[r("div",{className:"flex-1 min-w-0 bg-slate-800 border border-slate-700 rounded-xl p-3 flex flex-col",children:r(Fl,{})}),r("div",{className:"flex-1 min-w-0 bg-slate-800 border border-slate-700 rounded-xl p-3 flex flex-col",children:r(Kl,{})})]}),de.value==="layers"&&r("div",{className:"flex gap-3 h-[calc(100vh-200px)] overflow-hidden",children:[r("div",{className:"flex-1 min-w-0 bg-slate-800 border border-slate-700 rounded-xl p-3 flex flex-col",children:r(Ml,{})}),r("div",{className:"flex-1 min-w-0 bg-slate-800 border border-slate-700 rounded-xl p-3 flex flex-col",children:r(Jl,{})})]}),de.value==="internationalization"&&r("div",{children:[r("div",{className:"flex gap-1 mb-3 border-b border-slate-700 pb-2",children:[r("button",{className:`px-3 py-1.5 rounded text-xs transition-all duration-150 ${n.value==="split"?"bg-blue-500 text-white":"bg-slate-800 text-slate-500 border border-slate-700 hover:border-slate-600 hover:text-slate-200"}`,onClick:()=>n.value="split",children:"Split View"}),r("button",{className:`px-3 py-1.5 rounded text-xs transition-all duration-150 ${n.value==="table"?"bg-blue-500 text-white":"bg-slate-800 text-slate-500 border border-slate-700 hover:border-slate-600 hover:text-slate-200"}`,onClick:()=>n.value="table",children:"Table View"})]}),n.value==="split"&&r("div",{className:"flex gap-3 h-[calc(100vh-200px)] overflow-hidden",children:[r("div",{className:"flex-1 min-w-0 bg-slate-800 border border-slate-700 rounded-xl p-3 flex flex-col",children:r("div",{className:"flex-1 min-h-0 overflow-auto",children:r(Ql,{selectedKey:t.value,onSelectKey:l=>t.value=l})})}),r("div",{className:"flex-1 min-w-0 bg-slate-800 border border-slate-700 rounded-xl p-3 flex flex-col",children:r(Xl,{selectedKey:t.value})})]}),n.value==="table"&&r("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-3 flex flex-col h-[calc(100vh-200px)]",children:r("div",{className:"flex-1 min-h-0",children:r(Gl,{})})})]}),de.value==="json"&&r("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-3 flex flex-col h-[calc(100vh-180px)]",children:[r("div",{className:"flex-1 min-h-0",children:r(Tt,{title:"Complete JSON Configuration",value:E.value,onChange:l=>{z(l)},height:"100%"})}),r("div",{className:"flex gap-2 mt-3 pt-3 border-t border-slate-700 flex-shrink-0",children:[r("button",{className:"btn small",onClick:()=>{const l=Tr(JSON.stringify(E.value));l.valid||te(`❌ Validation failed: ${l.errors.length} error(s), ${l.warnings.length} warning(s)`)},children:"Validate Structure"}),r("button",{className:"btn success small",onClick:()=>{try{const l=JSON.stringify(E.value,null,2),s=new Date().toISOString().slice(0,19).replace(/[:.]/g,"-");Or(`map-layers-${s}.json`,l),te("✅ JSON file downloaded")}catch{}},children:"Download JSON"})]})]}),de.value==="settings"&&r("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-3",children:r(es,{})})]}):r("div",{className:"p-6",children:r(ts,{onOpenClick:a})}),r(Bl,{})]})}xe(r(rs,{}),document.getElementById("app"));
