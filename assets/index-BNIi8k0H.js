(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))r(l);new MutationObserver(l=>{for(const s of l)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(l){const s={};return l.integrity&&(s.integrity=l.integrity),l.referrerPolicy&&(s.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?s.credentials="include":l.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(l){if(l.ep)return;l.ep=!0;const s=n(l);fetch(l.href,s)}})();var Ae,E,dn,fn,fe,Mt,pn,hn,vn,Nt,pt,ht,mn,Fe={},gn=[],fr=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,je=Array.isArray;function ee(e,t){for(var n in t)e[n]=t[n];return e}function wt(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function se(e,t,n){var r,l,s,i={};for(s in t)s=="key"?r=t[s]:s=="ref"?l=t[s]:i[s]=t[s];if(arguments.length>2&&(i.children=arguments.length>3?Ae.call(arguments,2):n),typeof e=="function"&&e.defaultProps!=null)for(s in e.defaultProps)i[s]===void 0&&(i[s]=e.defaultProps[s]);return De(e,i,r,l,null)}function De(e,t,n,r,l){var s={type:e,props:t,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:l??++dn,__i:-1,__u:0};return l==null&&E.vnode!=null&&E.vnode(s),s}function pr(){return{current:null}}function V(e){return e.children}function X(e,t){this.props=e,this.context=t}function be(e,t){if(t==null)return e.__?be(e.__,e.__i+1):null;for(var n;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null)return n.__e;return typeof e.type=="function"?be(e):null}function _n(e){var t,n;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null){e.__e=e.__c.base=n.__e;break}return _n(e)}}function vt(e){(!e.__d&&(e.__d=!0)&&fe.push(e)&&!Ke.__r++||Mt!=E.debounceRendering)&&((Mt=E.debounceRendering)||pn)(Ke)}function Ke(){for(var e,t,n,r,l,s,i,o=1;fe.length;)fe.length>o&&fe.sort(hn),e=fe.shift(),o=fe.length,e.__d&&(n=void 0,l=(r=(t=e).__v).__e,s=[],i=[],t.__P&&((n=ee({},r)).__v=r.__v+1,E.vnode&&E.vnode(n),St(t.__P,n,r,t.__n,t.__P.namespaceURI,32&r.__u?[l]:null,s,l??be(r),!!(32&r.__u),i),n.__v=r.__v,n.__.__k[n.__i]=n,xn(s,n,i),n.__e!=l&&_n(n)));Ke.__r=0}function yn(e,t,n,r,l,s,i,o,d,c,f){var u,v,g,$,T,C,k=r&&r.__k||gn,x=t.length;for(d=hr(n,t,k,d,x),u=0;u<x;u++)(g=n.__k[u])!=null&&(v=g.__i==-1?Fe:k[g.__i]||Fe,g.__i=u,C=St(e,g,v,l,s,i,o,d,c,f),$=g.__e,g.ref&&v.ref!=g.ref&&(v.ref&&Ct(v.ref,null,g),f.push(g.ref,g.__c||$,g)),T==null&&$!=null&&(T=$),4&g.__u||v.__k===g.__k?d=bn(g,d,e):typeof g.type=="function"&&C!==void 0?d=C:$&&(d=$.nextSibling),g.__u&=-7);return n.__e=T,d}function hr(e,t,n,r,l){var s,i,o,d,c,f=n.length,u=f,v=0;for(e.__k=new Array(l),s=0;s<l;s++)(i=t[s])!=null&&typeof i!="boolean"&&typeof i!="function"?(d=s+v,(i=e.__k[s]=typeof i=="string"||typeof i=="number"||typeof i=="bigint"||i.constructor==String?De(null,i,null,null,null):je(i)?De(V,{children:i},null,null,null):i.constructor==null&&i.__b>0?De(i.type,i.props,i.key,i.ref?i.ref:null,i.__v):i).__=e,i.__b=e.__b+1,o=null,(c=i.__i=vr(i,n,d,u))!=-1&&(u--,(o=n[c])&&(o.__u|=2)),o==null||o.__v==null?(c==-1&&(l>f?v--:l<f&&v++),typeof i.type!="function"&&(i.__u|=4)):c!=d&&(c==d-1?v--:c==d+1?v++:(c>d?v--:v++,i.__u|=4))):e.__k[s]=null;if(u)for(s=0;s<f;s++)(o=n[s])!=null&&!(2&o.__u)&&(o.__e==r&&(r=be(o)),wn(o,o));return r}function bn(e,t,n){var r,l;if(typeof e.type=="function"){for(r=e.__k,l=0;r&&l<r.length;l++)r[l]&&(r[l].__=e,t=bn(r[l],t,n));return t}e.__e!=t&&(t&&e.type&&!n.contains(t)&&(t=be(e)),n.insertBefore(e.__e,t||null),t=e.__e);do t=t&&t.nextSibling;while(t!=null&&t.nodeType==8);return t}function ae(e,t){return t=t||[],e==null||typeof e=="boolean"||(je(e)?e.some(function(n){ae(n,t)}):t.push(e)),t}function vr(e,t,n,r){var l,s,i,o=e.key,d=e.type,c=t[n],f=c!=null&&(2&c.__u)==0;if(c===null&&e.key==null||f&&o==c.key&&d==c.type)return n;if(r>(f?1:0)){for(l=n-1,s=n+1;l>=0||s<t.length;)if((c=t[i=l>=0?l--:s++])!=null&&!(2&c.__u)&&o==c.key&&d==c.type)return i}return-1}function At(e,t,n){t[0]=="-"?e.setProperty(t,n??""):e[t]=n==null?"":typeof n!="number"||fr.test(t)?n:n+"px"}function Re(e,t,n,r,l){var s,i;e:if(t=="style")if(typeof n=="string")e.style.cssText=n;else{if(typeof r=="string"&&(e.style.cssText=r=""),r)for(t in r)n&&t in n||At(e.style,t,"");if(n)for(t in n)r&&n[t]==r[t]||At(e.style,t,n[t])}else if(t[0]=="o"&&t[1]=="n")s=t!=(t=t.replace(vn,"$1")),i=t.toLowerCase(),t=i in e||t=="onFocusOut"||t=="onFocusIn"?i.slice(2):t.slice(2),e.l||(e.l={}),e.l[t+s]=n,n?r?n.u=r.u:(n.u=Nt,e.addEventListener(t,s?ht:pt,s)):e.removeEventListener(t,s?ht:pt,s);else{if(l=="http://www.w3.org/2000/svg")t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!="width"&&t!="height"&&t!="href"&&t!="list"&&t!="form"&&t!="tabIndex"&&t!="download"&&t!="rowSpan"&&t!="colSpan"&&t!="role"&&t!="popover"&&t in e)try{e[t]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&t[4]!="-"?e.removeAttribute(t):e.setAttribute(t,t=="popover"&&n==1?"":n))}}function jt(e){return function(t){if(this.l){var n=this.l[t.type+e];if(t.t==null)t.t=Nt++;else if(t.t<n.u)return;return n(E.event?E.event(t):t)}}}function St(e,t,n,r,l,s,i,o,d,c){var f,u,v,g,$,T,C,k,x,O,h,N,w,p,y,m,_,b=t.type;if(t.constructor!=null)return null;128&n.__u&&(d=!!(32&n.__u),s=[o=t.__e=n.__e]),(f=E.__b)&&f(t);e:if(typeof b=="function")try{if(k=t.props,x="prototype"in b&&b.prototype.render,O=(f=b.contextType)&&r[f.__c],h=f?O?O.props.value:f.__:r,n.__c?C=(u=t.__c=n.__c).__=u.__E:(x?t.__c=u=new b(k,h):(t.__c=u=new X(k,h),u.constructor=b,u.render=gr),O&&O.sub(u),u.props=k,u.state||(u.state={}),u.context=h,u.__n=r,v=u.__d=!0,u.__h=[],u._sb=[]),x&&u.__s==null&&(u.__s=u.state),x&&b.getDerivedStateFromProps!=null&&(u.__s==u.state&&(u.__s=ee({},u.__s)),ee(u.__s,b.getDerivedStateFromProps(k,u.__s))),g=u.props,$=u.state,u.__v=t,v)x&&b.getDerivedStateFromProps==null&&u.componentWillMount!=null&&u.componentWillMount(),x&&u.componentDidMount!=null&&u.__h.push(u.componentDidMount);else{if(x&&b.getDerivedStateFromProps==null&&k!==g&&u.componentWillReceiveProps!=null&&u.componentWillReceiveProps(k,h),!u.__e&&u.shouldComponentUpdate!=null&&u.shouldComponentUpdate(k,u.__s,h)===!1||t.__v==n.__v){for(t.__v!=n.__v&&(u.props=k,u.state=u.__s,u.__d=!1),t.__e=n.__e,t.__k=n.__k,t.__k.some(function(S){S&&(S.__=t)}),N=0;N<u._sb.length;N++)u.__h.push(u._sb[N]);u._sb=[],u.__h.length&&i.push(u);break e}u.componentWillUpdate!=null&&u.componentWillUpdate(k,u.__s,h),x&&u.componentDidUpdate!=null&&u.__h.push(function(){u.componentDidUpdate(g,$,T)})}if(u.context=h,u.props=k,u.__P=e,u.__e=!1,w=E.__r,p=0,x){for(u.state=u.__s,u.__d=!1,w&&w(t),f=u.render(u.props,u.state,u.context),y=0;y<u._sb.length;y++)u.__h.push(u._sb[y]);u._sb=[]}else do u.__d=!1,w&&w(t),f=u.render(u.props,u.state,u.context),u.state=u.__s;while(u.__d&&++p<25);u.state=u.__s,u.getChildContext!=null&&(r=ee(ee({},r),u.getChildContext())),x&&!v&&u.getSnapshotBeforeUpdate!=null&&(T=u.getSnapshotBeforeUpdate(g,$)),m=f,f!=null&&f.type===V&&f.key==null&&(m=Nn(f.props.children)),o=yn(e,je(m)?m:[m],t,n,r,l,s,i,o,d,c),u.base=t.__e,t.__u&=-161,u.__h.length&&i.push(u),C&&(u.__E=u.__=null)}catch(S){if(t.__v=null,d||s!=null)if(S.then){for(t.__u|=d?160:128;o&&o.nodeType==8&&o.nextSibling;)o=o.nextSibling;s[s.indexOf(o)]=null,t.__e=o}else{for(_=s.length;_--;)wt(s[_]);mt(t)}else t.__e=n.__e,t.__k=n.__k,S.then||mt(t);E.__e(S,t,n)}else s==null&&t.__v==n.__v?(t.__k=n.__k,t.__e=n.__e):o=t.__e=mr(n.__e,t,n,r,l,s,i,d,c);return(f=E.diffed)&&f(t),128&t.__u?void 0:o}function mt(e){e&&e.__c&&(e.__c.__e=!0),e&&e.__k&&e.__k.forEach(mt)}function xn(e,t,n){for(var r=0;r<n.length;r++)Ct(n[r],n[++r],n[++r]);E.__c&&E.__c(t,e),e.some(function(l){try{e=l.__h,l.__h=[],e.some(function(s){s.call(l)})}catch(s){E.__e(s,l.__v)}})}function Nn(e){return typeof e!="object"||e==null||e.__b&&e.__b>0?e:je(e)?e.map(Nn):ee({},e)}function mr(e,t,n,r,l,s,i,o,d){var c,f,u,v,g,$,T,C=n.props,k=t.props,x=t.type;if(x=="svg"?l="http://www.w3.org/2000/svg":x=="math"?l="http://www.w3.org/1998/Math/MathML":l||(l="http://www.w3.org/1999/xhtml"),s!=null){for(c=0;c<s.length;c++)if((g=s[c])&&"setAttribute"in g==!!x&&(x?g.localName==x:g.nodeType==3)){e=g,s[c]=null;break}}if(e==null){if(x==null)return document.createTextNode(k);e=document.createElementNS(l,x,k.is&&k),o&&(E.__m&&E.__m(t,s),o=!1),s=null}if(x==null)C===k||o&&e.data==k||(e.data=k);else{if(s=s&&Ae.call(e.childNodes),C=n.props||Fe,!o&&s!=null)for(C={},c=0;c<e.attributes.length;c++)C[(g=e.attributes[c]).name]=g.value;for(c in C)if(g=C[c],c!="children"){if(c=="dangerouslySetInnerHTML")u=g;else if(!(c in k)){if(c=="value"&&"defaultValue"in k||c=="checked"&&"defaultChecked"in k)continue;Re(e,c,null,g,l)}}for(c in k)g=k[c],c=="children"?v=g:c=="dangerouslySetInnerHTML"?f=g:c=="value"?$=g:c=="checked"?T=g:o&&typeof g!="function"||C[c]===g||Re(e,c,g,C[c],l);if(f)o||u&&(f.__html==u.__html||f.__html==e.innerHTML)||(e.innerHTML=f.__html),t.__k=[];else if(u&&(e.innerHTML=""),yn(t.type=="template"?e.content:e,je(v)?v:[v],t,n,r,x=="foreignObject"?"http://www.w3.org/1999/xhtml":l,s,i,s?s[0]:n.__k&&be(n,0),o,d),s!=null)for(c=s.length;c--;)wt(s[c]);o||(c="value",x=="progress"&&$==null?e.removeAttribute("value"):$!=null&&($!==e[c]||x=="progress"&&!$||x=="option"&&$!=C[c])&&Re(e,c,$,C[c],l),c="checked",T!=null&&T!=e[c]&&Re(e,c,T,C[c],l))}return e}function Ct(e,t,n){try{if(typeof e=="function"){var r=typeof e.__u=="function";r&&e.__u(),r&&t==null||(e.__u=e(t))}else e.current=t}catch(l){E.__e(l,n)}}function wn(e,t,n){var r,l;if(E.unmount&&E.unmount(e),(r=e.ref)&&(r.current&&r.current!=e.__e||Ct(r,null,t)),(r=e.__c)!=null){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(s){E.__e(s,t)}r.base=r.__P=null}if(r=e.__k)for(l=0;l<r.length;l++)r[l]&&wn(r[l],t,n||typeof e.type!="function");n||wt(e.__e),e.__c=e.__=e.__e=void 0}function gr(e,t,n){return this.constructor(e,n)}function xe(e,t,n){var r,l,s,i;t==document&&(t=document.documentElement),E.__&&E.__(e,t),l=(r=typeof n=="function")?null:n&&n.__k||t.__k,s=[],i=[],St(t,e=(!r&&n||t).__k=se(V,null,[e]),l||Fe,Fe,t.namespaceURI,!r&&n?[n]:l?null:t.firstChild?Ae.call(t.childNodes):null,s,!r&&n?n:l?l.__e:t.firstChild,r,i),xn(s,e,i)}function Sn(e,t){xe(e,t,Sn)}function _r(e,t,n){var r,l,s,i,o=ee({},e.props);for(s in e.type&&e.type.defaultProps&&(i=e.type.defaultProps),t)s=="key"?r=t[s]:s=="ref"?l=t[s]:o[s]=t[s]===void 0&&i!=null?i[s]:t[s];return arguments.length>2&&(o.children=arguments.length>3?Ae.call(arguments,2):n),De(e.type,o,r||e.key,l||e.ref,null)}function yr(e){function t(n){var r,l;return this.getChildContext||(r=new Set,(l={})[t.__c]=this,this.getChildContext=function(){return l},this.componentWillUnmount=function(){r=null},this.shouldComponentUpdate=function(s){this.props.value!=s.value&&r.forEach(function(i){i.__e=!0,vt(i)})},this.sub=function(s){r.add(s);var i=s.componentWillUnmount;s.componentWillUnmount=function(){r&&r.delete(s),i&&i.call(s)}}),n.children}return t.__c="__cC"+mn++,t.__=e,t.Provider=t.__l=(t.Consumer=function(n,r){return n.children(r)}).contextType=t,t}Ae=gn.slice,E={__e:function(e,t,n,r){for(var l,s,i;t=t.__;)if((l=t.__c)&&!l.__)try{if((s=l.constructor)&&s.getDerivedStateFromError!=null&&(l.setState(s.getDerivedStateFromError(e)),i=l.__d),l.componentDidCatch!=null&&(l.componentDidCatch(e,r||{}),i=l.__d),i)return l.__E=l}catch(o){e=o}throw e}},dn=0,fn=function(e){return e!=null&&e.constructor==null},X.prototype.setState=function(e,t){var n;n=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=ee({},this.state),typeof e=="function"&&(e=e(ee({},n),this.props)),e&&ee(n,e),e!=null&&this.__v&&(t&&this._sb.push(t),vt(this))},X.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),vt(this))},X.prototype.render=V,fe=[],pn=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,hn=function(e,t){return e.__v.__b-t.__v.__b},Ke.__r=0,vn=/(PointerCapture)$|Capture$/i,Nt=0,pt=jt(!1),ht=jt(!0),mn=0;var br=0;function a(e,t,n,r,l,s){t||(t={});var i,o,d=t;if("ref"in d)for(o in d={},t)o=="ref"?i=t[o]:d[o]=t[o];var c={type:e,props:d,key:n,ref:i,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--br,__i:-1,__u:0,__source:l,__self:s};if(typeof e=="function"&&(i=e.defaultProps))for(o in i)d[o]===void 0&&(d[o]=i[o]);return E.vnode&&E.vnode(c),c}var ce,P,st,Pt,Ne=0,Cn=[],U=E,Ut=U.__b,Rt=U.__r,Jt=U.diffed,Vt=U.__c,Wt=U.unmount,qt=U.__;function Se(e,t){U.__h&&U.__h(P,e,Ne||t),Ne=0;var n=P.__H||(P.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({}),n.__[e]}function he(e){return Ne=1,$t(Dn,e)}function $t(e,t,n){var r=Se(ce++,2);if(r.t=e,!r.__c&&(r.__=[n?n(t):Dn(void 0,t),function(o){var d=r.__N?r.__N[0]:r.__[0],c=r.t(d,o);d!==c&&(r.__N=[c,r.__[1]],r.__c.setState({}))}],r.__c=P,!P.__f)){var l=function(o,d,c){if(!r.__c.__H)return!0;var f=r.__c.__H.__.filter(function(v){return!!v.__c});if(f.every(function(v){return!v.__N}))return!s||s.call(this,o,d,c);var u=r.__c.props!==o;return f.forEach(function(v){if(v.__N){var g=v.__[0];v.__=v.__N,v.__N=void 0,g!==v.__[0]&&(u=!0)}}),s&&s.call(this,o,d,c)||u};P.__f=!0;var s=P.shouldComponentUpdate,i=P.componentWillUpdate;P.componentWillUpdate=function(o,d,c){if(this.__e){var f=s;s=void 0,l(o,d,c),s=f}i&&i.call(this,o,d,c)},P.shouldComponentUpdate=l}return r.__N||r.__}function Z(e,t){var n=Se(ce++,3);!U.__s&&Lt(n.__H,t)&&(n.__=e,n.u=t,P.__H.__h.push(n))}function Pe(e,t){var n=Se(ce++,4);!U.__s&&Lt(n.__H,t)&&(n.__=e,n.u=t,P.__h.push(n))}function R(e){return Ne=5,z(function(){return{current:e}},[])}function $n(e,t,n){Ne=6,Pe(function(){if(typeof e=="function"){var r=e(t());return function(){e(null),r&&typeof r=="function"&&r()}}if(e)return e.current=t(),function(){return e.current=null}},n==null?n:n.concat(e))}function z(e,t){var n=Se(ce++,7);return Lt(n.__H,t)&&(n.__=e(),n.__H=t,n.__h=e),n.__}function Te(e,t){return Ne=8,z(function(){return e},t)}function Ln(e){var t=P.context[e.__c],n=Se(ce++,9);return n.c=e,t?(n.__==null&&(n.__=!0,t.sub(P)),t.props.value):e.__}function On(e,t){U.useDebugValue&&U.useDebugValue(t?t(e):e)}function In(){var e=Se(ce++,11);if(!e.__){for(var t=P.__v;t!==null&&!t.__m&&t.__!==null;)t=t.__;var n=t.__m||(t.__m=[0,0]);e.__="P"+n[0]+"-"+n[1]++}return e.__}function xr(){for(var e;e=Cn.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(qe),e.__H.__h.forEach(gt),e.__H.__h=[]}catch(t){e.__H.__h=[],U.__e(t,e.__v)}}U.__b=function(e){P=null,Ut&&Ut(e)},U.__=function(e,t){e&&t.__k&&t.__k.__m&&(e.__m=t.__k.__m),qt&&qt(e,t)},U.__r=function(e){Rt&&Rt(e),ce=0;var t=(P=e.__c).__H;t&&(st===P?(t.__h=[],P.__h=[],t.__.forEach(function(n){n.__N&&(n.__=n.__N),n.u=n.__N=void 0})):(t.__h.forEach(qe),t.__h.forEach(gt),t.__h=[],ce=0)),st=P},U.diffed=function(e){Jt&&Jt(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(Cn.push(t)!==1&&Pt===U.requestAnimationFrame||((Pt=U.requestAnimationFrame)||Nr)(xr)),t.__H.__.forEach(function(n){n.u&&(n.__H=n.u),n.u=void 0})),st=P=null},U.__c=function(e,t){t.some(function(n){try{n.__h.forEach(qe),n.__h=n.__h.filter(function(r){return!r.__||gt(r)})}catch(r){t.some(function(l){l.__h&&(l.__h=[])}),t=[],U.__e(r,n.__v)}}),Vt&&Vt(e,t)},U.unmount=function(e){Wt&&Wt(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach(function(r){try{qe(r)}catch(l){t=l}}),n.__H=void 0,t&&U.__e(t,n.__v))};var Ht=typeof requestAnimationFrame=="function";function Nr(e){var t,n=function(){clearTimeout(r),Ht&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,35);Ht&&(t=requestAnimationFrame(n))}function qe(e){var t=P,n=e.__c;typeof n=="function"&&(e.__c=void 0,n()),P=t}function gt(e){var t=P;e.__c=e.__(),P=t}function Lt(e,t){return!e||e.length!==t.length||t.some(function(n,r){return n!==e[r]})}function Dn(e,t){return typeof t=="function"?t(e):t}var wr=Symbol.for("preact-signals");function Ot(){if(_e>1)_e--;else{for(var e,t=!1;Ee!==void 0;){var n=Ee;for(Ee=void 0,_t++;n!==void 0;){var r=n.o;if(n.o=void 0,n.f&=-3,!(8&n.f)&&Fn(n))try{n.c()}catch(l){t||(e=l,t=!0)}n=r}}if(_t=0,_e--,t)throw e}}var A=void 0;function En(e){var t=A;A=void 0;try{return e()}finally{A=t}}var Ee=void 0,_e=0,_t=0,Ge=0;function kn(e){if(A!==void 0){var t=e.n;if(t===void 0||t.t!==A)return t={i:0,S:e,p:A.s,n:void 0,t:A,e:void 0,x:void 0,r:t},A.s!==void 0&&(A.s.n=t),A.s=t,e.n=t,32&A.f&&e.S(t),t;if(t.i===-1)return t.i=0,t.n!==void 0&&(t.n.p=t.p,t.p!==void 0&&(t.p.n=t.n),t.p=A.s,t.n=void 0,A.s.n=t,A.s=t),t}}function H(e,t){this.v=e,this.i=0,this.n=void 0,this.t=void 0,this.W=t?.watched,this.Z=t?.unwatched}H.prototype.brand=wr;H.prototype.h=function(){return!0};H.prototype.S=function(e){var t=this,n=this.t;n!==e&&e.e===void 0&&(e.x=n,this.t=e,n!==void 0?n.e=e:En(function(){var r;(r=t.W)==null||r.call(t)}))};H.prototype.U=function(e){var t=this;if(this.t!==void 0){var n=e.e,r=e.x;n!==void 0&&(n.x=r,e.e=void 0),r!==void 0&&(r.e=n,e.x=void 0),e===this.t&&(this.t=r,r===void 0&&En(function(){var l;(l=t.Z)==null||l.call(t)}))}};H.prototype.subscribe=function(e){var t=this;return Dt(function(){var n=t.value,r=A;A=void 0;try{e(n)}finally{A=r}})};H.prototype.valueOf=function(){return this.value};H.prototype.toString=function(){return this.value+""};H.prototype.toJSON=function(){return this.value};H.prototype.peek=function(){var e=A;A=void 0;try{return this.value}finally{A=e}};Object.defineProperty(H.prototype,"value",{get:function(){var e=kn(this);return e!==void 0&&(e.i=this.i),this.v},set:function(e){if(e!==this.v){if(_t>100)throw new Error("Cycle detected");this.v=e,this.i++,Ge++,_e++;try{for(var t=this.t;t!==void 0;t=t.x)t.t.N()}finally{Ot()}}}});function Q(e,t){return new H(e,t)}function Fn(e){for(var t=e.s;t!==void 0;t=t.n)if(t.S.i!==t.i||!t.S.h()||t.S.i!==t.i)return!0;return!1}function Tn(e){for(var t=e.s;t!==void 0;t=t.n){var n=t.S.n;if(n!==void 0&&(t.r=n),t.S.n=t,t.i=-1,t.n===void 0){e.s=t;break}}}function Mn(e){for(var t=e.s,n=void 0;t!==void 0;){var r=t.p;t.i===-1?(t.S.U(t),r!==void 0&&(r.n=t.n),t.n!==void 0&&(t.n.p=r)):n=t,t.S.n=t.r,t.r!==void 0&&(t.r=void 0),t=r}e.s=n}function ve(e,t){H.call(this,void 0),this.x=e,this.s=void 0,this.g=Ge-1,this.f=4,this.W=t?.watched,this.Z=t?.unwatched}ve.prototype=new H;ve.prototype.h=function(){if(this.f&=-3,1&this.f)return!1;if((36&this.f)==32||(this.f&=-5,this.g===Ge))return!0;if(this.g=Ge,this.f|=1,this.i>0&&!Fn(this))return this.f&=-2,!0;var e=A;try{Tn(this),A=this;var t=this.x();(16&this.f||this.v!==t||this.i===0)&&(this.v=t,this.f&=-17,this.i++)}catch(n){this.v=n,this.f|=16,this.i++}return A=e,Mn(this),this.f&=-2,!0};ve.prototype.S=function(e){if(this.t===void 0){this.f|=36;for(var t=this.s;t!==void 0;t=t.n)t.S.S(t)}H.prototype.S.call(this,e)};ve.prototype.U=function(e){if(this.t!==void 0&&(H.prototype.U.call(this,e),this.t===void 0)){this.f&=-33;for(var t=this.s;t!==void 0;t=t.n)t.S.U(t)}};ve.prototype.N=function(){if(!(2&this.f)){this.f|=6;for(var e=this.t;e!==void 0;e=e.x)e.t.N()}};Object.defineProperty(ve.prototype,"value",{get:function(){if(1&this.f)throw new Error("Cycle detected");var e=kn(this);if(this.h(),e!==void 0&&(e.i=this.i),16&this.f)throw this.v;return this.v}});function ue(e,t){return new ve(e,t)}function An(e){var t=e.u;if(e.u=void 0,typeof t=="function"){_e++;var n=A;A=void 0;try{t()}catch(r){throw e.f&=-2,e.f|=8,It(e),r}finally{A=n,Ot()}}}function It(e){for(var t=e.s;t!==void 0;t=t.n)t.S.U(t);e.x=void 0,e.s=void 0,An(e)}function Sr(e){if(A!==this)throw new Error("Out-of-order effect");Mn(this),A=e,this.f&=-2,8&this.f&&It(this),Ot()}function Ce(e){this.x=e,this.u=void 0,this.s=void 0,this.o=void 0,this.f=32}Ce.prototype.c=function(){var e=this.S();try{if(8&this.f||this.x===void 0)return;var t=this.x();typeof t=="function"&&(this.u=t)}finally{e()}};Ce.prototype.S=function(){if(1&this.f)throw new Error("Cycle detected");this.f|=1,this.f&=-9,An(this),Tn(this),_e++;var e=A;return A=this,Sr.bind(this,e)};Ce.prototype.N=function(){2&this.f||(this.f|=2,this.o=Ee,Ee=this)};Ce.prototype.d=function(){this.f|=8,1&this.f||It(this)};Ce.prototype.dispose=function(){this.d()};function Dt(e){var t=new Ce(e);try{t.c()}catch(r){throw t.d(),r}var n=t.d.bind(t);return n[Symbol.dispose]=n,n}var Qe,it;function $e(e,t){E[e]=t.bind(null,E[e]||function(){})}function Ze(e){it&&it(),it=e&&e.S()}function jn(e){var t=this,n=e.data,r=J(n);r.value=n;var l=z(function(){for(var s=t.__v;s=s.__;)if(s.__c){s.__c.__$f|=4;break}return t.__$u.c=function(){var i,o=t.__$u.S(),d=l.value;o(),fn(d)||((i=t.base)==null?void 0:i.nodeType)!==3?(t.__$f|=1,t.setState({})):t.base.data=d},ue(function(){var i=r.value.value;return i===0?0:i===!0?"":i||""})},[]);return l.value}jn.displayName="_st";Object.defineProperties(H.prototype,{constructor:{configurable:!0,value:void 0},type:{configurable:!0,value:jn},props:{configurable:!0,get:function(){return{data:this}}},__b:{configurable:!0,value:1}});$e("__b",function(e,t){if(typeof t.type=="string"){var n,r=t.props;for(var l in r)if(l!=="children"){var s=r[l];s instanceof H&&(n||(t.__np=n={}),n[l]=s,r[l]=s.peek())}}e(t)});$e("__r",function(e,t){Ze();var n,r=t.__c;r&&(r.__$f&=-2,(n=r.__$u)===void 0&&(r.__$u=n=function(l){var s;return Dt(function(){s=this}),s.c=function(){r.__$f|=1,r.setState({})},s}())),Qe=r,Ze(n),e(t)});$e("__e",function(e,t,n,r){Ze(),Qe=void 0,e(t,n,r)});$e("diffed",function(e,t){Ze(),Qe=void 0;var n;if(typeof t.type=="string"&&(n=t.__e)){var r=t.__np,l=t.props;if(r){var s=n.U;if(s)for(var i in s){var o=s[i];o!==void 0&&!(i in r)&&(o.d(),s[i]=void 0)}else n.U=s={};for(var d in r){var c=s[d],f=r[d];c===void 0?(c=Cr(n,d,f,l),s[d]=c):c.o(f,l)}}}e(t)});function Cr(e,t,n,r){var l=t in e&&e.ownerSVGElement===void 0,s=Q(n);return{o:function(i,o){s.value=i,r=o},d:Dt(function(){var i=s.value.value;r[t]!==i&&(r[t]=i,l?e[t]=i:i?e.setAttribute(t,i):e.removeAttribute(t))})}}$e("unmount",function(e,t){if(typeof t.type=="string"){var n=t.__e;if(n){var r=n.U;if(r){n.U=void 0;for(var l in r){var s=r[l];s&&s.d()}}}}else{var i=t.__c;if(i){var o=i.__$u;o&&(i.__$u=void 0,o.d())}}e(t)});$e("__h",function(e,t,n,r){(r<3||r===9)&&(t.__$f|=2),e(t,n,r)});X.prototype.shouldComponentUpdate=function(e,t){var n=this.__$u,r=n&&n.s!==void 0;for(var l in t)return!0;if(this.__f||typeof this.u=="boolean"&&this.u===!0){if(!(r||2&this.__$f||4&this.__$f)||1&this.__$f)return!0}else if(!(r||4&this.__$f)||3&this.__$f)return!0;for(var s in e)if(s!=="__source"&&e[s]!==this.props[s])return!0;for(var i in this.props)if(!(i in e))return!0;return!1};function J(e){return z(function(){return Q(e)},[])}function I(e){var t=R(e);return t.current=e,Qe.__$f|=4,z(function(){return ue(function(){return t.current()})},[])}const $r=e=>{try{return[JSON.parse(e),null]}catch(t){return[null,t instanceof Error?t.message:"Parse error"]}},Xe=e=>{const t=new Set,n=l=>{l&&typeof l=="string"&&t.add(l)},r=l=>{for(const s of l||[]){s.id&&n(s.id);for(const i of s.items||[])i.id&&n(i.id),i.legendDescription&&n(i.legendDescription)}};return r(e.weatherFeatures),r(e.features),t},Et=e=>{const t=new Set,n=r=>{for(const l of r||[])for(const s of l.items||[])for(const i of s.layersIds||[])t.add(i)};return n(e.weatherFeatures),n(e.features),t},Lr=(e,t)=>{const n=[],r=(l,s)=>{l.forEach((i,o)=>{(i.items||[]).forEach((d,c)=>{(d.layersIds||[]).includes(t)&&n.push({featureType:s,featureIndex:o,featureName:i.name||i.id||`${s} ${o+1}`,itemIndex:c,itemName:d.name||d.id||`Item ${c+1}`})})})};return r(e.weatherFeatures,"weatherFeatures"),r(e.features,"features"),n},Or=(e,t,n="application/json")=>{const r=new Blob([t],{type:n}),l=URL.createObjectURL(r),s=document.createElement("a");s.href=l,s.download=e,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(l)},Pn=()=>({weatherFeatures:[],features:[],layers:[],intl:{en:{},da:{},nb:{},sv:{}}}),Un="hemswx-map-editor-settings",Ir={customLogicLayers:new Set(["aviation_obstacle"])},Dr=()=>{try{const e=localStorage.getItem(Un);if(e){const t=JSON.parse(e);return{customLogicLayers:new Set(t.customLogicLayers||["aviation_obstacle"])}}}catch(e){console.warn("Failed to load settings:",e)}return{...Ir,customLogicLayers:new Set(["aviation_obstacle"])}},Rn=e=>{try{const t={customLogicLayers:Array.from(e.customLogicLayers)};localStorage.setItem(Un,JSON.stringify(t))}catch(t){console.warn("Failed to save settings:",t)}},ne=Q(Dr());ue(()=>ne.value.customLogicLayers);const Er=e=>{const t=new Set(ne.value.customLogicLayers);t.add(e);const n={...ne.value,customLogicLayers:t};ne.value=n,Rn(n)},kr=e=>{const t=new Set(ne.value.customLogicLayers);t.delete(e);const n={...ne.value,customLogicLayers:t};ne.value=n,Rn(n)},we=e=>ne.value.customLogicLayers.has(e),Fr=e=>{we(e)?kr(e):Er(e)},Tr=e=>{const[t,n]=$r(e);if(n)return{valid:!1,errors:[`JSON Parse Error: ${n}`],warnings:[]};const r=[],l=[];if(!t||typeof t!="object")return r.push("Root must be an object"),{valid:!1,errors:r,warnings:l};const s=["weatherFeatures","features","layers"];for(const o of s)Array.isArray(t[o])||r.push(`Missing or invalid '${o}' array`);if(!t.intl||typeof t.intl!="object")r.push("Missing or invalid 'intl' object");else{const o=["en","da","nb","sv"];for(const d of o)(!t.intl[d]||typeof t.intl[d]!="object")&&l.push(`Missing or invalid '${d}' translations`)}[...t.weatherFeatures||[],...t.features||[]].forEach((o,d)=>{const c=d<(t.weatherFeatures?.length||0)?"weatherFeature":"feature",f=d<(t.weatherFeatures?.length||0)?d:d-(t.weatherFeatures?.length||0);(!o.presentation||!["single","multiple"].includes(o.presentation))&&r.push(`${c} ${f+1}: presentation field is required and must be "single" or "multiple"`),!o.items||!Array.isArray(o.items)?r.push(`${c} ${f+1}: items field is required and must be an array`):o.items.forEach((u,v)=>{(!u.id||typeof u.id!="string"||u.id.trim()==="")&&r.push(`${c} ${f+1}, item ${v+1}: id is required and cannot be empty`),(!u.name||typeof u.name!="string"||u.name.trim()==="")&&r.push(`${c} ${f+1}, item ${v+1}: name is required and cannot be empty`),(!u.layersIds||!Array.isArray(u.layersIds)||u.layersIds.length===0)&&r.push(`${c} ${f+1}, item ${v+1}: layersIds is required and must be a non-empty array`)})}),t.layers&&Array.isArray(t.layers)&&t.layers.forEach((o,d)=>{(!o.id||typeof o.id!="string"||o.id.trim()==="")&&r.push(`layer ${d+1}: id is required and cannot be empty`),!o.layers||!Array.isArray(o.layers)||o.layers.length===0?r.push(`layer ${d+1}: layers field is required and must be a non-empty array`):o.layers.forEach((c,f)=>{(!c.type||typeof c.type!="string")&&r.push(`layer ${d+1}, sublayer ${f+1}: type is required`),(!c.source||typeof c.source!="string"||c.source.trim()==="")&&r.push(`layer ${d+1}, sublayer ${f+1}: source is required and cannot be empty`)})});try{const o=Et(t),d=new Set((t.layers||[]).map(f=>f.id).filter(Boolean)),c=[...o].filter(f=>!d.has(f));c.length>0&&l.push(`Missing layer definitions: ${c.join(", ")}`)}catch{l.push("Could not validate layer references")}return{valid:r.length===0,errors:r,warnings:l}},Jn=e=>{try{const t=Et(e),n=new Set((e.layers||[]).map(f=>f.id)),r=ne.value.customLogicLayers,l=new Set([...t,...r]),s=[...t].filter(f=>!n.has(f)),i=[...n].filter(f=>!l.has(f)),o=Xe(e),d=Object.keys(e.intl||{}),c={};for(const f of d){const u=e.intl[f]||{};c[f]=[...o].filter(v=>!(v in u))}return{missingLayers:s,unusedLayers:i,missingIntl:c,weatherFeatureCount:e.weatherFeatures?.length||0,featureCount:e.features?.length||0,layerCount:e.layers?.length||0,languageCount:d.length}}catch(t){return console.warn("Error computing stats:",t),{missingLayers:[],unusedLayers:[],missingIntl:{},weatherFeatureCount:0,featureCount:0,layerCount:0,languageCount:0}}},Mr=e=>{const t=Jn(e);return`WF: ${t.weatherFeatureCount} • F: ${t.featureCount} • Layers: ${t.layerCount} • Langs: ${t.languageCount}`},M=["en","da","nb","sv"],Ar=(e,t)=>{const n={...e};n.intl||(n.intl={en:{},da:{},nb:{},sv:{}});const r=[];return t.id?.trim()&&r.push({key:t.id,defaultValue:t.name?.trim()||t.id}),(t.items||[]).forEach(l=>{l.id?.trim()&&r.push({key:l.id,defaultValue:l.name?.trim()||l.id}),l.legendDescription?.trim()&&r.push({key:l.legendDescription,defaultValue:l.legendDescription})}),M.forEach(l=>{n.intl[l]||(n.intl[l]={}),r.forEach(({key:s,defaultValue:i})=>{n.intl[l][s]||(l==="en"?n.intl[l][s]=i:n.intl[l][s]=n.intl.en[s]||i)})}),n},jr=e=>{const t={...e},n=t.intl?.en||{},r={},l=(o,d)=>{!r[o]&&d&&(r[o]=d)},s=o=>{for(const d of o||[]){d.id&&d.name&&l(d.id,d.name);for(const c of d.items||[])c.id&&c.name&&l(c.id,c.name),c.legendDescription&&l(c.legendDescription,n[c.legendDescription]||c.legendDescription)}};s(t.weatherFeatures),s(t.features);const i=new Set([...Xe(t)]);return t.intl||(t.intl={en:{},da:{},nb:{},sv:{}}),M.forEach(o=>{const d=t.intl[o]||{},c={};i.forEach(f=>{d[f]?c[f]=d[f]:o==="en"&&r[f]?c[f]=r[f]:n[f]?c[f]=n[f]:c[f]=f}),t.intl[o]=c}),t},yt=["wms","tiled","mapImage","portalItem","vectorTiled","feature"],Pr=e=>{const t={type:e,source:"",zIndex:0,options:{opacity:1}};switch(e){case"wms":return{...t,source:"https://example.com/wms",options:{layerNames:["layer1"],opacity:1}};case"tiled":return{...t,source:"https://example.com/tiles/{z}/{y}/{x}.png"};case"vectorTiled":return{...t,source:"https://example.com/vectortiles/{z}/{y}/{x}.pbf"};case"mapImage":return{...t,source:"https://example.com/arcgis/rest/services/MapServer"};case"feature":return{...t,source:"https://example.com/arcgis/rest/services/FeatureServer/0"};case"portalItem":return{...t,source:"portal-item-id",options:{layerId:0,opacity:1}};default:return t}},Ur=e=>{const t=[];if(yt.includes(e.type)||t.push(`Invalid layer type "${e.type}". Must be one of: ${yt.join(", ")}`),!e.source||e.source.trim()===""?t.push("Layer source is required and cannot be empty"):e.type==="portalItem"?(e.source.length<10||e.source.includes(" "))&&t.push("Portal item source should be a valid portal item ID (no spaces, at least 10 characters)"):e.type!=="portalItem"&&!e.source.startsWith("http")&&t.push(`${e.type.toUpperCase()} layers typically require a URL starting with http:// or https://`),e.type==="wms"){const n=e.options?.layerNames;(!n||!Array.isArray(n)||n.length===0)&&t.push("WMS layers require layerNames array in options (list of layer names to include)")}if(e.options?.opacity!==void 0){const n=e.options.opacity;(typeof n!="number"||n<0||n>1)&&t.push("Opacity (in options) must be a number between 0.0 (transparent) and 1.0 (opaque)")}return e.zIndex!==void 0&&!Number.isInteger(e.zIndex)&&t.push("Z-Index must be a whole number (determines layer stacking order)"),e.refreshInterval!==void 0&&(typeof e.refreshInterval!="number"||e.refreshInterval<0?t.push("Refresh interval must be a positive number (milliseconds)"):Number.isInteger(e.refreshInterval)||t.push("Refresh interval must be a whole number of milliseconds")),{valid:t.length===0,errors:t}},zt=e=>{const t=[];return!e.id||e.id.trim()===""?t.push("Layer ID is required and cannot be empty"):/^[a-zA-Z0-9_-]+$/.test(e.id.trim())||t.push("Layer ID can only contain letters, numbers, hyphens, and underscores"),(!e.layers||e.layers.length===0)&&t.push("Layer must contain at least one sublayer"),e.layers.forEach((n,r)=>{const l=Ur(n);l.valid||t.push(...l.errors.map(s=>`Sublayer ${r+1}: ${s}`))}),{valid:t.length===0,errors:t}},Rr=(e,t)=>{const n={...e},r=n.layers.findIndex(l=>l.id===t.id);return r>=0?(n.layers=[...n.layers],n.layers[r]=t):n.layers=[...n.layers,t],n},D=Q(Pn()),Le=Q(!1),Y=Q({type:null,index:-1}),le=Q({index:-1}),q=Q({}),pe=Q({weatherFeatures:{},features:{}}),de=Q("features"),Vn=Q("json");Q("en");ue(()=>JSON.stringify(D.value,null,2));const Jr=ue(()=>Jn(D.value)),Vr=ue(()=>Mr(D.value)),Wr=ue(()=>{const e=Y.value;return e.type===null||e.index<0?null:D.value[e.type][e.index]||null}),qr=ue(()=>{const e=le.value;return e.index<0?null:D.value.layers[e.index]||null}),W=e=>{D.value=e,Le.value=!0;try{localStorage.setItem("hemswx-last-json-data",JSON.stringify(e))}catch(r){console.warn("Failed to save JSON data to localStorage:",r)}const t=Y.value;if(t.type&&t.index>=0){const r=e[t.type];t.index>=r.length&&(Y.value={type:null,index:-1})}const n=le.value;n.index>=0&&n.index>=e.layers.length&&(le.value={index:-1})},Hr=()=>{try{const e=localStorage.getItem("hemswx-last-json-data");if(e){const t=JSON.parse(e);return W(t),te("✅ Last session data loaded"),!0}}catch(e){console.warn("Failed to load JSON data from localStorage:",e)}return!1},te=e=>{},Wn=(e,t)=>{Y.value={type:e,index:t},Vn.value="feature"},He=e=>{le.value={index:e},Vn.value="layer"},zr=e=>q.value[e],re=(e,t)=>{q.value={...q.value,[e]:t}},Je=e=>{const t={...q.value};delete t[e],q.value=t},Br=(e,t)=>pe.value[e][t],ot=(e,t,n)=>{pe.value={...pe.value,[e]:{...pe.value[e],[t]:n}}},Bt=(e,t)=>{const n={...pe.value[e]};delete n[t],pe.value={...pe.value,[e]:n}},qn=()=>{const e=jr(D.value);W(e)},Kr=(e,t)=>{const n={...D.value};n[e]=n[e].filter((l,s)=>s!==t),W(n);const r=Y.value;r.type===e&&r.index===t?Y.value={type:null,index:-1}:r.type===e&&r.index>t&&(Y.value={...r,index:r.index-1})},Gr=(e,t,n)=>{if(e===n)return;const r=JSON.parse(JSON.stringify(D.value)),[l]=r[e].splice(t,1);r[n].push(l),W(r);const s=r[n].length-1;Y.value={type:n,index:s}},ze=(e,t,n,r)=>{const l=[...D.value[e]],s=e===n?l:[...D.value[n]];if(t<0||t>=l.length||r<0||r>s.length)return;const[i]=l.splice(t,1),o=e===n&&t<r?r-1:r;s.splice(o,0,i);const d={...D.value,[e]:e===n?s:l,[n]:s};W(d),Y.value={type:n,index:o}},Hn=e=>{const t={...D.value};t.layers=t.layers.filter((r,l)=>l!==e),W(t);const n=le.value;n.index===e?le.value={index:-1}:n.index>e&&(le.value={index:n.index-1})};function Zr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Kt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function Gt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Kt(Object(n),!0).forEach(function(r){Zr(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Kt(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Yr(e,t){if(e==null)return{};var n={},r=Object.keys(e),l,s;for(s=0;s<r.length;s++)l=r[s],!(t.indexOf(l)>=0)&&(n[l]=e[l]);return n}function Qr(e,t){if(e==null)return{};var n=Yr(e,t),r,l;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(l=0;l<s.length;l++)r=s[l],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Xr(e,t){return ea(e)||ta(e,t)||na(e,t)||ra()}function ea(e){if(Array.isArray(e))return e}function ta(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var n=[],r=!0,l=!1,s=void 0;try{for(var i=e[Symbol.iterator](),o;!(r=(o=i.next()).done)&&(n.push(o.value),!(t&&n.length===t));r=!0);}catch(d){l=!0,s=d}finally{try{!r&&i.return!=null&&i.return()}finally{if(l)throw s}}return n}}function na(e,t){if(e){if(typeof e=="string")return Zt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Zt(e,t)}}function Zt(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ra(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aa(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Yt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function Qt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Yt(Object(n),!0).forEach(function(r){aa(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Yt(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function la(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(r){return t.reduceRight(function(l,s){return s(l)},r)}}function Oe(e){return function t(){for(var n=this,r=arguments.length,l=new Array(r),s=0;s<r;s++)l[s]=arguments[s];return l.length>=e.length?e.apply(this,l):function(){for(var i=arguments.length,o=new Array(i),d=0;d<i;d++)o[d]=arguments[d];return t.apply(n,[].concat(l,o))}}}function Ye(e){return{}.toString.call(e).includes("Object")}function sa(e){return!Object.keys(e).length}function Me(e){return typeof e=="function"}function ia(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function oa(e,t){return Ye(t)||oe("changeType"),Object.keys(t).some(function(n){return!ia(e,n)})&&oe("changeField"),t}function ca(e){Me(e)||oe("selectorType")}function ua(e){Me(e)||Ye(e)||oe("handlerType"),Ye(e)&&Object.values(e).some(function(t){return!Me(t)})&&oe("handlersType")}function da(e){e||oe("initialIsRequired"),Ye(e)||oe("initialType"),sa(e)&&oe("initialContent")}function fa(e,t){throw new Error(e[t]||e.default)}var pa={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},oe=Oe(fa)(pa),Ve={changes:oa,selector:ca,handler:ua,initial:da};function ha(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Ve.initial(e),Ve.handler(t);var n={current:e},r=Oe(ga)(n,t),l=Oe(ma)(n),s=Oe(Ve.changes)(e),i=Oe(va)(n);function o(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(f){return f};return Ve.selector(c),c(n.current)}function d(c){la(r,l,s,i)(c)}return[o,d]}function va(e,t){return Me(t)?t(e.current):t}function ma(e,t){return e.current=Qt(Qt({},e.current),t),t}function ga(e,t,n){return Me(t)?t(e.current):Object.keys(n).forEach(function(r){var l;return(l=t[r])===null||l===void 0?void 0:l.call(t,e.current[r])}),n}var _a={create:ha},ya={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.52.2/min/vs"}};function ba(e){return function t(){for(var n=this,r=arguments.length,l=new Array(r),s=0;s<r;s++)l[s]=arguments[s];return l.length>=e.length?e.apply(this,l):function(){for(var i=arguments.length,o=new Array(i),d=0;d<i;d++)o[d]=arguments[d];return t.apply(n,[].concat(l,o))}}}function xa(e){return{}.toString.call(e).includes("Object")}function Na(e){return e||Xt("configIsRequired"),xa(e)||Xt("configType"),e.urls?(wa(),{paths:{vs:e.urls.monacoBase}}):e}function wa(){console.warn(zn.deprecation)}function Sa(e,t){throw new Error(e[t]||e.default)}var zn={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},Xt=ba(Sa)(zn),Ca={config:Na},$a=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return function(l){return n.reduceRight(function(s,i){return i(s)},l)}};function Bn(e,t){return Object.keys(t).forEach(function(n){t[n]instanceof Object&&e[n]&&Object.assign(t[n],Bn(e[n],t[n]))}),Gt(Gt({},e),t)}var La={type:"cancelation",msg:"operation is manually canceled"};function ct(e){var t=!1,n=new Promise(function(r,l){e.then(function(s){return t?l(La):r(s)}),e.catch(l)});return n.cancel=function(){return t=!0},n}var Oa=_a.create({config:ya,isInitialized:!1,resolve:null,reject:null,monaco:null}),Kn=Xr(Oa,2),Ue=Kn[0],et=Kn[1];function Ia(e){var t=Ca.config(e),n=t.monaco,r=Qr(t,["monaco"]);et(function(l){return{config:Bn(l.config,r),monaco:n}})}function Da(){var e=Ue(function(t){var n=t.monaco,r=t.isInitialized,l=t.resolve;return{monaco:n,isInitialized:r,resolve:l}});if(!e.isInitialized){if(et({isInitialized:!0}),e.monaco)return e.resolve(e.monaco),ct(ut);if(window.monaco&&window.monaco.editor)return Gn(window.monaco),e.resolve(window.monaco),ct(ut);$a(Ea,Fa)(Ta)}return ct(ut)}function Ea(e){return document.body.appendChild(e)}function ka(e){var t=document.createElement("script");return e&&(t.src=e),t}function Fa(e){var t=Ue(function(r){var l=r.config,s=r.reject;return{config:l,reject:s}}),n=ka("".concat(t.config.paths.vs,"/loader.js"));return n.onload=function(){return e()},n.onerror=t.reject,n}function Ta(){var e=Ue(function(n){var r=n.config,l=n.resolve,s=n.reject;return{config:r,resolve:l,reject:s}}),t=window.require;t.config(e.config),t(["vs/editor/editor.main"],function(n){Gn(n),e.resolve(n)},function(n){e.reject(n)})}function Gn(e){Ue().monaco||et({monaco:e})}function Ma(){return Ue(function(e){var t=e.monaco;return t})}var ut=new Promise(function(e,t){return et({resolve:e,reject:t})}),Zn={config:Ia,init:Da,__getMonacoInstance:Ma};function Yn(e,t){for(var n in t)e[n]=t[n];return e}function bt(e,t){for(var n in e)if(n!=="__source"&&!(n in t))return!0;for(var r in t)if(r!=="__source"&&e[r]!==t[r])return!0;return!1}function Qn(e,t){var n=t(),r=he({t:{__:n,u:t}}),l=r[0].t,s=r[1];return Pe(function(){l.__=n,l.u=t,dt(l)&&s({t:l})},[e,n,t]),Z(function(){return dt(l)&&s({t:l}),e(function(){dt(l)&&s({t:l})})},[e]),n}function dt(e){var t,n,r=e.u,l=e.__;try{var s=r();return!((t=l)===(n=s)&&(t!==0||1/t==1/n)||t!=t&&n!=n)}catch{return!0}}function Xn(e){e()}function er(e){return e}function tr(){return[!1,Xn]}var nr=Pe;function xt(e,t){this.props=e,this.context=t}function tt(e,t){function n(l){var s=this.props.ref,i=s==l.ref;return!i&&s&&(s.call?s(null):s.current=null),t?!t(this.props,l)||!i:bt(this.props,l)}function r(l){return this.shouldComponentUpdate=n,se(e,l)}return r.displayName="Memo("+(e.displayName||e.name)+")",r.prototype.isReactComponent=!0,r.__f=!0,r}(xt.prototype=new X).isPureReactComponent=!0,xt.prototype.shouldComponentUpdate=function(e,t){return bt(this.props,e)||bt(this.state,t)};var en=E.__b;E.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),en&&en(e)};var Aa=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function ja(e){function t(n){var r=Yn({},n);return delete r.ref,e(r,n.ref||null)}return t.$$typeof=Aa,t.render=t,t.prototype.isReactComponent=t.__f=!0,t.displayName="ForwardRef("+(e.displayName||e.name)+")",t}var tn=function(e,t){return e==null?null:ae(ae(e).map(t))},Pa={map:tn,forEach:tn,count:function(e){return e?ae(e).length:0},only:function(e){var t=ae(e);if(t.length!==1)throw"Children.only";return t[0]},toArray:ae},Ua=E.__e;E.__e=function(e,t,n,r){if(e.then){for(var l,s=t;s=s.__;)if((l=s.__c)&&l.__c)return t.__e==null&&(t.__e=n.__e,t.__k=n.__k),l.__c(e,t)}Ua(e,t,n,r)};var nn=E.unmount;function rr(e,t,n){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach(function(r){typeof r.__c=="function"&&r.__c()}),e.__c.__H=null),(e=Yn({},e)).__c!=null&&(e.__c.__P===n&&(e.__c.__P=t),e.__c.__e=!0,e.__c=null),e.__k=e.__k&&e.__k.map(function(r){return rr(r,t,n)})),e}function ar(e,t,n){return e&&n&&(e.__v=null,e.__k=e.__k&&e.__k.map(function(r){return ar(r,t,n)}),e.__c&&e.__c.__P===t&&(e.__e&&n.appendChild(e.__e),e.__c.__e=!0,e.__c.__P=n)),e}function Be(){this.__u=0,this.o=null,this.__b=null}function lr(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function Ra(e){var t,n,r;function l(s){if(t||(t=e()).then(function(i){n=i.default||i},function(i){r=i}),r)throw r;if(!n)throw t;return se(n,s)}return l.displayName="Lazy",l.__f=!0,l}function Ie(){this.i=null,this.l=null}E.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&32&e.__u&&(e.type=null),nn&&nn(e)},(Be.prototype=new X).__c=function(e,t){var n=t.__c,r=this;r.o==null&&(r.o=[]),r.o.push(n);var l=lr(r.__v),s=!1,i=function(){s||(s=!0,n.__R=null,l?l(o):o())};n.__R=i;var o=function(){if(!--r.__u){if(r.state.__a){var d=r.state.__a;r.__v.__k[0]=ar(d,d.__c.__P,d.__c.__O)}var c;for(r.setState({__a:r.__b=null});c=r.o.pop();)c.forceUpdate()}};r.__u++||32&t.__u||r.setState({__a:r.__b=r.__v.__k[0]}),e.then(i,i)},Be.prototype.componentWillUnmount=function(){this.o=[]},Be.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=rr(this.__b,n,r.__O=r.__P)}this.__b=null}var l=t.__a&&se(V,null,e.fallback);return l&&(l.__u&=-33),[se(V,null,t.__a?null:e.children),l]};var rn=function(e,t,n){if(++n[1]===n[0]&&e.l.delete(t),e.props.revealOrder&&(e.props.revealOrder[0]!=="t"||!e.l.size))for(n=e.i;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.i=n=n[2]}};function Ja(e){return this.getChildContext=function(){return e.context},e.children}function Va(e){var t=this,n=e.h;if(t.componentWillUnmount=function(){xe(null,t.v),t.v=null,t.h=null},t.h&&t.h!==n&&t.componentWillUnmount(),!t.v){for(var r=t.__v;r!==null&&!r.__m&&r.__!==null;)r=r.__;t.h=n,t.v={nodeType:1,parentNode:n,childNodes:[],__k:{__m:r.__m},contains:function(){return!0},insertBefore:function(l,s){this.childNodes.push(l),t.h.insertBefore(l,s)},removeChild:function(l){this.childNodes.splice(this.childNodes.indexOf(l)>>>1,1),t.h.removeChild(l)}}}xe(se(Ja,{context:t.context},e.__v),t.v)}function Wa(e,t){var n=se(Va,{__v:e,h:t});return n.containerInfo=t,n}(Ie.prototype=new X).__a=function(e){var t=this,n=lr(t.__v),r=t.l.get(e);return r[0]++,function(l){var s=function(){t.props.revealOrder?(r.push(l),rn(t,e,r)):l()};n?n(s):s()}},Ie.prototype.render=function(e){this.i=null,this.l=new Map;var t=ae(e.children);e.revealOrder&&e.revealOrder[0]==="b"&&t.reverse();for(var n=t.length;n--;)this.l.set(t[n],this.i=[1,0,this.i]);return e.children},Ie.prototype.componentDidUpdate=Ie.prototype.componentDidMount=function(){var e=this;this.l.forEach(function(t,n){rn(e,n,t)})};var sr=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,qa=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,Ha=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,za=/[A-Z0-9]/g,Ba=typeof document<"u",Ka=function(e){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/:/fil|che|ra/).test(e)};function Ga(e,t,n){return t.__k==null&&(t.textContent=""),xe(e,t),typeof n=="function"&&n(),e?e.__c:null}function Za(e,t,n){return Sn(e,t),typeof n=="function"&&n(),e?e.__c:null}X.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(e){Object.defineProperty(X.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})});var an=E.event;function Ya(){}function Qa(){return this.cancelBubble}function Xa(){return this.defaultPrevented}E.event=function(e){return an&&(e=an(e)),e.persist=Ya,e.isPropagationStopped=Qa,e.isDefaultPrevented=Xa,e.nativeEvent=e};var kt,el={enumerable:!1,configurable:!0,get:function(){return this.class}},ln=E.vnode;E.vnode=function(e){typeof e.type=="string"&&function(t){var n=t.props,r=t.type,l={},s=r.indexOf("-")===-1;for(var i in n){var o=n[i];if(!(i==="value"&&"defaultValue"in n&&o==null||Ba&&i==="children"&&r==="noscript"||i==="class"||i==="className")){var d=i.toLowerCase();i==="defaultValue"&&"value"in n&&n.value==null?i="value":i==="download"&&o===!0?o="":d==="translate"&&o==="no"?o=!1:d[0]==="o"&&d[1]==="n"?d==="ondoubleclick"?i="ondblclick":d!=="onchange"||r!=="input"&&r!=="textarea"||Ka(n.type)?d==="onfocus"?i="onfocusin":d==="onblur"?i="onfocusout":Ha.test(i)&&(i=d):d=i="oninput":s&&qa.test(i)?i=i.replace(za,"-$&").toLowerCase():o===null&&(o=void 0),d==="oninput"&&l[i=d]&&(i="oninputCapture"),l[i]=o}}r=="select"&&l.multiple&&Array.isArray(l.value)&&(l.value=ae(n.children).forEach(function(c){c.props.selected=l.value.indexOf(c.props.value)!=-1})),r=="select"&&l.defaultValue!=null&&(l.value=ae(n.children).forEach(function(c){c.props.selected=l.multiple?l.defaultValue.indexOf(c.props.value)!=-1:l.defaultValue==c.props.value})),n.class&&!n.className?(l.class=n.class,Object.defineProperty(l,"className",el)):(n.className&&!n.class||n.class&&n.className)&&(l.class=l.className=n.className),t.props=l}(e),e.$$typeof=sr,ln&&ln(e)};var sn=E.__r;E.__r=function(e){sn&&sn(e),kt=e.__c};var on=E.diffed;E.diffed=function(e){on&&on(e);var t=e.props,n=e.__e;n!=null&&e.type==="textarea"&&"value"in t&&t.value!==n.value&&(n.value=t.value==null?"":t.value),kt=null};var tl={ReactCurrentDispatcher:{current:{readContext:function(e){return kt.__n[e.__c].props.value},useCallback:Te,useContext:Ln,useDebugValue:On,useDeferredValue:er,useEffect:Z,useId:In,useImperativeHandle:$n,useInsertionEffect:nr,useLayoutEffect:Pe,useMemo:z,useReducer:$t,useRef:R,useState:he,useSyncExternalStore:Qn,useTransition:tr}}};function nl(e){return se.bind(null,e)}function nt(e){return!!e&&e.$$typeof===sr}function rl(e){return nt(e)&&e.type===V}function al(e){return!!e&&!!e.displayName&&(typeof e.displayName=="string"||e.displayName instanceof String)&&e.displayName.startsWith("Memo(")}function ll(e){return nt(e)?_r.apply(null,arguments):e}function sl(e){return!!e.__k&&(xe(null,e),!0)}function il(e){return e&&(e.base||e.nodeType===1&&e)||null}var ol=function(e,t){return e(t)},cl=function(e,t){return e(t)},ul=V,dl=nt,ye={useState:he,useId:In,useReducer:$t,useEffect:Z,useLayoutEffect:Pe,useInsertionEffect:nr,useTransition:tr,useDeferredValue:er,useSyncExternalStore:Qn,startTransition:Xn,useRef:R,useImperativeHandle:$n,useMemo:z,useCallback:Te,useContext:Ln,useDebugValue:On,version:"18.3.1",Children:Pa,render:Ga,hydrate:Za,unmountComponentAtNode:sl,createPortal:Wa,createElement:se,createContext:yr,createFactory:nl,cloneElement:ll,createRef:pr,Fragment:V,isValidElement:nt,isElement:dl,isFragment:rl,isMemo:al,findDOMNode:il,Component:X,PureComponent:xt,memo:tt,forwardRef:ja,flushSync:cl,unstable_batchedUpdates:ol,StrictMode:ul,Suspense:Be,SuspenseList:Ie,lazy:Ra,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:tl},fl={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},ft=fl,pl={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},hl=pl;function vl({children:e}){return ye.createElement("div",{style:hl.container},e)}var ml=vl,gl=ml;function _l({width:e,height:t,isEditorReady:n,loading:r,_ref:l,className:s,wrapperProps:i}){return ye.createElement("section",{style:{...ft.wrapper,width:e,height:t},...i},!n&&ye.createElement(gl,null,r),ye.createElement("div",{ref:l,style:{...ft.fullWidth,...!n&&ft.hide},className:s}))}var yl=_l,ir=tt(yl);function bl(e){Z(e,[])}var or=bl;function xl(e,t,n=!0){let r=R(!0);Z(r.current||!n?()=>{r.current=!1}:e,t)}var G=xl;function ke(){}function ge(e,t,n,r){return Nl(e,r)||wl(e,t,n,r)}function Nl(e,t){return e.editor.getModel(cr(e,t))}function wl(e,t,n,r){return e.editor.createModel(t,n,r?cr(e,r):void 0)}function cr(e,t){return e.Uri.parse(t)}function Sl({original:e,modified:t,language:n,originalLanguage:r,modifiedLanguage:l,originalModelPath:s,modifiedModelPath:i,keepCurrentOriginalModel:o=!1,keepCurrentModifiedModel:d=!1,theme:c="light",loading:f="Loading...",options:u={},height:v="100%",width:g="100%",className:$,wrapperProps:T={},beforeMount:C=ke,onMount:k=ke}){let[x,O]=he(!1),[h,N]=he(!0),w=R(null),p=R(null),y=R(null),m=R(k),_=R(C),b=R(!1);or(()=>{let L=Zn.init();return L.then(j=>(p.current=j)&&N(!1)).catch(j=>j?.type!=="cancelation"&&console.error("Monaco initialization: error:",j)),()=>w.current?B():L.cancel()}),G(()=>{if(w.current&&p.current){let L=w.current.getOriginalEditor(),j=ge(p.current,e||"",r||n||"text",s||"");j!==L.getModel()&&L.setModel(j)}},[s],x),G(()=>{if(w.current&&p.current){let L=w.current.getModifiedEditor(),j=ge(p.current,t||"",l||n||"text",i||"");j!==L.getModel()&&L.setModel(j)}},[i],x),G(()=>{let L=w.current.getModifiedEditor();L.getOption(p.current.editor.EditorOption.readOnly)?L.setValue(t||""):t!==L.getValue()&&(L.executeEdits("",[{range:L.getModel().getFullModelRange(),text:t||"",forceMoveMarkers:!0}]),L.pushUndoStop())},[t],x),G(()=>{w.current?.getModel()?.original.setValue(e||"")},[e],x),G(()=>{let{original:L,modified:j}=w.current.getModel();p.current.editor.setModelLanguage(L,r||n||"text"),p.current.editor.setModelLanguage(j,l||n||"text")},[n,r,l],x),G(()=>{p.current?.editor.setTheme(c)},[c],x),G(()=>{w.current?.updateOptions(u)},[u],x);let S=Te(()=>{if(!p.current)return;_.current(p.current);let L=ge(p.current,e||"",r||n||"text",s||""),j=ge(p.current,t||"",l||n||"text",i||"");w.current?.setModel({original:L,modified:j})},[n,t,l,e,r,s,i]),F=Te(()=>{!b.current&&y.current&&(w.current=p.current.editor.createDiffEditor(y.current,{automaticLayout:!0,...u}),S(),p.current?.editor.setTheme(c),O(!0),b.current=!0)},[u,c,S]);Z(()=>{x&&m.current(w.current,p.current)},[x]),Z(()=>{!h&&!x&&F()},[h,x,F]);function B(){let L=w.current?.getModel();o||L?.original?.dispose(),d||L?.modified?.dispose(),w.current?.dispose()}return ye.createElement(ir,{width:g,height:v,isEditorReady:x,loading:f,_ref:y,className:$,wrapperProps:T})}var Cl=Sl;tt(Cl);function $l(e){let t=R();return Z(()=>{t.current=e},[e]),t.current}var Ll=$l,We=new Map;function Ol({defaultValue:e,defaultLanguage:t,defaultPath:n,value:r,language:l,path:s,theme:i="light",line:o,loading:d="Loading...",options:c={},overrideServices:f={},saveViewState:u=!0,keepCurrentModel:v=!1,width:g="100%",height:$="100%",className:T,wrapperProps:C={},beforeMount:k=ke,onMount:x=ke,onChange:O,onValidate:h=ke}){let[N,w]=he(!1),[p,y]=he(!0),m=R(null),_=R(null),b=R(null),S=R(x),F=R(k),B=R(),L=R(r),j=Ll(s),me=R(!1),rt=R(!1);or(()=>{let K=Zn.init();return K.then(ie=>(m.current=ie)&&y(!1)).catch(ie=>ie?.type!=="cancelation"&&console.error("Monaco initialization: error:",ie)),()=>_.current?dr():K.cancel()}),G(()=>{let K=ge(m.current,e||r||"",t||l||"",s||n||"");K!==_.current?.getModel()&&(u&&We.set(j,_.current?.saveViewState()),_.current?.setModel(K),u&&_.current?.restoreViewState(We.get(s)))},[s],N),G(()=>{_.current?.updateOptions(c)},[c],N),G(()=>{!_.current||r===void 0||(_.current.getOption(m.current.editor.EditorOption.readOnly)?_.current.setValue(r):r!==_.current.getValue()&&(rt.current=!0,_.current.executeEdits("",[{range:_.current.getModel().getFullModelRange(),text:r,forceMoveMarkers:!0}]),_.current.pushUndoStop(),rt.current=!1))},[r],N),G(()=>{let K=_.current?.getModel();K&&l&&m.current?.editor.setModelLanguage(K,l)},[l],N),G(()=>{o!==void 0&&_.current?.revealLine(o)},[o],N),G(()=>{m.current?.editor.setTheme(i)},[i],N);let Tt=Te(()=>{if(!(!b.current||!m.current)&&!me.current){F.current(m.current);let K=s||n,ie=ge(m.current,r||e||"",t||l||"",K||"");_.current=m.current?.editor.create(b.current,{model:ie,automaticLayout:!0,...c},f),u&&_.current.restoreViewState(We.get(K)),m.current.editor.setTheme(i),o!==void 0&&_.current.revealLine(o),w(!0),me.current=!0}},[e,t,n,r,l,s,c,f,u,i,o]);Z(()=>{N&&S.current(_.current,m.current)},[N]),Z(()=>{!p&&!N&&Tt()},[p,N,Tt]),L.current=r,Z(()=>{N&&O&&(B.current?.dispose(),B.current=_.current?.onDidChangeModelContent(K=>{rt.current||O(_.current.getValue(),K)}))},[N,O]),Z(()=>{if(N){let K=m.current.editor.onDidChangeMarkers(ie=>{let at=_.current.getModel()?.uri;if(at&&ie.find(lt=>lt.path===at.path)){let lt=m.current.editor.getModelMarkers({resource:at});h?.(lt)}});return()=>{K?.dispose()}}return()=>{}},[N,h]);function dr(){B.current?.dispose(),v?u&&We.set(s,_.current.saveViewState()):_.current.getModel()?.dispose(),_.current.dispose()}return ye.createElement(ir,{width:g,height:$,isEditorReady:N,loading:d,_ref:b,className:T,wrapperProps:C})}var Il=Ol,Dl=tt(Il),El=Dl;function Ft({title:e="JSON Editor",value:t,onChange:n,placeholder:r="{}",readOnly:l=!1,height:s="400px"}){const i=R(null),o=R(null),d=J(!0),c=J(""),f=J(!1),u=I(()=>typeof navigator<"u"&&navigator.platform.toUpperCase().indexOf("MAC")>=0),v=I(()=>u.value?"Cmd":"Ctrl"),g=I(()=>{try{return t==null?"":JSON.stringify(t,null,2)}catch{return""}}),$=(O,h)=>{i.current=O,o.current=h,h.languages.json.jsonDefaults.setDiagnosticsOptions({validate:!0,allowComments:!1,schemas:[],enableSchemaRequest:!1}),O.updateOptions({minimap:{enabled:!1},fontSize:12,tabSize:2,insertSpaces:!0,wordWrap:"on",lineNumbers:"on",folding:!0,bracketPairColorization:{enabled:!0},autoIndent:"full",formatOnPaste:!0,formatOnType:!0}),O.addCommand(h.KeyMod.CtrlCmd|h.KeyCode.KeyS,()=>{C()}),O.addCommand(h.KeyMod.CtrlCmd|h.KeyMod.Shift|h.KeyCode.KeyF,()=>{k()})},T=O=>{if(!(l||!O))try{const h=JSON.parse(O);d.value=!0,c.value="",n(h)}catch(h){d.value=!1,c.value=h instanceof Error?h.message:"Invalid JSON"}},C=()=>{if(!i.current||l)return;const O=i.current.getValue();T(O)},k=async()=>{if(!(!i.current||!o.current||l)){f.value=!0;try{const O=i.current.getValue(),h=JSON.parse(O),N=JSON.stringify(h,null,2);i.current.setValue(N),n(h),d.value=!0,c.value=""}catch{await i.current.getAction("editor.action.formatDocument")?.run()}finally{f.value=!1}}};return a("div",{className:"flex flex-col h-full min-h-0",children:[a("div",{className:"flex flex-wrap gap-2 mb-3 items-center flex-shrink-0",children:[a("span",{className:"text-slate-500",children:e}),a("div",{className:"ml-auto flex gap-2",children:!l&&a(V,{children:[a("button",{className:"btn small",onClick:()=>{if(!i.current)return;const O=i.current.getValue();try{return JSON.parse(O),d.value=!0,c.value="",!0}catch(h){return d.value=!1,c.value=h instanceof Error?h.message:"Invalid JSON",!1}},title:"Validate JSON",children:"Validate"}),a("button",{className:"btn small",onClick:k,disabled:f.value,title:`Format JSON (${v.value}+Shift+F)`,children:f.value?"Formatting...":"Format"})]})})]}),!d.value&&c.value&&a("div",{className:"bg-red-900/30 border border-red-500/50 rounded p-2 mb-2 flex-shrink-0",children:a("div",{className:"text-red-300 text-xs",children:[a("span",{className:"font-medium",children:"JSON Error:"})," ",c.value]})}),d.value&&!l&&a("div",{className:"bg-green-900/30 border border-green-500/50 rounded p-2 mb-2 flex-shrink-0",children:a("div",{className:"text-green-300 text-xs",children:["✓ Valid JSON - Press ",v.value,"+S to save changes"]})}),a("div",{className:"flex-1 min-h-0 border border-slate-600 rounded overflow-hidden",children:a(El,{height:s,language:"json",theme:"vs-dark",value:g.value||r,onChange:T,onMount:$,options:{readOnly:l,contextmenu:!0,automaticLayout:!0},loading:a("div",{className:"flex items-center justify-center h-full text-slate-400",children:"Loading JSON Editor..."})})}),a("div",{className:"text-xs text-slate-500 mt-2 flex-shrink-0",children:l?"Read-only JSON view":a(V,{children:[a("span",{className:"font-medium",children:"Shortcuts:"})," ",v.value,"+S to save • ",v.value,"+Shift+F to format • Auto-validation enabled"]})})]})}function kl({feature:e,type:t,index:n,rearrange:r}){const l=I(()=>Y.value.type===t&&Y.value.index===n),s=I(()=>t==="weatherFeatures"?(D.value.weatherFeatures||[]).length:(D.value.features||[]).length),i=J(!1),o=J(null),d=I(()=>{const x=[];e.id?.trim()&&x.push(e.id),(e.items||[]).forEach(y=>{y.id?.trim()&&x.push(y.id),y.legendDescription?.trim()&&x.push(y.legendDescription)});const O=[...new Set(x)];if(O.length===0)return{percentage:100,missingCount:0,totalKeys:0};let h=0,N=0;O.forEach(y=>{M.forEach(m=>{h++;const _=D.value.intl?.[m]?.[y];_&&_.trim()&&N++})});const w=h>0?Math.round(N/h*100):100,p=h-N;return{percentage:w,missingCount:p,totalKeys:O.length}}),c=()=>{Wn(t,n)},f=x=>{x.stopPropagation(),confirm("Are you sure you want to delete this feature?")&&Kr(t,n)},u=x=>{x.stopPropagation(),!(n<=0)&&ze(t,n,t,n-1)},v=x=>{x.stopPropagation();const O=(t==="weatherFeatures"?D.value.weatherFeatures:D.value.features).length;n>=O-1||ze(t,n,t,n+1)},g=x=>{x.stopPropagation(),Gr(t,n,t==="weatherFeatures"?"features":"weatherFeatures")},$=(e.items||[]).length,T=e.presentation||"single",C=e.name||T==="single"&&e.items?.[0]?.name||e.id||"Unnamed Feature",k=e.mutuallyExclusive?" • Exclusive":"";return a("div",{className:`feature-list-item relative ${l.value?"selected":""} ${i.value?"ring-1 ring-blue-500":""}`,onClick:c,draggable:r,onDragStart:x=>{if(!r)return;const O=JSON.stringify({kind:"feature",type:t,index:n});x.dataTransfer.setData("application/x-feature",O),x.dataTransfer.setData("text/plain",O),x.dataTransfer.effectAllowed="move"},onDragOver:x=>{if(!r||!Array.from(x.dataTransfer?.types||[]).includes("application/x-feature"))return;x.preventDefault(),x.dataTransfer.dropEffect="move",i.value=!0;const h=x.currentTarget.getBoundingClientRect(),N=x.clientY<h.top+h.height/2;o.value=N?"before":"after"},onDragLeave:()=>{i.value=!1,o.value=null},onDrop:x=>{if(!r)return;x.preventDefault(),i.value=!1;const O=o.value;o.value=null;const h=x.dataTransfer.getData("application/x-feature")||x.dataTransfer.getData("text/plain");if(h)try{const N=JSON.parse(h);if(N.kind!=="feature")return;const w=O==="after"?n+1:n;ze(N.type,N.index,t,w)}catch{}},children:[i.value&&o.value==="before"&&a("div",{className:"absolute -top-[1px] left-0 right-0 h-0.5 bg-blue-500 rounded-full"}),a("div",{className:"feature-info",children:[a("div",{className:"feature-name",children:C}),a("div",{className:"feature-details",children:[$," item(s) • ",T,k]}),d.value.totalKeys>0&&a("div",{className:"flex items-center gap-1 mt-1",children:[a("span",{className:"text-xs text-slate-400",children:"i18n:"}),a("span",{className:`text-xs px-1.5 py-0.5 rounded-full ${d.value.percentage===100?"bg-green-600 text-white":d.value.percentage>50?"bg-yellow-600 text-white":"bg-red-600 text-white"}`,children:[d.value.percentage,"%"]}),d.value.missingCount>0&&a("span",{className:"text-xs text-orange-400",children:["(",d.value.missingCount," missing)"]})]})]}),a("div",{className:"feature-actions flex gap-1",children:[r&&a(V,{children:[a("button",{className:"btn small",onClick:u,disabled:n===0,title:"Move up",children:"↑"}),a("button",{className:"btn small",onClick:v,disabled:n>=s.value-1,title:"Move down",children:"↓"}),a("button",{className:"btn ghost small",onClick:g,title:t==="weatherFeatures"?"Move to General":"Move to Weather",children:t==="weatherFeatures"?"To General":"To Weather"})]}),a("button",{className:"btn danger small",onClick:f,children:"Delete"})]}),i.value&&o.value==="after"&&a("div",{className:"absolute -bottom-[1px] left-0 right-0 h-0.5 bg-blue-500 rounded-full"})]})}function cn({title:e,type:t,features:n,rearrange:r}){const l=J(!1);return a("details",{open:!0,className:`feature-category ${l.value?"ring-1 ring-blue-700 rounded":""}`,onDragOver:s=>{!r||!Array.from(s.dataTransfer?.types||[]).includes("application/x-feature")||(s.preventDefault(),l.value=!0)},onDragLeave:()=>{l.value=!1},onDrop:s=>{if(!r)return;s.preventDefault(),l.value=!1;const i=s.dataTransfer.getData("application/x-feature")||s.dataTransfer.getData("text/plain");if(i)try{const o=JSON.parse(i);if(o.kind!=="feature")return;const d=(t==="weatherFeatures"?D.value.weatherFeatures:D.value.features).length;ze(o.type,o.index,t,d)}catch{}},children:[a("summary",{className:"feature-category-header",children:e}),a("div",{className:"feature-category-content",children:n.length===0?a("div",{className:"p-3 text-slate-500 text-center",children:["No ",e.toLowerCase()," found"]}):n.map((s,i)=>a(kl,{feature:s,type:t,index:i,rearrange:r},i))})]})}function Fl(){const e=I(()=>D.value.weatherFeatures||[]),t=I(()=>D.value.features||[]),n=J(!1);return a("div",{className:"flex flex-col h-full",children:[a("div",{className:"flex items-center justify-between mb-2",children:[a("div",{className:"text-sm text-slate-400",children:"Features"}),a("button",{className:`btn tiny ${n.value?"success":"ghost"}`,onClick:()=>n.value=!n.value,title:"Toggle rearrange mode",children:n.value?"Done":"Rearrange"})]}),a("div",{className:"feature-browser flex-1 overflow-auto",children:[a(cn,{title:"Weather Features",type:"weatherFeatures",features:e.value,rearrange:n.value}),a(cn,{title:"General Features",type:"features",features:t.value,rearrange:n.value})]})]})}function Tl({layer:e,index:t,isUsed:n}){const r=I(()=>le.value.index===t),l=we(e.id),s=()=>{He(t)},i=o=>{o.stopPropagation(),confirm(`Are you sure you want to delete layer "${e.id}"?`)&&Hn(t)};return a("div",{className:`feature-list-item ${r.value?"selected":""}`,onClick:s,children:[a("div",{className:"feature-info",children:[a("div",{className:"feature-name",children:e.id||"(no id)"}),a("div",{className:"feature-details",children:[a("span",{className:`pill ${n?"ok":"warn"}`,children:n?"used":"unused"}),l&&a("span",{className:"ml-2 text-xs bg-blue-600 text-white px-1.5 py-0.5 rounded",children:"referenced"}),a("span",{className:"ml-2 text-xs",children:[e.layers?.length||0," sublayer",(e.layers?.length||0)===1?"":"s"]})]})]}),a("div",{className:"feature-actions",children:a("button",{className:"btn danger small",onClick:i,children:"Delete"})})]})}function Ml(){const e=I(()=>D.value.layers||[]),t=I(()=>Et(D.value));return a("div",{className:"flex flex-col h-full",children:a("div",{className:"feature-browser flex-1 overflow-auto",children:a("div",{className:"feature-category",children:[a("div",{className:"feature-category-header",children:"Layers"}),a("div",{className:"feature-category-content",children:e.value.length===0?a("div",{className:"p-3 text-slate-500 text-center",children:"No layers found"}):e.value.map((n,r)=>a(Tl,{layer:n,index:r,isUsed:t.value.has(n.id)},n.id||r))})]})})})}function ur({validation:e,className:t=""}){return!e||e.errors.length===0&&e.warnings.length===0?null:a("div",{className:`space-y-2 ${t}`,children:[e.errors.length>0&&a("div",{className:"bg-red-900/20 border border-red-700/30 rounded p-2",children:[a("div",{className:"flex items-center gap-2 text-red-400 text-sm font-medium mb-1",children:[a("span",{children:"❌"}),a("span",{children:["Errors (",e.errors.length,")"]})]}),a("div",{className:"space-y-1",children:e.errors.map((n,r)=>a("div",{className:"text-red-300 text-xs",children:["• ",n]},r))})]}),e.warnings.length>0&&a("div",{className:"bg-yellow-900/20 border border-yellow-700/30 rounded p-2",children:[a("div",{className:"flex items-center gap-2 text-yellow-400 text-sm font-medium mb-1",children:[a("span",{children:"⚠️"}),a("span",{children:["Warnings (",e.warnings.length,")"]})]}),a("div",{className:"space-y-1",children:e.warnings.map((n,r)=>a("div",{className:"text-yellow-300 text-xs",children:["• ",n]},r))})]})]})}const Al=[{id:"details",label:"Details"},{id:"json",label:"JSON"}];function jl(){const e=I(()=>le.value.index),t=qr,n=J("details"),r=I(()=>e.value>=0?e.value:null),l=I(()=>r.value===null?null:zr(r.value)||null),s=I(()=>!!q.value.new),i=I(()=>s.value||l.value!=null),o=I(()=>{const p=q.value.new;return p||(l.value?l.value:t.value||null)}),d=I(()=>{const p=o.value;return p?zt(p):null}),c=()=>{re("new",{id:"",layers:[]}),He(-1)},f=()=>{e.value<0||!t.value||re(e.value,{...t.value})},u=()=>{const p=s.value,y=p?"new":r.value,m=p?q.value.new:q.value[y];if(!m)return;const _=zt(m);if(!_.valid){validationErrors.value=_.errors,te(`❌ Layer validation failed: ${_.errors[0]}`);return}const b=Rr(D.value,m);W(b);const S=b.layers.findIndex(F=>F.id===m.id);S>=0&&He(S),Je("new"),!p&&typeof y=="number"&&Je(y)},v=()=>{Je("new"),typeof r.value=="number"&&Je(r.value)},g=()=>{if(e.value<0||!t.value)return;const p=t.value.id||`Layer ${e.value+1}`;confirm(`Are you sure you want to delete layer "${p}"? This action cannot be undone.`)&&Hn(e.value)},$=()=>{if(e.value<0||!t.value)return;const p=t.value,y={id:`${p.id}_copy`,layers:JSON.parse(JSON.stringify(p.layers||[]))};re("new",y),He(-1)},T=p=>{const y=s.value||r.value===null,m=y?"new":r.value,b={...y?q.value.new:q.value[m],...p};re(m,b)},C=(p,y)=>{const m=s.value||r.value===null,_=m?"new":r.value,b=m?q.value.new:q.value[_],S=[...b.layers||[]];S[p]={...S[p],...y},re(_,{...b,layers:S})},k=p=>{const y=s.value||r.value===null,m=y?"new":r.value,_=y?q.value.new:q.value[m],b=[..._.layers||[]];b.splice(p,1),re(m,{..._,layers:b})},x=(p="wms")=>{const y=s.value||r.value===null,m=y?"new":r.value,_=y?q.value.new:q.value[m],b={type:p,source:"",zIndex:0,options:{opacity:1}},S=[..._.layers||[],b];re(m,{..._,layers:S})},O=p=>{t.value&&r.value===e.value&&!l.value&&!s.value&&re(e.value,{...t.value});const m=s.value||r.value===null?"new":r.value;re(m,p)},h=I(()=>e.value>=0&&!!t.value),N=I(()=>t.value?.id?Lr(D.value,t.value.id):[]),w=I(()=>t.value?.id?we(t.value.id):!1);return a("div",{className:"flex flex-col h-full",children:[a("div",{className:"flex flex-wrap gap-2 mb-3 items-center flex-shrink-0",children:[a("div",{children:[a("span",{className:"text-slate-500",children:i.value?e.value>=0?"Edit Layer":"New Layer":"Layer Details"}),o.value&&a("div",{className:"text-xs text-slate-400 mt-0.5",children:[o.value.id,w.value&&!i.value&&a("span",{className:"ml-2 text-xs bg-blue-600 text-white px-2 py-0.5 rounded",children:"Referenced"})]})]}),a("div",{className:"ml-auto flex gap-2",children:[!i.value&&h.value&&a(V,{children:[a("button",{className:"btn small",onClick:f,children:"Edit"}),a("button",{className:"btn ghost small",onClick:$,children:"Duplicate"}),a("button",{className:"btn danger small",onClick:g,children:"Delete"})]}),a("button",{className:"btn primary small",onClick:c,children:"New Layer"}),i.value&&a(V,{children:[a("button",{className:"btn success small",onClick:u,children:"Save"}),a("button",{className:"btn ghost small",onClick:v,children:"Cancel"})]})]})]}),o.value?a(V,{children:[a("div",{className:"flex gap-1 mb-3 border-b border-slate-700 pb-2 flex-shrink-0",children:Al.map(p=>a("button",{className:`px-3 py-1.5 rounded-t-md text-xs transition-all duration-150 ${n.value===p.id?"bg-blue-500 text-white":"bg-slate-950 text-slate-500 border border-slate-700 hover:border-slate-600 hover:text-slate-200"}`,onClick:()=>n.value=p.id,children:p.label},p.id))}),a("div",{className:"flex-1 overflow-hidden",children:[n.value==="details"&&a("div",{className:"h-full overflow-auto",children:[a(ur,{validation:d.value,className:"mb-4"}),a("div",{className:"layer-section",children:a("div",{className:"form-group",children:[a("label",{className:"form-label",children:"Layer ID"}),a("input",{type:"text",className:"form-input",value:o.value.id,onChange:p=>T({id:p.target.value}),onBlur:p=>{const y=p.target.value.trim();if(!y)return;const m=D.value.layers||[];if(m.some((b,S)=>b.id===y&&S!==e.value)){let b=1,S=`${y}_${b}`;for(;m.some(F=>F.id===S);)b++,S=`${y}_${b}`;T({id:S}),p.target.value=S}},placeholder:"unique_layer_id",disabled:!i.value})]})}),a("div",{className:"layer-section",children:[a("div",{className:"flex items-center justify-between mb-2",children:[a("label",{className:"form-label",children:"Sublayers"}),i.value&&a("button",{className:"btn small",onClick:()=>x("wms"),children:"+ Add Sublayer"})]}),o.value.layers.length===0&&a("div",{className:"text-slate-500 text-sm",children:"No sublayers. Add one to get started."}),a("div",{className:"space-y-2",children:o.value.layers.map((p,y)=>a("div",{className:"border border-slate-600 rounded p-3 bg-slate-900",draggable:i.value&&o.value.layers.length>1,onDragStart:m=>{i.value&&(m.dataTransfer.setData("text/plain",y.toString()),m.dataTransfer.effectAllowed="move")},onDragOver:m=>{i.value&&(m.preventDefault(),m.dataTransfer.dropEffect="move")},onDrop:m=>{if(!i.value)return;m.preventDefault();const _=parseInt(m.dataTransfer.getData("text/plain"));if(_!==y){const S=[...o.value.layers||[]],F=S[_];S.splice(_,1),S.splice(y,0,F),T({layers:S})}},style:{cursor:i.value&&o.value.layers.length>1?"grab":"default"},children:[a("div",{className:"mb-2",children:[a("div",{className:"flex items-center gap-2 mb-1",children:[i.value&&o.value.layers.length>1&&a("div",{className:"cursor-move text-slate-400 hover:text-slate-300 px-1 select-none",title:"Drag to reorder",children:"⋮⋮"}),a("span",{className:"text-xs text-slate-400 font-mono",children:["#",y+1]}),a("div",{className:"flex-1 text-sm font-medium",children:p.type.toUpperCase()}),i.value&&a("button",{className:"btn tiny danger",onClick:()=>k(y),children:"×"})]}),a("div",{className:"text-xs text-slate-400 break-all pl-6",children:p.source||"No source"}),!i.value&&a("div",{className:"text-xs text-slate-500 pl-6 mt-1 space-y-0.5",children:[p.options?.opacity!==void 0&&p.options.opacity!==1&&a("div",{children:["Opacity: ",p.options.opacity]}),p.zIndex!==void 0&&p.zIndex!==0&&a("div",{children:["Z-Index: ",p.zIndex]}),p.refreshInterval&&a("div",{children:["Refresh: ",p.refreshInterval,"ms (",(p.refreshInterval/1e3).toFixed(1),"s)"]})]})]}),i.value&&a("div",{className:"space-y-2 text-xs",children:[a("div",{className:"grid grid-cols-2 gap-2",children:[a("div",{children:[a("label",{className:"block text-slate-400 mb-1",children:"Type"}),a("select",{className:"w-full px-2 py-1 text-xs bg-slate-800 border border-slate-600 rounded",value:p.type,onChange:m=>{const _=m.target.value,b=Pr(_),S=p.options||{},F={};S.opacity!==void 0&&(F.opacity=S.opacity),_==="wms"&&b.options?.layerNames?F.layerNames=b.options.layerNames:_==="portalItem"&&b.options?.layerId!==void 0&&(F.layerId=b.options.layerId),Object.entries(S).forEach(([B,L])=>{B!=="layerNames"&&B!=="layerId"&&B!=="opacity"&&(F[B]=L)}),C(y,{type:_,source:p.source,options:F})},children:yt.map(m=>a("option",{value:m,children:m.toUpperCase()},m))})]}),a("div",{children:[a("label",{className:"block text-slate-400 mb-1",children:"Opacity"}),a("input",{type:"text",className:"w-full px-2 py-1 text-xs bg-slate-800 border border-slate-600 rounded",placeholder:"0.0 - 1.0",defaultValue:p.options?.opacity??1,onBlur:m=>{const _=m.target.value.replace(",",".");let b=parseFloat(_);(isNaN(b)||_.trim()==="")&&(b=1),b<0&&(b=0),b>1&&(b=1),C(y,{options:{...p.options,opacity:b}}),m.target.value=b.toString()}})]})]}),a("div",{className:"grid grid-cols-2 gap-2",children:[a("div",{children:[a("label",{className:"block text-slate-400 mb-1",children:"Z-Index"}),a("input",{type:"number",className:"w-full px-2 py-1 text-xs bg-slate-800 border border-slate-600 rounded",value:p.zIndex??0,onChange:m=>C(y,{zIndex:parseInt(m.target.value)})})]}),a("div",{children:[a("label",{className:"block text-slate-400 mb-1",children:"Refresh Interval (ms)"}),a("input",{type:"number",className:"w-full px-2 py-1 text-xs bg-slate-800 border border-slate-600 rounded",value:p.refreshInterval||"",onChange:m=>{const _=m.target.value;C(y,{refreshInterval:_?parseInt(_):void 0})},placeholder:"60000",min:"0",step:"1000"})]})]}),a("div",{children:[a("label",{className:"block text-slate-400 mb-1",children:"Source URL/ID"}),a("input",{type:"text",className:"w-full px-2 py-1 text-xs bg-slate-800 border border-slate-600 rounded",value:p.source||"",onChange:m=>C(y,{source:m.target.value}),placeholder:p.type==="portalItem"?"e.g. abc123def456":p.type==="wms"?"https://example.com/wms":p.type==="tiled"?"https://example.com/tiles/{z}/{y}/{x}.png":p.type==="vectorTiled"?"https://example.com/vectortiles/{z}/{y}/{x}.pbf":p.type==="feature"?"https://example.com/arcgis/rest/services/FeatureServer/0":"https://example.com/arcgis/rest/services/MapServer"}),a("div",{className:"text-[10px] text-slate-500 mt-1",children:[p.type==="portalItem"&&"ArcGIS Online portal item ID",p.type==="wms"&&"WMS service endpoint URL",p.type==="tiled"&&"Tile template URL with {z}/{y}/{x}",p.type==="vectorTiled"&&"Vector tile template URL with {z}/{y}/{x}",p.type==="mapImage"&&"ArcGIS REST MapServer endpoint",p.type==="feature"&&"ArcGIS REST FeatureServer endpoint"]})]}),p.type==="portalItem"&&a("div",{children:[a("label",{className:"block text-slate-400 mb-1",children:"Portal Layer ID"}),a("input",{type:"number",className:"w-full px-2 py-1 text-xs bg-slate-800 border border-slate-600 rounded",value:p.options?.layerId||0,onChange:m=>C(y,{options:{...p.options||{},layerId:parseInt(m.target.value)||0}}),placeholder:"0"})]}),p.type==="wms"&&a("div",{children:[a("label",{className:"block text-slate-400 mb-1",children:["WMS Layer Names ",a("span",{className:"text-red-400",children:"*required"})]}),a("div",{className:"space-y-2",children:[(p.options?.layerNames||[]).length===0&&a("div",{className:"text-xs text-red-400 mb-2",children:"⚠️ WMS layers require at least one layer name"}),(p.options?.layerNames||["layer1"]).map((m,_)=>a("div",{className:"flex gap-2",children:[a("input",{type:"text",className:"w-full px-2 py-1 text-xs bg-slate-800 border border-slate-600 rounded",value:m,onChange:b=>{const S=[...p.options?.layerNames||[]];S[_]=b.target.value,C(y,{options:{...p.options||{},layerNames:S}})},onBlur:b=>{if(!b.target.value.trim()){const F=[...p.options?.layerNames||[]];F.length>1?(F.splice(_,1),C(y,{options:{...p.options||{},layerNames:F}})):(b.target.value=`layer${_+1}`,F[_]=`layer${_+1}`,C(y,{options:{...p.options||{},layerNames:F}}))}},placeholder:`layer${_+1}`}),(p.options?.layerNames||[]).length>1&&a("button",{type:"button",className:"btn tiny danger",onClick:()=>{const b=[...p.options?.layerNames||[]];b.splice(_,1),C(y,{options:{...p.options||{},layerNames:b}})},children:"×"})]},_)),a("button",{type:"button",className:"btn tiny",onClick:()=>{const m=[...p.options?.layerNames||[],""];C(y,{options:{...p.options||{},layerNames:m}})},children:"+ Add Layer Name"})]})]}),a("div",{children:[a("label",{className:"block text-slate-400 mb-1",children:"Custom Options"}),a("div",{className:"space-y-2",children:[Object.entries(p.options||{}).map(([m,_])=>m==="layerNames"||m==="layerId"||m==="opacity"?null:a("div",{className:"flex gap-2 items-center",children:[a("input",{type:"text",className:"w-1/3 px-2 py-1 text-xs bg-slate-800 border border-slate-600 rounded",value:m,onChange:b=>{const S=b.target.value,F={...p.options||{}};S!==m&&(delete F[m],S.trim()&&(F[S]=_),C(y,{options:F}))},placeholder:"key"}),a("span",{className:"text-slate-500",children:":"}),a("input",{type:"text",className:"flex-1 px-2 py-1 text-xs bg-slate-800 border border-slate-600 rounded",value:typeof _=="string"?_:JSON.stringify(_),onChange:b=>{let S=b.target.value;S==="true"?S=!0:S==="false"?S=!1:!isNaN(Number(S))&&S.trim()!==""&&(S=Number(S));const F={...p.options||{}};F[m]=S,C(y,{options:F})},placeholder:"value"}),a("button",{type:"button",className:"btn tiny danger",onClick:()=>{const b={...p.options||{}};delete b[m],C(y,{options:b})},title:"Remove option",children:"×"})]},m)),a("button",{type:"button",className:"btn tiny",onClick:()=>{const m={...p.options||{}};m.newOption="",C(y,{options:m})},children:"+ Add Custom Option"})]}),a("div",{className:"text-[10px] text-slate-500 mt-1",children:"Add custom properties. Values are auto-parsed (numbers, booleans, or strings)."})]})]})]},y))}),!i.value&&N.value.length>0&&a("div",{className:"form-group mt-3",children:[a("label",{className:"form-label",children:"Layer Usage"}),a("div",{className:"bg-slate-700 rounded p-3 text-sm",children:[a("div",{className:"text-slate-300 mb-2",children:["This layer is referenced by ",N.value.length," item(s):"]}),a("div",{className:"space-y-1 max-h-32 overflow-y-auto",children:N.value.map((p,y)=>a("div",{className:"text-slate-400 text-xs flex items-center gap-2",children:[a("span",{className:"bg-slate-600 px-2 py-0.5 rounded text-xs",children:p.featureType==="weatherFeatures"?"Weather":"Feature"}),a("span",{children:p.featureName}),a("span",{className:"text-slate-500",children:"→"}),a("span",{children:p.itemName})]},y))})]})]}),!i.value&&N.value.length===0&&t.value&&a("div",{className:"form-group mt-3",children:[a("label",{className:"form-label",children:"Layer Usage"}),a("div",{className:"bg-slate-700 rounded p-3 text-sm text-slate-400",children:["This layer is not currently referenced by any features or items.",a("br",{}),a("span",{className:"text-xs text-slate-500",children:"Consider deleting if no longer needed."})]})]})]})]}),n.value==="json"&&a("div",{className:"h-full min-h-0",children:a(Ft,{title:"Selected Layer JSON",value:o.value,onChange:O,readOnly:!i.value,height:"100%"},`${r.value??"new"}:${i.value?"edit":"view"}`)})]})]}):a("div",{className:"text-center p-5 text-slate-500 flex-1 flex items-center justify-center",children:a("div",{children:[a("p",{children:"Select a layer to view/edit or create a new one"}),a("button",{className:"btn primary",onClick:c,children:"New Layer"})]})})]})}const Pl=e=>{const t=[],n=[];return e.presentation?["single","multiple"].includes(e.presentation)||t.push('presentation must be "single" or "multiple"'):t.push("presentation field is required"),e.items?Array.isArray(e.items)?e.items.length===0?n.push("items array is empty - feature will not be functional"):e.items.forEach((r,l)=>{const s=Ul(r);t.push(...s.errors.map(i=>`Item ${l+1}: ${i}`)),n.push(...s.warnings.map(i=>`Item ${l+1}: ${i}`))}):t.push("items must be an array"):t.push("items field is required"),{valid:t.length===0,errors:t,warnings:n}},Ul=e=>{const t=[],n=[];return e.id?typeof e.id!="string"?t.push("id must be a string"):e.id.trim()===""&&t.push("id cannot be empty or whitespace only"):t.push("id is required"),e.name?typeof e.name!="string"?t.push("name must be a string"):e.name.trim()===""&&t.push("name cannot be empty or whitespace only"):t.push("name is required"),e.layersIds?Array.isArray(e.layersIds)?e.layersIds.length===0?t.push("layersIds must contain at least one layer ID"):e.layersIds.forEach((r,l)=>{(!r||typeof r!="string"||r.trim()==="")&&t.push(`layersIds[${l}] must be a non-empty string`)}):t.push("layersIds must be an array"):t.push("layersIds is required"),e.showLegend!==void 0&&typeof e.showLegend!="boolean"&&t.push("showLegend must be a boolean"),e.legendUrl!==void 0&&(typeof e.legendUrl!="string"?t.push("legendUrl must be a string"):e.legendUrl.trim()===""&&n.push("legendUrl is empty - consider removing it")),e.legendDescription!==void 0&&(typeof e.legendDescription!="string"?t.push("legendDescription must be a string"):e.legendDescription.trim()===""&&n.push("legendDescription is empty - consider removing it")),{valid:t.length===0,errors:t,warnings:n}};function Rl({feature:e,isEditing:t}){const n=I(()=>D.value),r=I(()=>{const f=[];return e.id?.trim()&&f.push(e.id),(e.items||[]).forEach(u=>{u.id?.trim()&&f.push(u.id),u.legendDescription?.trim()&&f.push(u.legendDescription)}),[...new Set(f)]}),l=I(()=>r.value.map(f=>{const u={};let v=0;return M.forEach(g=>{const $=n.value.intl?.[g]?.[f]||"";u[g]=$,$.trim()||v++}),{key:f,translations:u,missingCount:v,isComplete:v===0,completionPercentage:Math.round((M.length-v)/M.length*100)}})),s=I(()=>{if(l.value.length===0)return 100;const f=l.value.length*M.length,u=l.value.reduce((v,g)=>v+(M.length-g.missingCount),0);return Math.round(u/f*100)}),i=(f,u,v)=>{const g={...n.value,intl:{...n.value.intl}};g.intl[u]||(g.intl[u]={}),g.intl[u]={...g.intl[u],[f]:v},W(g)},o=f=>{const u=l.value.find($=>$.key===f);if(!u)return;const v=u.translations.en;if(!v.trim())return;const g={...n.value,intl:{...n.value.intl}};M.forEach($=>{$!=="en"&&!u.translations[$].trim()&&(g.intl[$]||(g.intl[$]={}),g.intl[$][f]=v)}),W(g)},d=f=>{if(!confirm(`Clear all translations for "${f}"?`))return;const u={...n.value,intl:{...n.value.intl}};M.forEach(v=>{u.intl[v]&&u.intl[v][f]&&delete u.intl[v][f]}),W(u)},c=f=>{if(f===e.id)return"Feature ID";const u=(e.items||[]).find(v=>v.id===f||v.legendDescription===f);if(u){if(u.id===f)return`Item ID (${u.name||"Unnamed"})`;if(u.legendDescription===f)return`Legend Description (${u.name||u.id||"Unnamed"})`}return"Unknown"};return r.value.length===0?a("div",{className:"h-full flex items-center justify-center",children:a("div",{className:"text-center text-slate-500",children:[a("div",{className:"text-4xl mb-3",children:"🌐"}),a("div",{className:"text-sm font-medium mb-1",children:"No Translation Keys"}),a("div",{className:"text-xs",children:"Add feature and item IDs to enable translations"})]})}):a("div",{className:"h-full flex flex-col",children:[a("div",{className:"mb-4 pb-3 border-b border-slate-700",children:[a("div",{className:"flex items-center justify-between mb-2",children:[a("h3",{className:"text-lg font-medium text-slate-200",children:"Translations"}),a("div",{className:"flex items-center gap-2",children:[a("span",{className:"text-xs text-slate-400",children:[r.value.length," key",r.value.length!==1?"s":""]}),a("div",{className:`pill ${s.value===100?"ok":s.value>50?"warn":"error"}`,children:[s.value,"% complete"]})]})]}),a("div",{className:"text-xs text-slate-500",children:"Manage translations for all feature and item IDs. Missing translations will fall back to English or the ID itself."})]}),a("div",{className:"flex-1 overflow-y-auto space-y-4",children:l.value.map(f=>a("div",{className:"border border-slate-600 rounded-lg p-4 bg-slate-900/50",children:[a("div",{className:"flex items-start justify-between mb-3",children:[a("div",{className:"flex-1 min-w-0",children:[a("div",{className:"flex items-center gap-2 mb-1",children:[a("code",{className:"text-sm text-slate-300 font-mono",children:f.key}),a("span",{className:"text-xs text-slate-500",children:["(",c(f.key),")"]})]}),a("div",{className:"flex items-center gap-2",children:[a("div",{className:`pill tiny ${f.isComplete?"ok":f.completionPercentage>50?"warn":"error"}`,children:[f.completionPercentage,"%"]}),f.missingCount>0&&a("span",{className:"text-xs text-orange-400",children:[f.missingCount," missing"]})]})]}),a("div",{className:"flex gap-1",children:[f.missingCount>0&&f.translations.en.trim()&&a("button",{className:"btn tiny",onClick:()=>o(f.key),disabled:!t,title:"Fill missing translations with English text",children:"Fill EN"}),a("button",{className:"btn danger tiny",onClick:()=>d(f.key),disabled:!t,title:"Clear all translations for this key",children:"Clear"})]})]}),a("div",{className:"grid gap-3",children:M.map(u=>a("div",{className:"grid grid-cols-4 gap-2 items-start",children:[a("div",{className:"flex items-center gap-2",children:[a("span",{className:"font-mono text-xs bg-slate-700 px-2 py-1 rounded text-center min-w-[2.5rem]",children:u.toUpperCase()}),u==="en"&&a("span",{className:"text-slate-500 text-xs",children:"Default"}),!f.translations[u].trim()&&a("span",{className:"text-orange-400 text-xs",children:"•"})]}),a("div",{className:"col-span-3",children:a("textarea",{className:"form-textarea text-xs",rows:2,value:f.translations[u],onInput:v=>i(f.key,u,v.target.value),placeholder:u==="en"?`Enter ${u.toUpperCase()} text`:`Translate to ${u.toUpperCase()}`,disabled:!t})})]},u))})]},f.key))}),a("div",{className:"mt-4 pt-3 border-t border-slate-700",children:a("div",{className:"text-xs text-slate-500",children:[a("div",{className:"mb-1",children:[a("strong",{children:"Translation Coverage:"})," ",M.length*r.value.length-l.value.reduce((f,u)=>f+u.missingCount,0),"/",M.length*r.value.length," entries complete"]}),!t&&a("div",{className:"text-slate-400",children:a("em",{children:"Enable editing mode to modify translations"})})]})})]})}function Jl({isOpen:e,selectedLayerIds:t,onClose:n,onSave:r}){const l=J(t),s=J([]);JSON.stringify(s.value)!==JSON.stringify(t)&&(l.value=[...t],s.value=[...t]);const i=I(()=>D.value.layers||[]),o=I(()=>{const v=new Set;return[...D.value.weatherFeatures||[],...D.value.features||[]].forEach(g=>{(g.items||[]).forEach($=>{($.layersIds||[]).forEach(T=>{t.includes(T)||v.add(T)})})}),v}),d=I(()=>i.value.map(g=>({id:g.id,title:g.id||"Unnamed Layer",isAssigned:o.value.has(g.id)})).sort((g,$)=>g.isAssigned!==$.isAssigned?g.isAssigned?1:-1:g.title.localeCompare($.title))),c=v=>{const g=l.value||[];l.value=g.includes(v)?g.filter($=>$!==v):[...g,v]},f=()=>{r(l.value),n()},u=()=>{l.value=t,n()};return e?a("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:u,children:a("div",{className:"bg-slate-800 border border-slate-600 rounded-lg w-96 max-h-[80vh] flex flex-col",onClick:v=>v.stopPropagation(),children:[a("div",{className:"p-4 border-b border-slate-700",children:[a("h3",{className:"text-lg font-medium text-white",children:"Select Layers"}),a("p",{className:"text-sm text-slate-400 mt-1",children:["Choose one or more layers for this item (",l.value.length," selected)"]})]}),a("div",{className:"flex-1 overflow-y-auto p-2 max-h-96",children:d.value.length===0?a("div",{className:"p-4 text-center text-slate-500",children:"No layers available"}):a("div",{className:"space-y-1",children:d.value.map(v=>{const g=l.value.includes(v.id);return a("label",{className:"flex items-center gap-3 p-2 hover:bg-slate-700 rounded cursor-pointer",children:[a("input",{type:"checkbox",className:"form-checkbox",checked:g,onChange:()=>c(v.id)}),a("div",{className:"flex-1",children:[a("div",{className:`text-sm ${v.isAssigned?"text-slate-200":"text-green-300 font-medium"} flex items-center gap-2`,children:[v.title,we(v.id)&&a("span",{className:"text-xs bg-blue-600 text-white px-1.5 py-0.5 rounded",children:"referenced"})]}),a("div",{className:"text-xs text-slate-500",children:["ID: ",v.id,!v.isAssigned&&a("span",{className:"ml-2 text-green-400",children:"• Available"}),v.isAssigned&&a("span",{className:"ml-2 text-orange-400",children:"• In use"})]})]})]},v.id)})})}),a("div",{className:"p-4 border-t border-slate-700 flex gap-2 justify-end",children:[a("button",{className:"btn ghost small",onClick:u,children:"Cancel"}),a("button",{className:"btn success small",onClick:f,children:["Save Selection (",l.value.length,")"]})]})]})}):null}function Vl({selectedLayerIds:e,onChange:t}){const n=J(!1),r=e.length,l=D.value.layers||[],s=e.map(o=>l.find(c=>c.id===o)?.id||o).slice(0,2),i=r===0?"No layers selected":r<=2?s.join(", "):`${s.join(", ")} +${r-2} more`;return a(V,{children:[a("button",{type:"button",className:"w-full px-2 py-1 text-xs bg-slate-800 border border-slate-600 rounded text-left hover:border-slate-500 focus:border-blue-500 transition-colors",onClick:()=>n.value=!0,children:a("div",{className:"flex items-center justify-between",children:[a("span",{className:r>0?"text-slate-200":"text-slate-500",children:i}),a("span",{className:"text-slate-400 text-xs",children:[r>0&&a("span",{className:"bg-blue-600 text-white px-1.5 py-0.5 rounded-full mr-1",children:r}),"Click to select..."]})]})}),a(Jl,{isOpen:n.value,selectedLayerIds:e,onClose:()=>n.value=!1,onSave:t})]})}const Wl=[{id:"details",label:"Details"},{id:"intl",label:"i18n"},{id:"json",label:"JSON"}],ql=e=>{if(!e)return"";const t=e.id||e.name;return t&&t.length>0?t:(e.items||[])[0]?.id||""},Hl=e=>{if(!e)return"";const t=e.name;if(t?.trim())return t;if(e.presentation==="single"){const n=(e.items||[])[0];if(n?.name?.trim())return n.name}return e.id||""},un=()=>({presentation:"single",items:[{id:"",name:"",showLegend:!1,layersIds:[]}]});function zl(){const e=Y,t=Wr,n=J("details"),r=J({active:!1,featureType:"weatherFeatures",draft:null}),l=I(()=>r.value.active?r.value.draft:!e.value.type||e.value.index<0?null:Br(e.value.type,e.value.index)||null),s=I(()=>l.value!=null||r.value.active),i=I(()=>l.value?l.value:r.value.active?r.value.draft:t.value||null),o=I(()=>Hl(i.value)||"Unnamed Feature"),d=I(()=>ql(i.value)||"No ID"),c=I(()=>{const h=i.value;return h?Pl(h):null}),f=I(()=>i.value?.presentation==="single"&&(i.value.items||[]).length===1),u=I(()=>{const h=i.value;if(!h||h.presentation!=="single")return!1;const N=h.items||[];if(N.length!==1)return!1;const w=N[0],p=h.id?.trim(),y=h.name?.trim(),m=w?.id?.trim(),_=w?.name?.trim();return!p&&m||!y&&_}),v=I(()=>{if(!i.value)return{percentage:100,missingCount:0,totalKeys:0};const h=i.value,N=[];h.id?.trim()&&N.push(h.id),(h.items||[]).forEach(b=>{b.id?.trim()&&N.push(b.id),b.legendDescription?.trim()&&N.push(b.legendDescription)});const w=[...new Set(N)];if(w.length===0)return{percentage:100,missingCount:0,totalKeys:0};let p=0,y=0;w.forEach(b=>{M.forEach(S=>{p++;const F=D.value.intl?.[S]?.[b];F&&F.trim()&&y++})});const m=p>0?Math.round(y/p*100):100,_=p-y;return{percentage:m,missingCount:_,totalKeys:w.length}}),g=()=>{!e.value.type||e.value.index<0||!t.value||ot(e.value.type,e.value.index,{...t.value})},$=()=>{if(r.value.active)r.value={active:!1,featureType:"weatherFeatures",draft:null};else{if(!e.value.type||e.value.index<0)return;Bt(e.value.type,e.value.index)}},T=()=>{const h=l.value;if(!h)return;const N=r.value.active;if(!N&&(!e.value.type||e.value.index<0)||!h.presentation||!Array.isArray(h.items)||h.items.length===0)return;const w=h.presentation==="single"&&h.items.length===1;if(h.name!==void 0&&h.name!==null&&!h.name.trim()&&!w||h.id!==void 0&&h.id!==null&&!h.id.trim()&&!w||h.items.filter(L=>!L.id?.trim()||!L.name?.trim()).length>0)return;const y=h.items.map(L=>L.id.trim()),m=y.filter((L,j)=>y.indexOf(L)!==j);if(m.length>0){te(`❌ Duplicate item IDs found: ${[...new Set(m)].join(", ")}`);return}if(h.presentation==="multiple"){const L=h.items.filter(me=>!me.name?.trim()),j=h.name?.trim();if(L.length>0&&!j)return}if(h.items.filter(L=>!L.layersIds||L.layersIds.length===0).length>0)return;const b=new Set((D.value.layers||[]).map(L=>L.id)),S=new Set;if(h.items.forEach(L=>{(L.layersIds||[]).forEach(j=>{b.has(j)||S.add(j)})}),S.size>0){te(`❌ Invalid layer IDs: ${Array.from(S).join(", ")}`);return}const F=Ar(D.value,h),B=JSON.parse(JSON.stringify(F));if(N){const L=r.value.featureType==="weatherFeatures"?B.weatherFeatures:B.features;L.push(JSON.parse(JSON.stringify(h)));const j=r.value.featureType,me=L.length-1;r.value={active:!1,featureType:"weatherFeatures",draft:null},setTimeout(()=>{Wn(j,me)},0)}else e.value.type&&(B[e.value.type][e.value.index]=JSON.parse(JSON.stringify(h)),Bt(e.value.type,e.value.index));W(B)},C=h=>{if(r.value.active){const N=r.value.draft||un();r.value={...r.value,draft:{...N,...h}}}else{if(!e.value.type||e.value.index<0)return;const N=l.value||t.value;ot(e.value.type,e.value.index,{...N,...h})}},k=h=>{if(r.value.active)r.value={...r.value,draft:h};else{if(!e.value.type||e.value.index<0)return;ot(e.value.type,e.value.index,h)}},x=()=>{const h=e.value.type==="features"?"features":"weatherFeatures";r.value={active:!0,featureType:h,draft:un()}},O=()=>{if(!e.value.type||e.value.index<0||!i.value)return;const h=i.value,N=e.value.type,w={...h,id:h.id?`${h.id}_copy`:"",name:h.name?`${h.name} (Copy)`:"",items:(h.items||[]).map(p=>({...p,id:p.id?`${p.id}_copy`:"",name:p.name?`${p.name} (Copy)`:"",layersIds:[...p.layersIds||[]]}))};r.value={active:!0,featureType:N,draft:w}};return a("div",{className:"flex flex-col h-full",children:[a("div",{className:"flex flex-wrap gap-2 mb-3 items-center flex-shrink-0",children:[a("div",{children:[a("span",{className:"text-slate-500",children:r.value.active?"Create New Feature":s.value?"Edit Feature":"Feature Details"}),i.value&&a("div",{className:"text-xs text-slate-400 mt-0.5",children:r.value.active?`New ${r.value.featureType==="weatherFeatures"?"Weather":"General"} Feature`:`${o.value} ${d.value!==o.value&&`(${d.value})`}`}),r.value.active&&a("div",{className:"flex items-center gap-2 mt-2",children:[a("label",{className:"text-xs text-slate-400",children:"Category"}),a("select",{className:"form-select text-xs py-1 px-2",value:r.value.featureType,onChange:h=>{const N=h.target.value;r.value={...r.value,featureType:N}},children:[a("option",{value:"weatherFeatures",children:"Weather"}),a("option",{value:"features",children:"General"})]})]})]}),a("div",{className:"ml-auto flex gap-2",children:[!s.value&&e.value.type&&e.value.index>=0&&a(V,{children:[a("button",{className:"btn small",onClick:x,children:"New Feature"}),a("button",{className:"btn small",onClick:O,children:"Clone Feature"}),a("button",{className:"btn small",onClick:g,children:"Edit"})]}),!s.value&&(!e.value.type||e.value.index<0)&&a("button",{className:"btn small",onClick:x,children:"New Feature"}),s.value&&a(V,{children:[a("button",{className:"btn success small",onClick:T,children:r.value.active?"Create Feature":"Save"}),a("button",{className:"btn ghost small",onClick:$,children:"Cancel"})]})]})]}),i.value?a(V,{children:[a("div",{className:"flex gap-1 mb-3 border-b border-slate-700 pb-2 flex-shrink-0",children:Wl.map(h=>a("button",{className:`px-3 py-1.5 rounded-t-md text-xs transition-all duration-150 flex items-center gap-2 ${n.value===h.id?"bg-blue-500 text-white":"bg-slate-950 text-slate-500 border border-slate-700 hover:border-slate-600 hover:text-slate-200"}`,onClick:()=>n.value=h.id,children:[a("span",{children:h.label}),h.id==="intl"&&v.value.totalKeys>0&&a("span",{className:`text-xs px-1.5 py-0.5 rounded-full ${v.value.percentage===100?"bg-green-600 text-white":v.value.percentage>50?"bg-yellow-600 text-white":"bg-red-600 text-white"}`,children:[v.value.percentage,"%"]})]},h.id))}),a("div",{className:"flex-1 overflow-hidden",children:[n.value==="details"&&a("div",{className:"h-full overflow-auto",children:[a(ur,{validation:c.value,className:"mb-4"}),u.value&&s.value&&a("div",{className:"bg-blue-900/30 border border-blue-500/50 rounded p-3 mb-4",children:a("div",{className:"flex items-start gap-2",children:[a("div",{className:"text-blue-400 text-sm",children:"💡"}),a("div",{className:"flex-1",children:[a("div",{className:"text-blue-300 text-sm font-medium mb-1",children:"Single Item Feature Detected"}),a("div",{className:"text-blue-200 text-xs mb-2",children:"For single-item features, you can leave Feature ID and Name empty to inherit from the item."}),a("button",{className:"btn tiny",onClick:()=>{C({id:"",name:""})},children:"Clear Feature Fields"})]})]})}),a("div",{className:"layer-section",children:[a("div",{className:"form-group",children:[a("label",{className:"form-label",children:"Feature ID"}),a("input",{type:"text",className:"form-input",value:i.value.id||"",onChange:h=>C({id:h.target.value}),placeholder:i.value.presentation==="single"?"Leave empty to use first item ID":"e.g. icing_index, radar, wind_60min",disabled:!s.value}),a("div",{className:"text-xs text-slate-500 mt-1",children:i.value.presentation==="single"?"Optional - will inherit from first item if empty":"Optional unique identifier for this feature group"})]}),a("div",{className:"form-group",children:[a("label",{className:"form-label",children:"Feature Name"}),a("input",{type:"text",className:"form-input",value:i.value.name||"",onChange:h=>C({name:h.target.value}),placeholder:i.value.presentation==="single"?"Leave empty to use first item name":"e.g. Weather Layers, Navigation Features",disabled:!s.value}),a("div",{className:"text-xs text-slate-500 mt-1",children:i.value.presentation==="single"?"Optional - will inherit from first item if empty":"Optional display name for this feature group"})]}),a("div",{className:"form-group",children:[a("label",{className:"form-label",children:"Presentation"}),a("select",{className:"form-select",value:i.value.presentation,onChange:h=>C({presentation:h.target.value}),disabled:!s.value,children:[a("option",{value:"single",children:"Single"}),a("option",{value:"multiple",children:"Multiple"})]}),a("div",{className:"text-xs text-slate-500 mt-1",children:i.value.presentation==="single"?a(V,{children:[a("span",{className:"font-medium text-blue-300",children:"Single:"})," Only one item can be selected.",f.value&&a("span",{className:"text-blue-300",children:" Feature can inherit from item."})]}):a(V,{children:[a("span",{className:"font-medium text-green-300",children:"Multiple:"})," Multiple items can be selected. Feature should have its own name."]})})]}),i.value.presentation==="multiple"&&a("div",{className:"form-group",children:[a("label",{className:"form-label",children:"Mutually Exclusive"}),a("div",{children:[a("input",{type:"checkbox",className:"form-checkbox",checked:!!i.value.mutuallyExclusive,onChange:h=>C({mutuallyExclusive:h.target.checked}),disabled:!s.value}),a("span",{className:"text-slate-200 text-sm",children:"Only one item selectable at a time"})]}),a("div",{className:"text-xs text-slate-500 mt-1",children:"When enabled, selecting one item automatically deselects others"})]}),a("div",{className:"form-group",children:[a("label",{className:"form-label",children:["Items",(i.value.items||[]).length===0&&a("span",{className:"text-orange-400 text-xs ml-1",children:"(at least one required)"})]}),(i.value.items||[]).length===0?a("div",{className:"text-center p-4 border border-dashed border-slate-600 rounded bg-slate-900",children:[a("div",{className:"text-slate-400 text-sm mb-2",children:"No items defined"}),s.value&&a("button",{className:"btn small primary",onClick:()=>{C({items:[{id:"",name:"",showLegend:!1,layersIds:[]}]})},children:"Add First Item"})]}):a("div",{className:"space-y-2",children:[i.value&&(i.value.items||[]).map((h,N)=>a("div",{className:"border border-slate-600 rounded p-3 bg-slate-900",draggable:!!(s.value&&i.value&&(i.value.items||[]).length>1),onDragStart:w=>{!s.value||!w.dataTransfer||(w.dataTransfer.setData("text/plain",N.toString()),w.dataTransfer.effectAllowed="move")},onDragOver:w=>{!s.value||!w.dataTransfer||(w.preventDefault(),w.dataTransfer.dropEffect="move")},onDrop:w=>{if(!s.value||!w.dataTransfer||!i.value)return;w.preventDefault();const p=parseInt(w.dataTransfer.getData("text/plain"));if(p!==N){const y=[...i.value.items||[]],m=y[p];y.splice(p,1),y.splice(N,0,m),C({items:y})}},style:{opacity:(s.value&&i.value&&(i.value.items||[]).length>1,"1"),cursor:s.value&&i.value&&(i.value.items||[]).length>1?"grab":"default"},children:[a("div",{className:"flex items-center gap-2 mb-2",children:[s.value&&i.value&&(i.value.items||[]).length>1&&a("div",{className:"cursor-move text-slate-400 hover:text-slate-300 px-1 select-none",title:"Drag to reorder items",onMouseDown:w=>w.stopPropagation(),children:"⋮⋮"}),a("span",{className:"text-xs text-slate-400 font-mono",children:["#",N+1]}),a("div",{className:"flex-1",children:[a("div",{className:"text-sm font-medium",children:h.name||h.id||`Item ${N+1}`}),a("div",{className:"text-xs text-slate-500",children:["ID: ",h.id||"(empty)"," • Layers: ",(h.layersIds||[]).length," • Legend: ",h.showLegend?"Yes":"No"]})]}),s.value&&i.value&&a("button",{className:"btn tiny danger",onClick:()=>{if(!i.value)return;const w=[...i.value.items||[]];w.splice(N,1),C({items:w})},children:"×"})]}),s.value&&a("div",{className:"space-y-2 text-xs",children:[a("div",{className:"grid grid-cols-2 gap-2",children:[a("div",{children:[a("label",{className:"block text-slate-400 mb-1",children:"Item ID"}),a("input",{type:"text",className:"w-full px-2 py-1 text-xs bg-slate-800 border border-slate-600 rounded",value:h.id||"",onChange:w=>{if(!i.value)return;const p=[...i.value.items||[]];p[N]={...h,id:w.target.value},C({items:p})},placeholder:"e.g. icing_index"})]}),a("div",{children:[a("label",{className:"block text-slate-400 mb-1",children:"Item Name"}),a("input",{type:"text",className:"w-full px-2 py-1 text-xs bg-slate-800 border border-slate-600 rounded",value:h.name||"",onChange:w=>{if(!i.value)return;const p=[...i.value.items||[]];p[N]={...h,name:w.target.value},C({items:p})},placeholder:"e.g. Icing Index (60 min)"})]})]}),a("div",{children:[a("label",{className:"block text-slate-400 mb-1",children:"Layer IDs"}),a(Vl,{selectedLayerIds:h.layersIds||[],onChange:w=>{if(!i.value)return;const p=[...i.value.items||[]];p[N]={...h,layersIds:w},C({items:p})}})]}),a("div",{className:"flex items-center gap-2",children:[a("input",{type:"checkbox",className:"form-checkbox",checked:h.showLegend||!1,onChange:w=>{if(!i.value)return;const p=[...i.value.items||[]];p[N]={...h,showLegend:w.target.checked},C({items:p})}}),a("span",{className:"text-slate-400",children:"Show Legend"})]}),h.showLegend&&a("div",{className:"grid grid-cols-2 gap-2 mt-2",children:[a("div",{className:"col-span-2",children:[a("label",{className:"block text-slate-400 mb-1",children:"Legend URL (optional)"}),a("input",{type:"text",className:"w-full px-2 py-1 text-xs bg-slate-800 border border-slate-600 rounded",value:h.legendUrl||"",onChange:w=>{if(!i.value)return;const p=[...i.value.items||[]];p[N]={...h,legendUrl:w.target.value},C({items:p})},placeholder:"https://example.com/legend.png"})]}),a("div",{className:"col-span-2",children:[a("label",{className:"block text-slate-400 mb-1",children:"Legend Description Key (optional)"}),a("input",{type:"text",className:"w-full px-2 py-1 text-xs bg-slate-800 border border-slate-600 rounded",value:h.legendDescription||"",onChange:w=>{if(!i.value)return;const p=[...i.value.items||[]];p[N]={...h,legendDescription:w.target.value},C({items:p})},placeholder:"translation.key.for.legend_description"}),a("div",{className:"text-xs text-slate-500 mt-1",children:"Appears in i18n panel as a translatable key"})]})]})]})]},N)),i.value&&i.value.presentation!=="single"&&a("button",{className:"btn small w-full",onClick:()=>{if(s.value||g(),!i.value)return;const h={id:"",name:"",showLegend:!1,layersIds:[]};C({items:[...i.value.items||[],h]})},children:"+ Add Another Item"})]})]})]})]}),n.value==="intl"&&i.value&&a("div",{className:"h-full",children:a(Rl,{feature:i.value,isEditing:s.value},`${e.value.type??"none"}:${e.value.index}:${s.value?"edit":"view"}`)}),n.value==="json"&&a("div",{className:"h-full min-h-0",children:a(Ft,{title:"Selected Feature JSON",value:i.value,onChange:k,readOnly:!s.value,height:"100%"},`${e.value.type??"none"}:${e.value.index}:${s.value?"edit":"view"}`)})]})]}):a("div",{className:"text-center p-5 text-slate-500 flex-1 flex items-center justify-center",children:r.value.active?"Creating new feature...":"Select a feature on the left to view/edit"})]})}function Bl(){const e=I(()=>Jr.value),t=e.value.missingLayers.length,n=e.value.unusedLayers.length,r=Object.entries(e.value.missingIntl).map(([l,s])=>({lang:l,count:s.length})).filter(l=>l.count>0);return!t&&!n&&r.length===0?null:a("div",{className:"fixed bottom-0 left-0 right-0 bg-slate-800 border-t border-slate-700 p-2 px-3 text-xs flex gap-3 items-center z-10",children:[t>0&&a("span",{className:`pill ${t>0?"bad":"ok"}`,children:["Missing layers: ",t]}),n>0&&a("span",{className:`pill ${n>0?"warn":"ok"}`,children:["Unused layers: ",n]}),r.map(({lang:l,count:s})=>a("span",{className:`pill ${s>0?"warn":"ok"}`,children:[l," missing: ",s]},l)),e.value.missingLayers.length>0&&a("div",{className:"text-slate-500 text-[10px]",children:["Missing: ",e.value.missingLayers.join(", ")]}),e.value.unusedLayers.length>0&&a("div",{className:"text-slate-500 text-[10px]",children:["Unused: ",e.value.unusedLayers.join(", ")]})]})}function Kl(){const e=I(()=>D.value),t=J(""),n=J(!1),r=J("any"),l=z(()=>{try{return[...Xe(e.value)].sort()}catch{return[]}},[e.value]),s=z(()=>{const o=t.value.toLowerCase().trim(),d=r.value,c=(f,u)=>{const v=e.value.intl?.[u]?.[f];return v===void 0||v===""};return l.filter(f=>{if(o){const u=f.toLowerCase().includes(o),v=M.some(g=>(e.value.intl?.[g]?.[f]||"").toLowerCase().includes(o));if(!u&&!v)return!1}if(n.value){if(d==="any"){if(!M.some(u=>c(f,u)))return!1}else if(!c(f,d))return!1}return!0})},[l,t.value,n.value,r.value,e.value]),i=(o,d,c)=>{const f={...e.value,intl:{...e.value.intl}};f.intl[d]={...f.intl[d]||{},[o]:c},W(f)};return l.length===0?a("div",{className:"p-4 text-center text-slate-500",children:"No translation keys found"}):a("div",{children:[a("div",{className:"flex gap-2 items-center mb-3",children:[a("button",{className:"btn small",onClick:qn,children:"Fill missing from EN"}),a("input",{type:"text",className:"form-input",placeholder:"Search keys or translations…",value:t.value,onInput:o=>t.value=o.target.value}),a("label",{className:"flex items-center gap-2 text-xs text-slate-400",children:[a("input",{type:"checkbox",checked:n.value,onChange:o=>n.value=o.target.checked}),"Show missing only"]}),a("select",{className:"form-select text-xs",value:r.value,onChange:o=>r.value=o.target.value,children:[a("option",{value:"any",children:"Any language"}),M.map(o=>a("option",{value:o,children:o.toUpperCase()},o))]})]}),a("div",{className:"overflow-auto",children:a("table",{className:"w-full text-sm border-collapse",children:[a("thead",{children:a("tr",{children:[a("th",{className:"text-left p-2 border-b border-slate-700 sticky top-0 bg-slate-800",children:"Key"}),M.map(o=>a("th",{className:"text-left p-2 border-b border-slate-700 sticky top-0 bg-slate-800",children:o.toUpperCase()},o))]})}),a("tbody",{children:s.map(o=>a("tr",{className:"align-top",children:[a("td",{className:"p-2 border-b border-slate-800 text-slate-300 whitespace-nowrap",children:o}),M.map(d=>a("td",{className:"p-2 border-b border-slate-800 min-w-[220px]",children:a("input",{type:"text",className:"form-input w-full",value:e.value.intl?.[d]?.[o]??"",onInput:c=>i(o,d,c.target.value),placeholder:`[${d}] ${o}`})},d))]},o))})]})})]})}function Gl({translationKey:e,isSelected:t,onSelect:n}){const r=I(()=>D.value),l=z(()=>M.reduce((i,o)=>{const d=r.value.intl?.[o]?.[e];return i+(d===void 0||d===""?1:0)},0),[e,r.value]),s=z(()=>M.some(i=>{const o=r.value.intl?.[i]?.[e];return o!==void 0&&o!==""}),[e,r.value]);return a("div",{className:`feature-list-item ${t?"selected":""}`,onClick:n,children:[a("div",{className:"feature-info",children:[a("div",{className:"feature-name",children:e}),a("div",{className:"feature-details",children:[M.length-l,"/",M.length," languages",l>0&&` • ${l} missing`,!s&&" • No translations"]})]}),a("div",{className:"feature-actions",children:[l>0&&a("span",{className:"pill warn",children:["Missing ",l]}),!s&&a("span",{className:"pill bad",children:"Empty"}),l===0&&s&&a("span",{className:"pill ok",children:"Complete"})]})]})}function Zl({title:e,keys:t,selectedKey:n,onSelectKey:r}){return a("details",{open:!0,className:"feature-category",children:[a("summary",{className:"feature-category-header",children:e}),a("div",{className:"feature-category-content",children:t.length===0?a("div",{className:"p-3 text-slate-500 text-center",children:["No ",e.toLowerCase()," found"]}):t.map(l=>a(Gl,{translationKey:l,isSelected:n===l,onSelect:()=>r(l)},l))})]})}function Yl({selectedKey:e,onSelectKey:t}){const n=I(()=>D.value),r=J(""),l=J(!1),s=J("any"),i=z(()=>{try{return[...Xe(n.value)].sort()}catch{return[]}},[n.value]),o=z(()=>{const c=r.value.toLowerCase().trim(),f=s.value,u=(v,g)=>{const $=n.value.intl?.[g]?.[v];return $===void 0||$===""};return i.filter(v=>{if(c){const g=v.toLowerCase().includes(c),$=M.some(T=>(n.value.intl?.[T]?.[v]||"").toLowerCase().includes(c));if(!g&&!$)return!1}if(l.value){if(f==="any"){if(!M.some(g=>u(v,g)))return!1}else if(!u(v,f))return!1}return!0})},[i,r.value,l.value,s.value,n.value]),d=z(()=>{const c={"Weather Features":[],"General Features":[],Layers:[],Other:[]};return o.forEach(f=>{f.includes("weather")||f.includes("radar")||f.includes("wind")||f.includes("cloud")?c["Weather Features"].push(f):f.includes("layer")||f.includes("overlay")?c.Layers.push(f):f.includes("feature")||f.includes("item")?c["General Features"].push(f):c.Other.push(f)}),c},[o]);return i.length===0?a("div",{children:[a("div",{className:"mb-3",children:a("button",{className:"btn primary",disabled:!0,children:"No Translation Keys Found"})}),a("div",{className:"p-4 text-center text-slate-500",children:"Load a JSON file with translation keys to get started"})]}):a("div",{children:[a("div",{className:"mb-3",children:a("button",{className:"btn primary",onClick:qn,children:"🌐 Fill Missing from EN"})}),a("div",{className:"flex flex-col gap-2 items-stretch mb-3",children:[a("input",{type:"text",className:"form-input",placeholder:"Search keys or translations…",value:r.value,onInput:c=>r.value=c.target.value}),a("div",{className:"flex gap-2 items-center",children:[a("label",{className:"flex items-center gap-2 text-xs text-slate-400",children:[a("input",{type:"checkbox",checked:l.value,onChange:c=>l.value=c.target.checked}),"Show missing only"]}),a("select",{className:"form-select text-xs flex-1",value:s.value,onChange:c=>s.value=c.target.value,children:[a("option",{value:"any",children:"Any language"}),M.map(c=>a("option",{value:c,children:c.toUpperCase()},c))]})]})]}),a("div",{className:"feature-browser",children:Object.entries(d).map(([c,f])=>f.length>0&&a(Zl,{title:c,keys:f,selectedKey:e,onSelectKey:t},c))})]})}function Ql({selectedKey:e}){const t=I(()=>D.value),n=z(()=>{if(!e)return null;const o={};return M.forEach(d=>{o[d]=t.value.intl?.[d]?.[e]??""}),o},[e,t.value]),r=z(()=>n?M.filter(o=>n[o]===void 0||n[o]===""):[],[n]),l=(o,d)=>{if(!e)return;const c={...t.value,intl:{...t.value.intl}};c.intl[o]={...c.intl[o]||{},[e]:d},W(c)},s=()=>{if(!e||!n)return;const o=n.en;if(!o)return;const d={...t.value,intl:{...t.value.intl}};r.forEach(c=>{d.intl[c]||(d.intl[c]={}),d.intl[c][e]=o}),W(d)},i=()=>{if(!e||!confirm("Are you sure you want to clear all translations for this key?"))return;const o={...t.value,intl:{...t.value.intl}};M.forEach(d=>{o.intl[d]&&o.intl[d][e]&&delete o.intl[d][e]}),W(o)};return e?n?a("div",{className:"h-full flex flex-col",children:[a("div",{className:"mb-4",children:[a("h3",{className:"text-lg font-medium text-slate-200 mb-1",children:"Translation Editor"}),a("div",{className:"flex items-center gap-2",children:[a("code",{className:"inline text-slate-400",children:e}),r.length>0&&a("span",{className:"pill warn",children:[r.length," missing"]}),r.length===0&&a("span",{className:"pill ok",children:"Complete"})]})]}),a("div",{className:"flex gap-2 mb-4",children:[r.length>0&&n.en&&a("button",{className:"btn small",onClick:s,children:"Fill missing from EN"}),a("button",{className:"btn danger small",onClick:i,children:"Clear all"})]}),a("div",{className:"flex-1 overflow-y-auto",children:a("div",{className:"space-y-4",children:M.map(o=>a("div",{className:"form-group",children:[a("label",{className:"form-label flex items-center gap-2",children:[a("span",{className:"font-mono text-xs bg-slate-700 px-2 py-1 rounded",children:o.toUpperCase()}),o==="en"&&a("span",{className:"text-slate-500 text-xs",children:"(Default)"}),r.includes(o)&&a("span",{className:"text-yellow-500 text-xs",children:"• Missing"})]}),a("textarea",{className:"form-textarea",rows:3,value:n[o],onInput:d=>l(o,d.target.value),placeholder:`Enter ${o.toUpperCase()} translation for "${e}"`}),o==="en"&&n[o]&&a("div",{className:"form-help",children:"This will be used as fallback for missing translations"})]},o))})}),a("div",{className:"mt-4 pt-4 border-t border-slate-700",children:a("div",{className:"text-xs text-slate-500",children:[a("div",{className:"mb-1",children:[a("strong",{children:"Translation Status:"})," ",M.length-r.length,"/",M.length," languages"]}),r.length>0&&a("div",{children:[a("strong",{children:"Missing:"})," ",r.map(o=>o.toUpperCase()).join(", ")]})]})})]}):a("div",{className:"h-full flex items-center justify-center",children:a("div",{className:"text-center text-slate-500",children:[a("div",{className:"text-6xl mb-4",children:"⚠️"}),a("div",{className:"text-lg font-medium mb-2",children:"Error Loading Translations"}),a("div",{className:"text-sm",children:"Unable to load translation data for this key"})]})}):a("div",{className:"h-full flex flex-col",children:[a("div",{className:"mb-4",children:[a("h3",{className:"text-lg font-medium text-slate-200 mb-2",children:"Translation Editor"}),a("p",{className:"text-slate-500 text-sm",children:"Select a translation key from the left panel to edit its translations."})]}),a("div",{className:"flex-1 flex items-center justify-center",children:a("div",{className:"text-center text-slate-500",children:[a("div",{className:"text-6xl mb-4",children:"🌐"}),a("div",{className:"text-lg font-medium mb-2",children:"No Key Selected"}),a("div",{className:"text-sm",children:"Choose a translation key to start editing"})]})})]})}function Xl(){const e=I(()=>D.value.layers?.map(n=>n.id).filter(Boolean)||[]),t=I(()=>ne.value.customLogicLayers);return a("div",{className:"max-h-[calc(100vh-180px)] overflow-auto",children:[a("div",{className:"mb-4",children:[a("h3",{className:"text-lg font-semibold mb-2",children:"Application Settings"}),a("p",{className:"text-sm text-slate-400 mb-4",children:"Configure layers with custom logic that are referenced in your application code."})]}),a("div",{className:"space-y-4",children:[a("div",{children:[a("h4",{className:"font-medium mb-3",children:"Referenced Layers"}),a("p",{className:"text-sm text-slate-400 mb-3",children:'Layers marked as "referenced" are used in your application code (Dart) and should be handled differently during validation.'}),a("div",{className:"space-y-3",children:[a("div",{className:"p-3 bg-slate-700 rounded",children:[a("div",{className:"text-sm font-medium mb-2",children:"Current Referenced Layers:"}),t.value.size===0?a("div",{className:"text-slate-400 text-sm italic",children:"None"}):a("div",{className:"font-mono text-sm text-blue-300",children:Array.from(t.value).join(", ")})]}),a("div",{className:"p-3 bg-slate-700 rounded",children:[a("div",{className:"text-sm font-medium mb-2",children:"Available Layers:"}),e.value.length===0?a("div",{className:"text-slate-400 text-sm",children:"No layers found. Add some layers first."}):a("div",{className:"flex flex-wrap gap-2",children:e.value.map(n=>a("button",{onClick:()=>Fr(n),className:`px-2 py-1 rounded text-xs font-mono transition-colors ${we(n)?"bg-blue-600 text-white hover:bg-blue-700":"bg-slate-600 text-slate-300 hover:bg-slate-500"}`,children:[we(n)?"✓ ":"+ ",n]},n))})]})]})]}),a("div",{className:"mt-6 p-3 bg-slate-700 rounded text-sm",children:[a("h5",{className:"font-medium mb-2",children:'What does "Referenced" mean?'}),a("ul",{className:"text-slate-400 space-y-1 text-xs",children:[a("li",{children:"• Layer is referenced/used in your Dart application code"}),a("li",{children:"• Layer should be handled differently during validation"}),a("li",{children:"• Layer appears with visual indicators throughout the UI"}),a("li",{children:"• Settings are saved locally in your browser"})]})]}),t.value.size>0&&a("div",{className:"mt-4 p-3 bg-blue-900/20 border border-blue-700 rounded text-sm",children:[a("h5",{className:"font-medium mb-2 text-blue-300",children:["Referenced Layers (",t.value.size,")"]}),a("div",{className:"flex flex-wrap gap-1",children:Array.from(t.value).map(n=>a("span",{className:"font-mono text-xs bg-blue-600 text-white px-2 py-1 rounded",children:n},n))})]})]})]})}function es({onOpenClick:e}){return a("div",{className:"flex items-center justify-center min-h-[60vh]",onPaste:s=>{const i=s.clipboardData?.getData("text");if(i)try{const o=JSON.parse(i);W(o),te("✅ JSON pasted from clipboard")}catch{}},children:a("div",{className:"w-full max-w-2xl text-center p-8 border border-dashed border-slate-600 rounded-xl bg-slate-900/40",onDrop:s=>{s.preventDefault();const o=Array.from(s.dataTransfer?.files||[]).find(d=>d.type==="application/json"||d.name.endsWith(".json"));if(o){const d=new FileReader;d.onload=c=>{const f=c.target?.result;if(f)try{const u=JSON.parse(f);W(u),te("✅ JSON file loaded successfully")}catch{}},d.readAsText(o)}},onDragOver:s=>{s.preventDefault()},children:[a("h2",{className:"text-lg mb-2 text-slate-100",children:"Get Started"}),a("p",{className:"mb-4 text-slate-400",children:"Choose an option to begin"}),a("div",{className:"flex flex-col gap-2 items-center",children:[a("button",{className:"btn primary",onClick:()=>{W(Pn())},children:"Start with Empty Structure"}),a("button",{className:"btn",onClick:e,children:"Open Existing JSON…"})]}),a("div",{className:"mt-4 text-xs text-slate-500",children:"Tip: You can also drop JSON files here or paste JSON"})]})})}const ts=[{id:"features",label:"Features"},{id:"layers",label:"Layers"},{id:"internationalization",label:"i18n"},{id:"json",label:"JSON"},{id:"settings",label:"Settings"}];function ns(){const e=R(null),t=J(null),n=J("split");Z(()=>{Le.value||Hr()},[]);const r=()=>{e.current?.click()};return a("div",{className:"app",children:[a("input",{ref:e,type:"file",accept:"application/json,.json",style:{display:"none"},onChange:l=>{const s=l.target.files?.[0];if(s){const i=new FileReader;i.onload=o=>{const d=o.target?.result;if(d)try{const c=JSON.parse(d);W(c),te("✅ JSON file loaded successfully")}catch(c){te(`❌ Invalid JSON: ${c instanceof Error?c.message:"Parse error"}`)}},i.readAsText(s)}}}),Le.value&&a("header",{className:"flex gap-3 items-center p-3 border-b border-slate-700 sticky top-0 z-[5]",style:{background:"rgba(15, 17, 21, 0.9)",backdropFilter:"saturate(1.2) blur(6px)"},children:[a("h1",{className:"text-base m-0 mr-2 opacity-95",children:"Map Layers JSON Editor"}),a("button",{className:"btn",onClick:r,children:"Open JSON…"}),a("div",{className:"ml-auto",children:Le.value&&a("span",{className:"text-slate-500",children:Vr.value})})]}),Le.value?a("div",{className:"p-3 min-h-[calc(100vh-80px)]",children:[a("div",{className:"flex gap-1 mb-3 border-b border-slate-700 pb-2",children:ts.map(l=>a("button",{className:`px-4 py-2 rounded-t-md text-xs transition-all duration-150 text-decoration-none ${de.value===l.id?"bg-blue-500 text-white border-blue-500":"bg-slate-950 text-slate-500 border border-slate-700 hover:border-slate-600 hover:text-slate-200"}`,onClick:()=>de.value=l.id,children:l.label},l.id))}),de.value==="features"&&a("div",{className:"flex gap-3 h-[calc(100vh-200px)] overflow-hidden",children:[a("div",{className:"flex-1 min-w-0 bg-slate-800 border border-slate-700 rounded-xl p-3 flex flex-col",children:a(Fl,{})}),a("div",{className:"flex-1 min-w-0 bg-slate-800 border border-slate-700 rounded-xl p-3 flex flex-col",children:a(zl,{})})]}),de.value==="layers"&&a("div",{className:"flex gap-3 h-[calc(100vh-200px)] overflow-hidden",children:[a("div",{className:"flex-1 min-w-0 bg-slate-800 border border-slate-700 rounded-xl p-3 flex flex-col",children:a(Ml,{})}),a("div",{className:"flex-1 min-w-0 bg-slate-800 border border-slate-700 rounded-xl p-3 flex flex-col",children:a(jl,{})})]}),de.value==="internationalization"&&a("div",{children:[a("div",{className:"flex gap-1 mb-3 border-b border-slate-700 pb-2",children:[a("button",{className:`px-3 py-1.5 rounded text-xs transition-all duration-150 ${n.value==="split"?"bg-blue-500 text-white":"bg-slate-800 text-slate-500 border border-slate-700 hover:border-slate-600 hover:text-slate-200"}`,onClick:()=>n.value="split",children:"Split View"}),a("button",{className:`px-3 py-1.5 rounded text-xs transition-all duration-150 ${n.value==="table"?"bg-blue-500 text-white":"bg-slate-800 text-slate-500 border border-slate-700 hover:border-slate-600 hover:text-slate-200"}`,onClick:()=>n.value="table",children:"Table View"})]}),n.value==="split"&&a("div",{className:"flex gap-3 h-[calc(100vh-200px)] overflow-hidden",children:[a("div",{className:"flex-1 min-w-0 bg-slate-800 border border-slate-700 rounded-xl p-3 flex flex-col",children:a("div",{className:"flex-1 min-h-0 overflow-auto",children:a(Yl,{selectedKey:t.value,onSelectKey:l=>t.value=l})})}),a("div",{className:"flex-1 min-w-0 bg-slate-800 border border-slate-700 rounded-xl p-3 flex flex-col",children:a(Ql,{selectedKey:t.value})})]}),n.value==="table"&&a("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-3 flex flex-col h-[calc(100vh-200px)]",children:a("div",{className:"flex-1 min-h-0",children:a(Kl,{})})})]}),de.value==="json"&&a("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-3 flex flex-col h-[calc(100vh-180px)]",children:[a("div",{className:"flex-1 min-h-0",children:a(Ft,{title:"Complete JSON Configuration",value:D.value,onChange:l=>{W(l)},height:"100%"})}),a("div",{className:"flex gap-2 mt-3 pt-3 border-t border-slate-700 flex-shrink-0",children:[a("button",{className:"btn small",onClick:()=>{const l=Tr(JSON.stringify(D.value));l.valid||te(`❌ Validation failed: ${l.errors.length} error(s), ${l.warnings.length} warning(s)`)},children:"Validate Structure"}),a("button",{className:"btn success small",onClick:()=>{try{const l=JSON.stringify(D.value,null,2),s=new Date().toISOString().slice(0,19).replace(/[:.]/g,"-");Or(`map-layers-${s}.json`,l),te("✅ JSON file downloaded")}catch{}},children:"Download JSON"})]})]}),de.value==="settings"&&a("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-3",children:a(Xl,{})})]}):a("div",{className:"p-6",children:a(es,{onOpenClick:r})}),a(Bl,{})]})}xe(a(ns,{}),document.getElementById("app"));
